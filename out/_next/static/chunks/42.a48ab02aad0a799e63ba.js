(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[42],{uxVz:function(e,t,r){"use strict";r.r(t);var i=r("nKUr"),s=r("1OyB"),o=r("vuIU"),c=r("JX7q"),n=r("Ji7U"),a=r("md7G"),p=r("foSv"),l=r("rePB"),d=r("q1tI"),u=r("/MKj"),b=r("Ty5D"),j=r("wHH0"),h=r("uGH+"),f=r("yzbm"),O=r("s/m+"),v=r("e+cM"),m=r("LADp"),y=r("ZpDd");r("sKWC");function x(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function g(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?x(Object(r),!0).forEach((function(t){Object(l.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):x(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function w(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,i=Object(p.a)(e);if(t){var s=Object(p.a)(this).constructor;r=Reflect.construct(i,arguments,s)}else r=i.apply(this,arguments);return Object(a.a)(this,r)}}var _=function(e){Object(n.a)(r,e);var t=w(r);function r(e){var i;return Object(s.a)(this,r),i=t.call(this,e),Object(l.a)(Object(c.a)(i),"submit",(function(e){e.preventDefault();var t=i.state,r=t.proposalId,s=t.title,o=t.short_description,c=t.files,n=t.ids_to_remove;if(s.trim())if(o.trim()){var a={title:s.trim(),short_description:o.trim()};i.props.dispatch(Object(m.hd)(r,a,(function(){i.props.dispatch(Object(y.Cb)())}),(function(e){var t=i.props.history;if(e.success&&e.proposal&&e.proposal.id)if(c&&c.length){var r=new FormData;n.length&&r.append("ids_to_remove",n.join(",")),c.forEach((function(e){e.id||(r.append("files[]",e),r.append("names[]",e.name))})),r.append("proposal",e.proposal.id),i.props.dispatch(Object(m.jd)(r,(function(){}),(function(e){e.success&&(t.push("/app/proposals"),i.props.dispatch(Object(y.Bb)("You have successfully re-submitted your proposal. We will review it and keep you posted.","success")),i.props.dispatch(Object(y.U)()))})))}else t.push("/app/proposals"),i.props.dispatch(Object(y.Bb)("You have successfully re-submitted your proposal. We will review it and keep you posted.","success")),i.props.dispatch(Object(y.U)());else i.props.dispatch(Object(y.U)())})))}else i.props.dispatch(Object(y.Bb)("Please input short description"));else i.props.dispatch(Object(y.Bb)("Please input proposal title"))})),i.state={proposal:{},proposalId:0,loading:!1,title:"",short_description:"",files:[],ids_to_remove:[]},i}return Object(o.a)(r,[{key:"componentDidMount",value:function(){var e=this,t=this.props.match.params.proposalId;this.props.dispatch(Object(m.Sb)(t,(function(){e.setState({loading:!0}),e.props.dispatch(Object(y.Cb)())}),(function(r){e.props.dispatch(Object(y.U)());var i=r.proposal||{};e.setState({loading:!1,proposalId:t,proposal:i},(function(){i&&i.id&&e.initValues(i)}))})))}},{key:"initValues",value:function(e){var t=e.title||"",r=e.short_description||"",i=e.files||[];this.setState({title:t,short_description:r,files:i})}},{key:"inputField",value:function(e,t){this.setState(Object(l.a)({},t,e.target.value))}},{key:"appendFiles",value:function(e){var t=this.state.files;t=t.concat(e),this.setState({files:t})}},{key:"removeFile",value:function(e){var t=this.state,r=t.files,i=t.ids_to_remove,s=r[e];s&&s.id&&!i.includes(s.id)&&i.push(s.id),r.splice(e,1),this.setState({files:r,ids_to_remove:i})}},{key:"renderFiles",value:function(){var e=this,t=this.state.files;if(!t||!t.length)return null;var r=[];return t.forEach((function(t,s){r.push(Object(i.jsxs)("li",{children:[Object(i.jsx)("p",{children:t.name||t}),Object(i.jsx)(j.a,{onClick:function(){return e.removeFile(s)}})]},"file_".concat(s)))})),Object(i.jsxs)("div",{id:"files-wrap",children:[Object(i.jsx)("label",{children:Object(i.jsx)("b",{children:"Files:"})}),Object(i.jsx)("ul",{children:r})]})}},{key:"render",value:function(){var e=this,t=this.props.authUser;if(!t||!t.id)return null;var r=this.state,s=r.title,o=r.short_description,c=r.loading,n=r.proposal;if(c)return null;if(!n||!n.id)return Object(i.jsx)("div",{children:"We can't find any details"});var a=!1;return s&&o&&s.trim()&&o.trim()&&(a=!1),Object(i.jsxs)("div",{id:"app-edit-simple-proposal-page",children:[Object(i.jsx)("div",{style:{marginTop:"50px"},children:Object(i.jsx)(v.m,{title:"Edit Simple Proposal: "+n.title,link:"/app/proposals"})}),Object(i.jsxs)("form",{method:"POST",action:"",onSubmit:this.submit,children:[Object(i.jsx)(O.Fade,{distance:"20px",bottom:!0,duration:300,delay:600,children:Object(i.jsxs)("div",{className:"c-form-row mt-5",children:[Object(i.jsx)("label",{children:"Title of Proposal (limit 10 words)"}),Object(i.jsx)("input",{value:s,type:"text",onChange:function(t){return e.inputField(t,"title")},required:!0})]})}),Object(i.jsx)(O.Fade,{distance:"20px",bottom:!0,duration:300,delay:600,children:Object(i.jsxs)("div",{className:"c-form-row",children:[Object(i.jsx)("label",{children:"Describe the change you think should be passed. This can relate to governance, platform rules, or any proposal not related to a grant."}),Object(i.jsx)("textarea",{value:o,onChange:function(t){return e.inputField(t,"short_description")},required:!0})]})}),Object(i.jsx)(O.Fade,{distance:"20px",bottom:!0,duration:300,delay:600,children:Object(i.jsxs)("div",{className:"c-form-row mt-5",children:[Object(i.jsxs)("label",{children:["Drag and drop a file into this box to upload pitch deck, project architecture, charts, etc.",Object(i.jsx)("br",{}),"( Only PDF files will be accepted )"]}),Object(i.jsx)(f.a,{accept:"application/pdf",onDrop:function(t){return e.appendFiles(t)},children:function(e){var t=e.getRootProps,r=e.getInputProps;return Object(i.jsx)("section",{id:"c-dropzone",children:Object(i.jsxs)("div",g(g({},t()),{},{children:[Object(i.jsx)("input",g({},r())),Object(i.jsx)(h.a,{color:"#9B64E6"}),Object(i.jsx)("p",{className:"color-primary",children:"Add Files"})]}))})}}),this.renderFiles()]})}),Object(i.jsx)("div",{id:"c-button-wrap",children:Object(i.jsx)("button",{type:"submit",disabled:a,className:"btn btn-primary large",children:"Submit Simple Proposal"})})]})]})}}]),r}(d.Component);t.default=Object(u.b)((function(e){return{authUser:e.global.authUser}}))(Object(b.g)(_))}}]);