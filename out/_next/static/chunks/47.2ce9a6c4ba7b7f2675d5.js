(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[47],{FvLl:function(e,t,n){"use strict";n.r(t);var r=n("nKUr"),i=n("1OyB"),s=n("vuIU"),a=n("JX7q"),o=n("Ji7U"),c=n("md7G"),l=n("foSv"),u=n("KQm4"),p=n("rePB"),d=n("q1tI"),b=n.n(d),h=n("/MKj"),m=n("Ty5D"),j=n("TSYQ"),f=n.n(j),O=n("wd/R"),v=n.n(O),g=n("ZpDd"),x=n("LADp"),_=n("eySl"),y=n("I6fM"),w=n("YW6W"),k=n("J/zA"),N=n("20Bz");n("ltsK");function S(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function P(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?S(Object(n),!0).forEach((function(t){Object(p.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):S(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function C(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(l.a)(e);if(t){var i=Object(l.a)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var E,D=n("wd/R"),M=function(e){Object(o.a)(n,e);var t=C(n);function n(e){var r;return Object(i.a)(this,n),r=t.call(this,e),Object(p.a)(Object(a.a)(r),"closeForm",(function(e){e.preventDefault();var t=r.props.onClose;t&&t()})),Object(p.a)(Object(a.a)(r),"selectWhatSection",(function(e){var t=r.props.proposal,n=e.target.value,i="",s=null;"short_description"==n?i=t.short_description:"total_grant"==n?i=t.total_grant.toString():"previous_work"==n?i=t.previous_work:"other_work"==n?i=t.other_work:"milestone"==n?(i={milestones:t.milestones,total_grant:t.total_grant},s=t.milestones[0].id):"citation"==n&&(i={citations:t.citations},s=t.citations[0]?t.citations[0].id:null),r.setState({change_to:"",additional_notes:"",what_section:n,current_submission:i,current_submission_id:s},(function(){r.checkButtonStatus()}))})),Object(p.a)(Object(a.a)(r),"selectMilestone",(function(e){r.setState(P(P({},r.state),{},{current_submission_id:e.target.value,change_to:""}),(function(){r.checkButtonStatus()}))})),Object(p.a)(Object(a.a)(r),"selectCitation",(function(e){r.setState(P(P({},r.state),{},{current_submission_id:e.target.value,change_to:""}),(function(){r.checkButtonStatus()}))})),Object(p.a)(Object(a.a)(r),"submitChange",(function(e){e.preventDefault();var t=r.props,n=t.proposal,i=t.onClose,s=r.state,a=s.what_section,o=s.change_to,c=s.additional_notes;if(a.trim())if(o.trim()||"remove_membership"==a)if(c.trim())if("total_grant"!=a||o.trim()&&!(parseFloat(w.a.unformatNumber(o.toString()))<=0)){var l={proposal:n.id,what_section:a,change_to:o,additional_notes:c,grant:0};r.props.dispatch(Object(x.Uc)(l,(function(){r.props.dispatch(Object(g.Cb)())}),(function(e){r.props.dispatch(Object(g.U)()),e.success&&(i&&i(),r.props.dispatch(Object(g.Bb)("You've successfully proposed a change","success")))})))}else r.props.dispatch(Object(g.Bb)("Please input valid total grant amount"));else r.props.dispatch(Object(g.Bb)("Please input additional notes"));else r.props.dispatch(Object(g.Bb)("Please input what change you will make"));else r.props.dispatch(Object(g.Bb)("Please input what section you make a change to"))})),Object(p.a)(Object(a.a)(r),"handleKeyDown",(function(e){if("Tab"==e.key){e.preventDefault();var t=e.target.selectionStart,n=e.target.selectionEnd;e.target.value=e.target.value.substring(0,t)+"\t"+e.target.value.substring(n),e.target.selectionStart=e.target.selectionEnd=t+1}})),r.state={buttonDisabled:!0,what_section:"",change_to:"",additional_notes:"",current_submission:"",current_submission_id:null},r}return Object(s.a)(n,[{key:"inputField",value:function(e,t){var n=this;this.setState(Object(p.a)({},t,e.target.value),(function(){n.checkButtonStatus()}))}},{key:"inputEuroField",value:function(e,t){var n=this,r=e.target.value;r=w.a.unformatPriceNumber(r),isNaN(r)&&(r=""),r=w.a.adjustNumericString(r,2),this.setState(Object(p.a)({},t,r),(function(){n.checkButtonStatus()}))}},{key:"checkCitationsError",value:function(){var e=this.state,t=e.change_to,n=e.current_submission,r=e.current_submission_id;if(!t)return!0;var i=JSON.parse(t),s=0,a=!1;if(i.proposalId&&i.explanation&&""!=i.percentage)if(i.checked&&i.validProposal&&i.proposal&&i.proposal.id){if(r&&"new"!==r)s=n.citations.filter((function(e){return e.id!==r})).reduce((function(e,t){return e+ +t.percentage}),0)+ +i.percentage;else s=n.citations.reduce((function(e,t){return e+ +t.percentage}),0)+ +i.percentage}else a=!0;else a=!0;return!a&&+s>100&&(a=!0),a}},{key:"checkMilestonesError",value:function(){var e=this.state,t=e.change_to,n=e.current_submission,r=e.current_submission_id,i=this.props.proposal;if(!t)return!0;var s=!1;if(!i.total_grant||parseFloat(w.a.unformatNumber(i.total_grant))<=0)s=!0;else{var a=JSON.parse(t);a.title.trim()&&a.details.trim()&&a.criteria.trim()&&a.deadline.trim()&&a.level_difficulty.trim()&&a.checked||(s=!0);var o=n.milestones.filter((function(e){return e.id!==r})).reduce((function(e,t){return e+ +t.grant}),0);i.total_grant<o+ +a.grant&&(s=!0)}return s}},{key:"checkButtonStatus",value:function(){var e=this.state,t=e.what_section,n=e.change_to,r=e.additional_notes,i=!0;("remove_membership"==t.trim()&&r.trim()||"citation"==t.trim()&&!this.checkCitationsError()&&r.trim()||"milestone"==t.trim()&&!this.checkMilestonesError()&&r.trim()||!["milestone","citation","remove_membership"].includes(t)&&n.trim()&&r.trim())&&(i=!1),this.setState(P(P({},this.state),{},{buttonDisabled:i}))}},{key:"renderWhatSectionDropdown",value:function(){var e=this.state.what_section,t=this.props.proposal;return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsxs)("div",{className:"d-block mb-20",children:[Object(r.jsx)("label",{className:"mb-12",children:"What Section?"}),Object(r.jsxs)("select",{value:e,onChange:this.selectWhatSection,children:[Object(r.jsx)("option",{value:"",children:"Select..."}),Object(r.jsx)("option",{value:"short_description",children:"Proposal Description"}),"grant"==t.type?Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)("option",{value:"total_grant",children:"Grant Total"}),Object(r.jsx)("option",{value:"previous_work",children:"OP's Previous Work"}),Object(r.jsx)("option",{value:"other_work",children:"Other Previous Work"})]}):null,t.include_membership?Object(r.jsx)("option",{value:"remove_membership",children:"Remove Membership"}):null,t.milestones.length>0?Object(r.jsx)("option",{value:"milestone",children:"Milestone"}):null,Object(r.jsx)("option",{value:"citation",children:"Citation"})]})]}),"milestone"===e&&Object(r.jsxs)("div",{className:"d-block mb-20",children:[Object(r.jsx)("label",{className:"mb-12",children:"What Milestone?"}),Object(r.jsx)("select",{value:this.state.current_submission_id,onChange:this.selectMilestone,children:t.milestones.map((function(e,t){return Object(r.jsx)("option",{value:e.id,children:e.title},t)}))})]}),"citation"===e&&Object(r.jsxs)("div",{className:"d-block mb-20",children:[Object(r.jsx)("label",{className:"mb-12",children:"What Citation?"}),Object(r.jsxs)("select",{value:this.state.current_submission_id,onChange:this.selectCitation,children:[t.citations.map((function(e,t){return Object(r.jsxs)("option",{value:e.id,children:["Citation ",t+1]},t)})),Object(r.jsx)("option",{value:"new",children:"+ New Citation"},"new")]})]})]})}},{key:"renderMilestone",value:function(){var e=this.state,t=e.current_submission,n=e.current_submission_id,i=t.milestones.find((function(e){return e.id==n}));return Object(r.jsxs)("div",{children:[Object(r.jsx)("label",{className:"font-weight-700 d-block mb-12",children:"Title of Milestone (10 word limit)"}),Object(r.jsx)("p",{className:"mb-20",children:i.title}),Object(r.jsx)("label",{className:"font-weight-700 d-block mb-12",children:"Details of what will be delivered in milestone"}),Object(r.jsx)("p",{className:"mb-20",children:i.details}),Object(r.jsx)("label",{className:"font-weight-700 d-block mb-12",children:"Acceptance criteria: Please enter the specific details on what\n            the deliverable must do to prove this milestone is complete."}),Object(r.jsx)("p",{className:"mb-20",children:i.criteria}),Object(r.jsx)("label",{className:"font-weight-700 d-block mb-12",children:"Grant portion requested for this milestone"}),Object(r.jsx)("p",{className:"mb-20",children:w.a.formatPriceNumber(i.grant.toString())}),Object(r.jsx)("label",{className:"font-weight-700 d-block mb-12",children:"Deadline"}),Object(r.jsx)("p",{className:"mb-20",children:i.deadline?D(i.deadline).format("M/D/YYYY"):""}),Object(r.jsx)("label",{className:"font-weight-700 d-block mb-12",children:"Level of Difficulty"}),Object(r.jsx)("p",{className:"mb-20",children:i.level_difficulty})]},"milestone_".concat(n))}},{key:"renderCitation",value:function(){var e=this.state,t=e.current_submission,n=e.current_submission_id,i=t.citations.find((function(e){return e.id==n}));return Object(r.jsxs)("div",{children:[Object(r.jsx)("label",{className:"font-weight-700 d-block mb-12",children:"Cited Proposal Number"}),Object(r.jsx)("p",{className:"mb-20",children:i.rep_proposal_id}),Object(r.jsx)("label",{className:"font-weight-700 d-block mb-12",children:"Cited Proposal Title"}),Object(r.jsx)("p",{className:"mb-20",children:i.rep_proposal.title}),Object(r.jsx)("label",{className:"font-weight-700 d-block mb-12",children:"Cited Proposal OP"}),Object(r.jsx)("p",{className:"mb-20",children:i.rep_proposal.user.profile.forum_name}),Object(r.jsx)("label",{className:"font-weight-700 d-block mb-12",children:"Explain how this work is foundational to your work"}),Object(r.jsx)("p",{className:"mb-20",children:i.explanation}),Object(r.jsx)("label",{className:"font-weight-700 d-block mb-12",children:"% of the rep gained from this proposal do you wish to give to the OP of the prior work"}),Object(r.jsx)("p",{className:"mb-20",children:i.percentage})]})}},{key:"renderCurrentSubmission",value:function(){var e=this.state,t=e.current_submission,n=e.what_section,i=e.current_submission_id;return t?"total_grant"==n?Object(r.jsxs)("div",{className:"c-form-row",children:[Object(r.jsx)("label",{children:"Current Submission"}),Object(r.jsxs)("div",{className:"app-readonly-box",children:[w.a.formatPriceNumber(t)," Euro"]})]}):"milestone"===n?Object(r.jsxs)("div",{className:"c-form-row",children:[Object(r.jsx)("label",{children:"Change From"}),Object(r.jsx)("div",{className:"app-box",children:this.renderMilestone()})]}):"citation"===n?i&&"new"!==i?Object(r.jsxs)("div",{className:"c-form-row",children:[Object(r.jsx)("label",{children:"Change From"}),Object(r.jsx)("div",{className:"app-box",children:this.renderCitation()})]}):Object(r.jsx)(r.Fragment,{}):Object(r.jsxs)("div",{className:"c-form-row",children:[Object(r.jsx)("label",{children:"Current Submission"}),Object(r.jsx)("div",{className:"app-readonly-box",children:t})]}):null}},{key:"renderChangeTo",value:function(){var e=this,t=this.state,n=t.change_to,i=t.what_section,s=t.current_submission,a=t.current_submission_id;if("remove_membership"==i)return null;if(["","short_description","total_grant","previous_work","other_work"].includes(i))return Object(r.jsxs)("div",{className:"c-form-row",children:[Object(r.jsx)("label",{children:"Change to:"}),"total_grant"!=i?Object(r.jsx)("textarea",{value:n,onChange:function(t){return e.inputField(t,"change_to")}}):Object(r.jsxs)("div",{children:[Object(r.jsx)("input",{type:"text",value:w.a.formatPriceNumber(n.toString()),onChange:function(t){return e.inputEuroField(t,"change_to")}}),Object(r.jsx)("label",{children:"Euro"})]})]});if("milestone"===i){var o,c=JSON.parse(JSON.stringify(s.milestones)),l=c.findIndex((function(e){return e.id==a})),u=c[l].grant;return o=n?JSON.parse(n):c[l],Object(r.jsxs)("div",{className:"c-form-row",children:[Object(r.jsx)("label",{children:"Change to:"}),Object(r.jsx)("div",{className:"app-box",children:Object(r.jsx)(k.a,{showAction:!1,total_grant:u,milestones:[o],onUpdate:function(t){e.setState(P(P({},e.state),{},{change_to:JSON.stringify(t[0])}),(function(){e.checkButtonStatus()}))}})})]})}if("citation"===i){var p,d=JSON.parse(JSON.stringify(s.citations)),b=d.findIndex((function(e){return e.id==a}));p=n?JSON.parse(n):d[b];var h=100-s.citations.reduce((function(e,t){return e+ +t.percentage}),0);return a&&"new"!==a&&(h=+h+ +s.citations[b].percentage),Object(r.jsxs)("div",{className:"c-form-row",children:[Object(r.jsx)("label",{children:"Change to:"}),Object(r.jsx)("div",{className:"app-box",children:Object(r.jsx)(N.a,{showAction:!1,checkCustomSum:h,citations:p?[p]:[{proposalId:"",explanation:"",percentage:"",validProposal:!1,checked:!1,proposal:{}}],onUpdate:function(t){var n=P(P({},t[0]),{},{rep_proposal:t[0].proposal,rep_proposal_id:t[0].proposal?t[0].proposal.id:null});e.setState(P(P({},e.state),{},{change_to:JSON.stringify(n)}),(function(){e.checkButtonStatus()}))}})})]})}}},{key:"render",value:function(){var e=this,t=this.props.proposal;if(!t||!t.id)return null;var n=this.state,i=n.buttonDisabled,s=n.additional_notes;return Object(r.jsx)("section",{id:"app-proposal-change-form-section",children:Object(r.jsxs)("form",{method:"POST",action:"",onSubmit:this.submitChange,children:[Object(r.jsxs)("div",{id:"app-single-proposal-formTitle",children:[Object(r.jsx)("label",{children:"Suggest a Change"}),Object(r.jsx)(y.a,{size:16})]}),Object(r.jsx)("div",{className:"c-form-row what-section",children:this.renderWhatSectionDropdown()}),this.renderCurrentSubmission(),this.renderChangeTo(),Object(r.jsxs)("div",{className:"c-form-row",children:[Object(r.jsx)("label",{children:"Additional Notes/References"}),Object(r.jsx)("textarea",{onKeyDown:function(t){return e.handleKeyDown(t)},value:s,onChange:function(t){return e.inputField(t,"additional_notes")}})]}),Object(r.jsxs)("div",{id:"c-form-buttons",children:[Object(r.jsx)("button",{type:"submit",className:"btn btn-primary-outline less-small",disabled:i,children:"Propose Change"}),Object(r.jsx)("button",{type:"button",className:"btn btn-danger-outline less-small",onClick:this.closeForm,children:"Cancel"})]})]})})}}]),n}(d.Component),F=Object(h.b)((function(e){return{authUser:e.global.authUser}}))(M),I=n("fDsS"),R=n("9qeg"),T=n("e+cM");function A(){return(A=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var B,L=function(e){return d.createElement("svg",A({"data-name":"Component 147 \\u2013 1",xmlns:"http://www.w3.org/2000/svg",width:19,height:19},e),E||(E=d.createElement("g",{"data-name":"Ellipse 213",fill:"#722ed1",stroke:"#1f073e"},d.createElement("circle",{cx:9.5,cy:9.5,r:9.5,stroke:"none"}),d.createElement("circle",{cx:9.5,cy:9.5,r:9,fill:"none"}))))};function Y(){return(Y=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var J,U,W=function(e){return d.createElement("svg",Y({"data-name":"Component 149 \\u2013 1",xmlns:"http://www.w3.org/2000/svg",width:19,height:19},e),B||(B=d.createElement("g",{"data-name":"Ellipse 214",fill:"#1f073e",stroke:"#722ed1"},d.createElement("circle",{cx:9.5,cy:9.5,r:9.5,stroke:"none"}),d.createElement("circle",{cx:9.5,cy:9.5,r:9,fill:"none"}))))};function z(){return(z=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var K=function(e){return d.createElement("svg",z({"data-name":"Component 148 \\u2013 1",xmlns:"http://www.w3.org/2000/svg",width:19,height:19},e),J||(J=d.createElement("g",{"data-name":"Ellipse 213",fill:"#fff",stroke:"#1f073e"},d.createElement("circle",{cx:9.5,cy:9.5,r:9.5,stroke:"none"}),d.createElement("circle",{cx:9.5,cy:9.5,r:9,fill:"none"}))),U||(U=d.createElement("path",{"data-name":"Icon awesome-check",d:"M8.221 13.577l-3.349-3.344a.515.515 0 010-.728l.727-.728a.515.515 0 01.728 0l2.253 2.254 4.826-4.826a.515.515 0 01.728 0l.728.728a.515.515 0 010 .728l-5.918 5.916a.515.515 0 01-.723 0z",fill:"#722ed1"})))},G=(n("iBnM"),n("17x9")),q=n.n(G);function H(){return(H=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function Q(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},s=Object.keys(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var X=Object(d.forwardRef)((function(e,t){var n=e.color,r=void 0===n?"currentColor":n,i=e.size,s=void 0===i?24:i,a=Q(e,["color","size"]);return b.a.createElement("svg",H({ref:t,xmlns:"http://www.w3.org/2000/svg",width:s,height:s,viewBox:"0 0 24 24",fill:"none",stroke:r,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},a),b.a.createElement("circle",{cx:"12",cy:"12",r:"10"}),b.a.createElement("polyline",{points:"12 8 8 12 12 16"}),b.a.createElement("line",{x1:"16",y1:"12",x2:"8",y2:"12"}))}));X.propTypes={color:q.a.string,size:q.a.oneOfType([q.a.string,q.a.number])},X.displayName="ArrowLeftCircle";var Z=X;function V(){return(V=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function $(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},s=Object.keys(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var ee=Object(d.forwardRef)((function(e,t){var n=e.color,r=void 0===n?"currentColor":n,i=e.size,s=void 0===i?24:i,a=$(e,["color","size"]);return b.a.createElement("svg",V({ref:t,xmlns:"http://www.w3.org/2000/svg",width:s,height:s,viewBox:"0 0 24 24",fill:"none",stroke:r,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},a),b.a.createElement("circle",{cx:"12",cy:"12",r:"10"}),b.a.createElement("polyline",{points:"12 16 16 12 12 8"}),b.a.createElement("line",{x1:"8",y1:"12",x2:"16",y2:"12"}))}));ee.propTypes={color:q.a.string,size:q.a.oneOfType([q.a.string,q.a.number])},ee.displayName="ArrowRightCircle";var te=ee;function ne(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(l.a)(e);if(t){var i=Object(l.a)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}function re(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ie(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?re(Object(n),!0).forEach((function(t){Object(p.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):re(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var se=function(e,t){var n=e.find((function(e){return e.key===t}));return{status:!!n,datetime:n?v()(n.created_at).local().format("M/D/YYYY"):"--/--/----"}},ae=function(e,t){return[{title:"Proposal ".concat(e.id," submitted"),datetime:v()(e.created_at).local().format("M/D/YYYY")},ie({title:"Approved by admin"},se(t,"approved_by_admin")),ie({title:"Entered discussion phase"},se(t,"discussion_phase")),ie({title:"Passed survey in spot [number]"},se(t,"passed_survey_spot")),ie({title:"Informal vote started"},se(t,"informal_vote_started")),ie({title:"Informal vote passed"},se(t,"informal_vote_passed")),ie({title:"KYC checks complete"},se(t,"kyc_checks_complete")),ie({title:"ETA compliance complete"},se(t,"eta_compliance_complete")),ie({title:"Entered Formal vote"},se(t,"entered_formal_vote")),ie({title:"Passed Formal vote"},se(t,"passed_formal_vote")),ie({title:"Grant activated by ETA"},se(t,"grant_activated"))].concat(Object(u.a)(function(e,t){var n=[];return null===e||void 0===e||e.milestones.forEach((function(e,r){n.push.apply(n,[ie({title:"Milestone ".concat(r+1," submitted")},se(t,"milestone_".concat(r+1,"_submitted"))),ie({title:"Milestone ".concat(r+1," approved by CRDAO")},se(t,"milestone_".concat(r+1,"_approved_crdao"))),ie({title:"Milestone ".concat(r+1," approved by Proj. Mngmt.")},se(t,"milestone_".concat(r+1,"_approved_proj"))),ie({title:"Milestone ".concat(r+1," started informal vote")},se(t,"milestone_".concat(r+1,"_started_informal_vote"))),ie({title:"Milestone ".concat(r+1," passed informal vote")},se(t,"milestone_".concat(r+1,"_passed_informal_vote"))),ie({title:"Milestone ".concat(r+1," started formal vote")},se(t,"milestone_".concat(r+1,"_started_formal_vote"))),ie({title:"Milestone ".concat(r+1," passed formal vote")},se(t,"milestone_".concat(r+1,"_passed_formal_vote")))])})),n}(e,t)),[ie({title:"Grant 100% complete"},se(t,"grant_completed"))])},oe=function(e){Object(o.a)(n,e);var t=ne(n);function n(e){var r;return Object(i.a)(this,n),r=t.call(this,e),Object(p.a)(Object(a.a)(r),"cancelForm",(function(){r.setState({showForm:!1})})),Object(p.a)(Object(a.a)(r),"showForm",(function(){r.setState({showForm:!0})})),Object(p.a)(Object(a.a)(r),"handleRefreshLogs",(function(){r.setState(ie(ie({},r.state),{},{isShowLogs:!1})),setTimeout((function(){r.setState(ie(ie({},r.state),{},{isShowLogs:!0}))}),200)})),r.state={proposal:{},proposalId:0,loading:!1,showForm:!1,isShowLogs:!0,expandTimeline:!1,timelineList:[]},r}return Object(s.a)(n,[{key:"componentDidMount",value:function(){var e=this,t=this.props.match.params.proposalId;this.setState({proposalId:t},(function(){e.getProposal()}))}},{key:"componentDidUpdate",value:function(e){this.props.startInformalAdmin&&this.props.startInformalAdmin!==e.startInformalAdmin&&(this.props.dispatch(Object(g.Eb)(!1)),this.getProposal())}},{key:"getProposal",value:function(){var e=this,t=this.state.proposalId;this.props.dispatch(Object(x.Xb)(t,(function(){e.setState({loading:!0}),e.props.dispatch(Object(g.Cb)())}),(function(n){var r=n.proposal||{};r.milestones=r.milestones.map((function(e){return ie(ie({},e),{},{checked:!0})})),e.props.dispatch(Object(x.fc)(t,{},(function(){}),(function(n){n.success&&e.setState({loading:!1,proposalId:t,proposal:r,timelineList:ae(r,n.trackings)})}))),e.props.dispatch(Object(g.U)())})))}},{key:"renderHeader",value:function(){var e=this.props.authUser,t=this.state.proposal;if(!e||!e.id||!t||!t.id)return null;var n=t.title;if(e.is_admin&&"pending"==t.status){if("grant"==t.type)return Object(r.jsx)(T.m,{title:n,buttonData:{link:"/app/proposal/".concat(t.id,"/edit"),text:"Edit Proposal"}});if("simple"==t.type)return Object(r.jsx)(T.m,{title:n,buttonData:{link:"/app/simple-proposal/".concat(t.id,"/edit"),text:"Edit Simple Proposal"}})}return Object(r.jsx)(T.m,{title:n})}},{key:"renderDetail",value:function(){var e=this.state.proposal;return Object(r.jsx)(_.a,{isAutoExpand:"approved"===e.status&&!(e.votes&&e.votes.length),proposal:e,refreshLogs:this.handleRefreshLogs,allowEdit:!0})}},{key:"renderChangeContent",value:function(){var e=this.state,t=e.showForm,n=e.proposal;return t?Object(r.jsx)(F,{proposal:n,onClose:this.cancelForm}):this.state.isShowLogs&&Object(r.jsx)(I.a,{isAutoExpand:"approved"===n.status&&!(n.votes&&n.votes.length),proposal:n,onShow:this.showForm})}},{key:"render",value:function(){var e=this,t=this.props.authUser,n=this.state,i=n.loading,s=n.proposal,a=n.expandTimeline;if(!t||!t.id||i)return null;if(!s||!s.id)return Object(r.jsx)("div",{children:"We can't find any details"});if(t.is_admin);else if(t.is_member){if(t.id==s.user_id);else if("approved"!=s.status&&"completed"!=s.status)return Object(r.jsx)(m.a,{to:"/app"})}else if(t.id==s.user_id);else if("approved"!=s.status&&"completed"!=s.status)return Object(r.jsx)(m.a,{to:"/app"});return Object(r.jsxs)("div",{id:"app-single-proposal-page",children:[Object(r.jsx)("div",{className:f()("sidebar-timeline",a?"expand":""),children:Object(r.jsxs)("div",{className:"h-100",children:[Object(r.jsxs)("div",{onClick:function(){return e.setState({expandTimeline:!a})},style:{cursor:"pointer"},children:[a?Object(r.jsx)(te,{}):Object(r.jsx)(Z,{}),Object(r.jsx)("b",{className:"title-timeline pl-2",children:"Proposal Timeline"})]}),Object(r.jsx)("ul",{className:"h-100 content-timeline",children:this.state.timelineList.map((function(e,t){return Object(r.jsxs)("li",{className:"timeline-item",children:[Object(r.jsxs)("div",{className:"preview d-flex align-items-center",children:[Object(r.jsxs)("div",{className:"pb-3 dot",children:[0===t&&Object(r.jsx)(L,{}),0!==t&&!e.status&&Object(r.jsx)(W,{}),0!==t&&e.status&&Object(r.jsx)(K,{}),Object(r.jsx)("div",{className:"line"})]}),Object(r.jsx)("p",{className:"date-timeline pb-3 pl-2",children:e.datetime})]}),Object(r.jsxs)("div",{className:"full d-flex align-items-center",children:[Object(r.jsx)("p",{className:"date-timeline pb-3 pr-2",children:e.datetime}),Object(r.jsxs)("div",{className:"pb-3 dot",children:[0===t&&Object(r.jsx)(L,{}),0!==t&&!e.status&&Object(r.jsx)(W,{}),0!==t&&e.status&&Object(r.jsx)(K,{}),Object(r.jsx)("div",{className:"line"})]}),Object(r.jsx)("p",{className:"pb-3 pl-2",children:e.title})]})]},t)}))})]})}),Object(r.jsxs)("div",{className:"proposal-detail-box",children:[this.renderHeader(),Object(r.jsx)(R.a,{proposal:s,onRefresh:function(){return e.getProposal()}}),this.renderDetail(),this.renderChangeContent()]})]})}}]),n}(d.Component);t.default=Object(h.b)((function(e){return{authUser:e.global.authUser,settings:e.global.settings,startInformalAdmin:e.admin.startInformalAdmin}}))(Object(m.g)(oe))}}]);