(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[42],{uxVz:function(e,t,i){"use strict";i.r(t);var r=i("nKUr"),s=i("1OyB"),o=i("vuIU"),c=i("JX7q"),n=i("Ji7U"),a=i("md7G"),p=i("foSv"),l=i("rePB"),d=i("q1tI"),u=i("/MKj"),b=i("Ty5D"),h=i("wHH0"),j=i("uGH+"),f=i("yzbm"),O=i("s/m+"),v=i("e+cM"),m=i("LADp"),y=i("ZpDd");i("sKWC");function x(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function g(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?x(Object(i),!0).forEach((function(t){Object(l.a)(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):x(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function w(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,r=Object(p.a)(e);if(t){var s=Object(p.a)(this).constructor;i=Reflect.construct(r,arguments,s)}else i=r.apply(this,arguments);return Object(a.a)(this,i)}}var _=function(e){Object(n.a)(i,e);var t=w(i);function i(e){var r;return Object(s.a)(this,i),r=t.call(this,e),Object(l.a)(Object(c.a)(r),"submit",(function(e){e.preventDefault();var t=r.state,i=t.proposalId,s=t.title,o=t.short_description,c=t.files,n=t.ids_to_remove;if(s.trim())if(o.trim()){var a={title:s.trim(),short_description:o.trim()};r.props.dispatch(Object(m.fd)(i,a,(function(){r.props.dispatch(Object(y.Ab)())}),(function(e){var t=r.props.history;if(e.success&&e.proposal&&e.proposal.id)if(c&&c.length){var i=new FormData;n.length&&i.append("ids_to_remove",n.join(",")),c.forEach((function(e){e.id||(i.append("files[]",e),i.append("names[]",e.name))})),i.append("proposal",e.proposal.id),r.props.dispatch(Object(m.hd)(i,(function(){}),(function(e){e.success&&(t.push("/app/proposals"),r.props.dispatch(Object(y.zb)("You have successfully re-submitted your proposal. We will review it and keep you posted.","success")),r.props.dispatch(Object(y.T)()))})))}else t.push("/app/proposals"),r.props.dispatch(Object(y.zb)("You have successfully re-submitted your proposal. We will review it and keep you posted.","success")),r.props.dispatch(Object(y.T)());else r.props.dispatch(Object(y.T)())})))}else r.props.dispatch(Object(y.zb)("Please input short description"));else r.props.dispatch(Object(y.zb)("Please input proposal title"))})),r.state={proposal:{},proposalId:0,loading:!1,title:"",short_description:"",files:[],ids_to_remove:[]},r}return Object(o.a)(i,[{key:"componentDidMount",value:function(){var e=this,t=this.props.match.params.proposalId;this.props.dispatch(Object(m.Sb)(t,(function(){e.setState({loading:!0}),e.props.dispatch(Object(y.Ab)())}),(function(i){e.props.dispatch(Object(y.T)());var r=i.proposal||{};e.setState({loading:!1,proposalId:t,proposal:r},(function(){r&&r.id&&e.initValues(r)}))})))}},{key:"initValues",value:function(e){var t=e.title||"",i=e.short_description||"",r=e.files||[];this.setState({title:t,short_description:i,files:r})}},{key:"inputField",value:function(e,t){this.setState(Object(l.a)({},t,e.target.value))}},{key:"appendFiles",value:function(e){var t=this.state.files;t=t.concat(e),this.setState({files:t})}},{key:"removeFile",value:function(e){var t=this.state,i=t.files,r=t.ids_to_remove,s=i[e];s&&s.id&&!r.includes(s.id)&&r.push(s.id),i.splice(e,1),this.setState({files:i,ids_to_remove:r})}},{key:"renderFiles",value:function(){var e=this,t=this.state.files;if(!t||!t.length)return null;var i=[];return t.forEach((function(t,s){i.push(Object(r.jsxs)("li",{children:[Object(r.jsx)("p",{children:t.name||t}),Object(r.jsx)(h.a,{onClick:function(){return e.removeFile(s)}})]},"file_".concat(s)))})),Object(r.jsxs)("div",{id:"files-wrap",children:[Object(r.jsx)("label",{children:Object(r.jsx)("b",{children:"Files:"})}),Object(r.jsx)("ul",{children:i})]})}},{key:"render",value:function(){var e=this,t=this.props.authUser;if(!t||!t.id)return null;var i=this.state,s=i.title,o=i.short_description,c=i.loading,n=i.proposal;if(c)return null;if(!n||!n.id)return Object(r.jsx)("div",{children:"We can't find any details"});var a=!1;return s&&o&&s.trim()&&o.trim()&&(a=!1),Object(r.jsxs)("div",{id:"app-edit-simple-proposal-page",children:[Object(r.jsx)("div",{style:{marginTop:"50px"},children:Object(r.jsx)(v.i,{title:"Edit Simple Proposal: "+n.title,link:"/app/proposals"})}),Object(r.jsxs)("form",{method:"POST",action:"",onSubmit:this.submit,children:[Object(r.jsx)(O.Fade,{distance:"20px",bottom:!0,duration:300,delay:600,children:Object(r.jsxs)("div",{className:"c-form-row mt-5",children:[Object(r.jsx)("label",{children:"Title of Proposal (limit 10 words)"}),Object(r.jsx)("input",{value:s,type:"text",onChange:function(t){return e.inputField(t,"title")},required:!0})]})}),Object(r.jsx)(O.Fade,{distance:"20px",bottom:!0,duration:300,delay:600,children:Object(r.jsxs)("div",{className:"c-form-row",children:[Object(r.jsx)("label",{children:"Describe the change you think should be passed. This can relate to governance, platform rules, or any proposal not related to a grant."}),Object(r.jsx)("textarea",{value:o,onChange:function(t){return e.inputField(t,"short_description")},required:!0})]})}),Object(r.jsx)(O.Fade,{distance:"20px",bottom:!0,duration:300,delay:600,children:Object(r.jsxs)("div",{className:"c-form-row mt-5",children:[Object(r.jsxs)("label",{children:["Drag and drop a file into this box to upload pitch deck, project architecture, charts, etc.",Object(r.jsx)("br",{}),"( Only PDF files will be accepted )"]}),Object(r.jsx)(f.a,{accept:"application/pdf",onDrop:function(t){return e.appendFiles(t)},children:function(e){var t=e.getRootProps,i=e.getInputProps;return Object(r.jsx)("section",{id:"c-dropzone",children:Object(r.jsxs)("div",g(g({},t()),{},{children:[Object(r.jsx)("input",g({},i())),Object(r.jsx)(j.a,{color:"#9B64E6"}),Object(r.jsx)("p",{className:"color-primary",children:"Add Files"})]}))})}}),this.renderFiles()]})}),Object(r.jsx)("div",{id:"c-button-wrap",children:Object(r.jsx)("button",{type:"submit",disabled:a,className:"btn btn-primary large",children:"Submit Simple Proposal"})})]})]})}}]),i}(d.Component);t.default=Object(u.b)((function(e){return{authUser:e.global.authUser}}))(Object(b.g)(_))}}]);