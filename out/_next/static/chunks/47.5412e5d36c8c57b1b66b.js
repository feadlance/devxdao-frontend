(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[47],{FvLl:function(e,t,n){"use strict";n.r(t);var s=n("nKUr"),r=n("1OyB"),i=n("vuIU"),a=n("JX7q"),o=n("Ji7U"),c=n("md7G"),l=n("foSv"),u=n("KQm4"),d=n("rePB"),p=n("q1tI"),b=n("/MKj"),m=n("Ty5D"),h=n("TSYQ"),j=n.n(h),f=n("wd/R"),O=n.n(f),v=n("ZpDd"),g=n("LADp"),_=n("eySl"),x=n("I6fM"),w=n("YW6W"),y=n("J/zA"),k=n("20Bz");n("ltsK");function N(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,s)}return n}function S(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?N(Object(n),!0).forEach((function(t){Object(d.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):N(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function P(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,s=Object(l.a)(e);if(t){var r=Object(l.a)(this).constructor;n=Reflect.construct(s,arguments,r)}else n=s.apply(this,arguments);return Object(c.a)(this,n)}}var C,D=n("wd/R"),E=function(e){Object(o.a)(n,e);var t=P(n);function n(e){var s;return Object(r.a)(this,n),s=t.call(this,e),Object(d.a)(Object(a.a)(s),"closeForm",(function(e){e.preventDefault();var t=s.props.onClose;t&&t()})),Object(d.a)(Object(a.a)(s),"selectWhatSection",(function(e){var t=s.props.proposal,n=e.target.value,r="",i=null;"short_description"==n?r=t.short_description:"total_grant"==n?r=t.total_grant.toString():"previous_work"==n?r=t.previous_work:"other_work"==n?r=t.other_work:"milestone"==n?(r={milestones:t.milestones,total_grant:t.total_grant},i=t.milestones[0].id):"citation"==n&&(r={citations:t.citations},i=t.citations[0]?t.citations[0].id:null),s.setState({change_to:"",additional_notes:"",what_section:n,current_submission:r,current_submission_id:i},(function(){s.checkButtonStatus()}))})),Object(d.a)(Object(a.a)(s),"selectMilestone",(function(e){s.setState(S(S({},s.state),{},{current_submission_id:e.target.value,change_to:""}),(function(){s.checkButtonStatus()}))})),Object(d.a)(Object(a.a)(s),"selectCitation",(function(e){s.setState(S(S({},s.state),{},{current_submission_id:e.target.value,change_to:""}),(function(){s.checkButtonStatus()}))})),Object(d.a)(Object(a.a)(s),"submitChange",(function(e){e.preventDefault();var t=s.props,n=t.proposal,r=t.onClose,i=s.state,a=i.what_section,o=i.change_to,c=i.additional_notes;if(a.trim())if(o.trim()||"remove_membership"==a)if(c.trim())if("total_grant"!=a||o.trim()&&!(parseFloat(w.a.unformatNumber(o.toString()))<=0)){var l={proposal:n.id,what_section:a,change_to:o,additional_notes:c,grant:0};s.props.dispatch(Object(g.Vc)(l,(function(){s.props.dispatch(Object(v.Cb)())}),(function(e){s.props.dispatch(Object(v.U)()),e.success&&(r&&r(),s.props.dispatch(Object(v.Bb)("You've successfully proposed a change","success")))})))}else s.props.dispatch(Object(v.Bb)("Please input valid total grant amount"));else s.props.dispatch(Object(v.Bb)("Please input additional notes"));else s.props.dispatch(Object(v.Bb)("Please input what change you will make"));else s.props.dispatch(Object(v.Bb)("Please input what section you make a change to"))})),Object(d.a)(Object(a.a)(s),"handleKeyDown",(function(e){if("Tab"==e.key){e.preventDefault();var t=e.target.selectionStart,n=e.target.selectionEnd;e.target.value=e.target.value.substring(0,t)+"\t"+e.target.value.substring(n),e.target.selectionStart=e.target.selectionEnd=t+1}})),s.state={buttonDisabled:!0,what_section:"",change_to:"",additional_notes:"",current_submission:"",current_submission_id:null},s}return Object(i.a)(n,[{key:"inputField",value:function(e,t){var n=this;this.setState(Object(d.a)({},t,e.target.value),(function(){n.checkButtonStatus()}))}},{key:"inputEuroField",value:function(e,t){var n=this,s=e.target.value;s=w.a.unformatPriceNumber(s),isNaN(s)&&(s=""),s=w.a.adjustNumericString(s,2),this.setState(Object(d.a)({},t,s),(function(){n.checkButtonStatus()}))}},{key:"checkCitationsError",value:function(){var e=this.state,t=e.change_to,n=e.current_submission,s=e.current_submission_id;if(!t)return!0;var r=JSON.parse(t),i=0,a=!1;if(r.proposalId&&r.explanation&&""!=r.percentage)if(r.checked&&r.validProposal&&r.proposal&&r.proposal.id){if(s&&"new"!==s)i=n.citations.filter((function(e){return e.id!==s})).reduce((function(e,t){return e+ +t.percentage}),0)+ +r.percentage;else i=n.citations.reduce((function(e,t){return e+ +t.percentage}),0)+ +r.percentage}else a=!0;else a=!0;return!a&&+i>100&&(a=!0),a}},{key:"checkMilestonesError",value:function(){var e=this.state,t=e.change_to,n=e.current_submission,s=e.current_submission_id,r=this.props.proposal;if(!t)return!0;var i=!1;if(!r.total_grant||parseFloat(w.a.unformatNumber(r.total_grant))<=0)i=!0;else{var a=JSON.parse(t);a.title.trim()&&a.details.trim()&&a.criteria.trim()&&a.deadline.trim()&&a.level_difficulty.trim()&&a.checked||(i=!0);var o=n.milestones.filter((function(e){return e.id!==s})).reduce((function(e,t){return e+ +t.grant}),0);r.total_grant<o+ +a.grant&&(i=!0)}return i}},{key:"checkButtonStatus",value:function(){var e=this.state,t=e.what_section,n=e.change_to,s=e.additional_notes,r=!0;("remove_membership"==t.trim()&&s.trim()||"citation"==t.trim()&&!this.checkCitationsError()&&s.trim()||"milestone"==t.trim()&&!this.checkMilestonesError()&&s.trim()||!["milestone","citation","remove_membership"].includes(t)&&n.trim()&&s.trim())&&(r=!1),this.setState(S(S({},this.state),{},{buttonDisabled:r}))}},{key:"renderWhatSectionDropdown",value:function(){var e=this.state.what_section,t=this.props.proposal;return Object(s.jsxs)(s.Fragment,{children:[Object(s.jsxs)("div",{className:"d-block mb-20",children:[Object(s.jsx)("label",{className:"mb-12",children:"What Section?"}),Object(s.jsxs)("select",{value:e,onChange:this.selectWhatSection,children:[Object(s.jsx)("option",{value:"",children:"Select..."}),Object(s.jsx)("option",{value:"short_description",children:"Proposal Description"}),"grant"==t.type?Object(s.jsxs)(s.Fragment,{children:[Object(s.jsx)("option",{value:"total_grant",children:"Grant Total"}),Object(s.jsx)("option",{value:"previous_work",children:"OP's Previous Work"}),Object(s.jsx)("option",{value:"other_work",children:"Other Previous Work"})]}):null,t.include_membership?Object(s.jsx)("option",{value:"remove_membership",children:"Remove Membership"}):null,t.milestones.length>0?Object(s.jsx)("option",{value:"milestone",children:"Milestone"}):null,Object(s.jsx)("option",{value:"citation",children:"Citation"})]})]}),"milestone"===e&&Object(s.jsxs)("div",{className:"d-block mb-20",children:[Object(s.jsx)("label",{className:"mb-12",children:"What Milestone?"}),Object(s.jsx)("select",{value:this.state.current_submission_id,onChange:this.selectMilestone,children:t.milestones.map((function(e,t){return Object(s.jsx)("option",{value:e.id,children:e.title},t)}))})]}),"citation"===e&&Object(s.jsxs)("div",{className:"d-block mb-20",children:[Object(s.jsx)("label",{className:"mb-12",children:"What Citation?"}),Object(s.jsxs)("select",{value:this.state.current_submission_id,onChange:this.selectCitation,children:[t.citations.map((function(e,t){return Object(s.jsxs)("option",{value:e.id,children:["Citation ",t+1]},t)})),Object(s.jsx)("option",{value:"new",children:"+ New Citation"},"new")]})]})]})}},{key:"renderMilestone",value:function(){var e=this.state,t=e.current_submission,n=e.current_submission_id,r=t.milestones.find((function(e){return e.id==n}));return Object(s.jsxs)("div",{children:[Object(s.jsx)("label",{className:"font-weight-700 d-block mb-12",children:"Title of Milestone (10 word limit)"}),Object(s.jsx)("p",{className:"mb-20",children:r.title}),Object(s.jsx)("label",{className:"font-weight-700 d-block mb-12",children:"Details of what will be delivered in milestone"}),Object(s.jsx)("p",{className:"mb-20",children:r.details}),Object(s.jsx)("label",{className:"font-weight-700 d-block mb-12",children:"Acceptance criteria: Please enter the specific details on what\n            the deliverable must do to prove this milestone is complete."}),Object(s.jsx)("p",{className:"mb-20",children:r.criteria}),Object(s.jsx)("label",{className:"font-weight-700 d-block mb-12",children:"Grant portion requested for this milestone"}),Object(s.jsx)("p",{className:"mb-20",children:w.a.formatPriceNumber(r.grant.toString())}),Object(s.jsx)("label",{className:"font-weight-700 d-block mb-12",children:"Deadline"}),Object(s.jsx)("p",{className:"mb-20",children:r.deadline?D(r.deadline).format("M/D/YYYY"):""}),Object(s.jsx)("label",{className:"font-weight-700 d-block mb-12",children:"Level of Difficulty"}),Object(s.jsx)("p",{className:"mb-20",children:r.level_difficulty})]},"milestone_".concat(n))}},{key:"renderCitation",value:function(){var e=this.state,t=e.current_submission,n=e.current_submission_id,r=t.citations.find((function(e){return e.id==n}));return Object(s.jsxs)("div",{children:[Object(s.jsx)("label",{className:"font-weight-700 d-block mb-12",children:"Cited Proposal Number"}),Object(s.jsx)("p",{className:"mb-20",children:r.rep_proposal_id}),Object(s.jsx)("label",{className:"font-weight-700 d-block mb-12",children:"Cited Proposal Title"}),Object(s.jsx)("p",{className:"mb-20",children:r.rep_proposal.title}),Object(s.jsx)("label",{className:"font-weight-700 d-block mb-12",children:"Cited Proposal OP"}),Object(s.jsx)("p",{className:"mb-20",children:r.rep_proposal.user.profile.forum_name}),Object(s.jsx)("label",{className:"font-weight-700 d-block mb-12",children:"Explain how this work is foundational to your work"}),Object(s.jsx)("p",{className:"mb-20",children:r.explanation}),Object(s.jsx)("label",{className:"font-weight-700 d-block mb-12",children:"% of the rep gained from this proposal do you wish to give to the OP of the prior work"}),Object(s.jsx)("p",{className:"mb-20",children:r.percentage})]})}},{key:"renderCurrentSubmission",value:function(){var e=this.state,t=e.current_submission,n=e.what_section,r=e.current_submission_id;return t?"total_grant"==n?Object(s.jsxs)("div",{className:"c-form-row",children:[Object(s.jsx)("label",{children:"Current Submission"}),Object(s.jsxs)("div",{className:"app-readonly-box",children:[w.a.formatPriceNumber(t)," Euro"]})]}):"milestone"===n?Object(s.jsxs)("div",{className:"c-form-row",children:[Object(s.jsx)("label",{children:"Change From"}),Object(s.jsx)("div",{className:"app-box",children:this.renderMilestone()})]}):"citation"===n?r&&"new"!==r?Object(s.jsxs)("div",{className:"c-form-row",children:[Object(s.jsx)("label",{children:"Change From"}),Object(s.jsx)("div",{className:"app-box",children:this.renderCitation()})]}):Object(s.jsx)(s.Fragment,{}):Object(s.jsxs)("div",{className:"c-form-row",children:[Object(s.jsx)("label",{children:"Current Submission"}),Object(s.jsx)("div",{className:"app-readonly-box",children:t})]}):null}},{key:"renderChangeTo",value:function(){var e=this,t=this.state,n=t.change_to,r=t.what_section,i=t.current_submission,a=t.current_submission_id;if("remove_membership"==r)return null;if(["","short_description","total_grant","previous_work","other_work"].includes(r))return Object(s.jsxs)("div",{className:"c-form-row",children:[Object(s.jsx)("label",{children:"Change to:"}),"total_grant"!=r?Object(s.jsx)("textarea",{value:n,onChange:function(t){return e.inputField(t,"change_to")}}):Object(s.jsxs)("div",{children:[Object(s.jsx)("input",{type:"text",value:w.a.formatPriceNumber(n.toString()),onChange:function(t){return e.inputEuroField(t,"change_to")}}),Object(s.jsx)("label",{children:"Euro"})]})]});if("milestone"===r){var o,c=JSON.parse(JSON.stringify(i.milestones)),l=c.findIndex((function(e){return e.id==a})),u=c[l].grant;return o=n?JSON.parse(n):c[l],Object(s.jsxs)("div",{className:"c-form-row",children:[Object(s.jsx)("label",{children:"Change to:"}),Object(s.jsx)("div",{className:"app-box",children:Object(s.jsx)(y.a,{showAction:!1,total_grant:u,milestones:[o],onUpdate:function(t){e.setState(S(S({},e.state),{},{change_to:JSON.stringify(t[0])}),(function(){e.checkButtonStatus()}))}})})]})}if("citation"===r){var d,p=JSON.parse(JSON.stringify(i.citations)),b=p.findIndex((function(e){return e.id==a}));d=n?JSON.parse(n):p[b];var m=100-i.citations.reduce((function(e,t){return e+ +t.percentage}),0);return a&&"new"!==a&&(m=+m+ +i.citations[b].percentage),Object(s.jsxs)("div",{className:"c-form-row",children:[Object(s.jsx)("label",{children:"Change to:"}),Object(s.jsx)("div",{className:"app-box",children:Object(s.jsx)(k.a,{showAction:!1,checkCustomSum:m,citations:d?[d]:[{proposalId:"",explanation:"",percentage:"",validProposal:!1,checked:!1,proposal:{}}],onUpdate:function(t){var n=S(S({},t[0]),{},{rep_proposal:t[0].proposal,rep_proposal_id:t[0].proposal?t[0].proposal.id:null});e.setState(S(S({},e.state),{},{change_to:JSON.stringify(n)}),(function(){e.checkButtonStatus()}))}})})]})}}},{key:"render",value:function(){var e=this,t=this.props.proposal;if(!t||!t.id)return null;var n=this.state,r=n.buttonDisabled,i=n.additional_notes;return Object(s.jsx)("section",{id:"app-proposal-change-form-section",children:Object(s.jsxs)("form",{method:"POST",action:"",onSubmit:this.submitChange,children:[Object(s.jsxs)("div",{id:"app-single-proposal-formTitle",children:[Object(s.jsx)("label",{children:"Suggest a Change"}),Object(s.jsx)(x.a,{size:16})]}),Object(s.jsx)("div",{className:"c-form-row what-section",children:this.renderWhatSectionDropdown()}),this.renderCurrentSubmission(),this.renderChangeTo(),Object(s.jsxs)("div",{className:"c-form-row",children:[Object(s.jsx)("label",{children:"Additional Notes/References"}),Object(s.jsx)("textarea",{onKeyDown:function(t){return e.handleKeyDown(t)},value:i,onChange:function(t){return e.inputField(t,"additional_notes")}})]}),Object(s.jsxs)("div",{id:"c-form-buttons",children:[Object(s.jsx)("button",{type:"submit",className:"btn btn-primary-outline less-small",disabled:r,children:"Propose Change"}),Object(s.jsx)("button",{type:"button",className:"btn btn-danger-outline less-small",onClick:this.closeForm,children:"Cancel"})]})]})})}}]),n}(p.Component),M=Object(b.b)((function(e){return{authUser:e.global.authUser}}))(E),Y=n("fDsS"),F=n("9qeg"),I=n("e+cM");function R(){return(R=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e}).apply(this,arguments)}var A,B=function(e){return p.createElement("svg",R({"data-name":"Component 147 \\u2013 1",xmlns:"http://www.w3.org/2000/svg",width:19,height:19},e),C||(C=p.createElement("g",{"data-name":"Ellipse 213",fill:"#722ed1",stroke:"#1f073e"},p.createElement("circle",{cx:9.5,cy:9.5,r:9.5,stroke:"none"}),p.createElement("circle",{cx:9.5,cy:9.5,r:9,fill:"none"}))))};function T(){return(T=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e}).apply(this,arguments)}var J,U,L=function(e){return p.createElement("svg",T({"data-name":"Component 149 \\u2013 1",xmlns:"http://www.w3.org/2000/svg",width:19,height:19},e),A||(A=p.createElement("g",{"data-name":"Ellipse 214",fill:"#1f073e",stroke:"#722ed1"},p.createElement("circle",{cx:9.5,cy:9.5,r:9.5,stroke:"none"}),p.createElement("circle",{cx:9.5,cy:9.5,r:9,fill:"none"}))))};function W(){return(W=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e}).apply(this,arguments)}var K=function(e){return p.createElement("svg",W({"data-name":"Component 148 \\u2013 1",xmlns:"http://www.w3.org/2000/svg",width:19,height:19},e),J||(J=p.createElement("g",{"data-name":"Ellipse 213",fill:"#fff",stroke:"#1f073e"},p.createElement("circle",{cx:9.5,cy:9.5,r:9.5,stroke:"none"}),p.createElement("circle",{cx:9.5,cy:9.5,r:9,fill:"none"}))),U||(U=p.createElement("path",{"data-name":"Icon awesome-check",d:"M8.221 13.577l-3.349-3.344a.515.515 0 010-.728l.727-.728a.515.515 0 01.728 0l2.253 2.254 4.826-4.826a.515.515 0 01.728 0l.728.728a.515.515 0 010 .728l-5.918 5.916a.515.515 0 01-.723 0z",fill:"#722ed1"})))};n("iBnM");function G(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,s=Object(l.a)(e);if(t){var r=Object(l.a)(this).constructor;n=Reflect.construct(s,arguments,r)}else n=s.apply(this,arguments);return Object(c.a)(this,n)}}function q(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,s)}return n}function z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?q(Object(n),!0).forEach((function(t){Object(d.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):q(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var H=function(e,t){var n=e.find((function(e){return e.key===t}));return{status:!!n,datetime:n?O()(n.created_at).local().format("M/D/YYYY"):"--/--/----"}},Q=function(e,t){var n=e.find((function(e){return e.key===t}));return n?{title:n.event,status:!!n,datetime:n?O()(n.created_at).local().format("M/D/YYYY"):"--/--/----"}:null},V=function(e,t,n){var s=e.find((function(e){return"informal_vote_started"===e.key})),r=e.find((function(e){return e.key===t}));return s?r?{title:n,status:!0,datetime:r?O()(r.created_at).local().format("M/D/YYYY"):"--/--/----"}:null:{title:n,status:!!r,datetime:r?O()(r.created_at).local().format("M/D/YYYY"):"--/--/----"}},X=function(e,t){return[{title:"Proposal ".concat(e.id," submitted"),datetime:O()(e.created_at).local().format("M/D/YYYY")},z({title:"Approved by admin"},H(t,"approved_by_admin")),z({title:"Entered discussion phase"},H(t,"discussion_phase")),Q(t,"passed_survey_spot"),V(t,"kyc_checks_complete","KYC checks complete"),V(t,"eta_compliance_complete","ETA compliance complete"),z({title:"Informal vote started"},H(t,"informal_vote_started")),z({title:"Informal vote passed"},H(t,"informal_vote_passed")),z({title:"Entered Formal vote"},H(t,"entered_formal_vote")),z({title:"Passed Formal vote"},H(t,"passed_formal_vote")),z({title:"Grant activated by ETA"},H(t,"grant_activated"))].concat(Object(u.a)(function(e,t){var n=[];return null===e||void 0===e||e.milestones.forEach((function(e,s){n.push.apply(n,[z({title:"Milestone ".concat(s+1," submitted")},H(t,"milestone_".concat(s+1,"_submitted"))),z({title:"Milestone ".concat(s+1," approved by CRDAO")},H(t,"milestone_".concat(s+1,"_approved_crdao"))),z({title:"Milestone ".concat(s+1," approved by Proj. Mngmt.")},H(t,"milestone_".concat(s+1,"_approved_proj"))),z({title:"Milestone ".concat(s+1," started informal vote")},H(t,"milestone_".concat(s+1,"_started_informal_vote"))),z({title:"Milestone ".concat(s+1," passed informal vote")},H(t,"milestone_".concat(s+1,"_passed_informal_vote"))),z({title:"Milestone ".concat(s+1," started formal vote")},H(t,"milestone_".concat(s+1,"_started_formal_vote"))),z({title:"Milestone ".concat(s+1," passed formal vote")},H(t,"milestone_".concat(s+1,"_passed_formal_vote")))])})),n}(e,t)),[z({title:"Grant 100% complete"},H(t,"grant_completed"))]).filter((function(e){return!!e}))},Z=function(e){Object(o.a)(n,e);var t=G(n);function n(e){var s;return Object(r.a)(this,n),s=t.call(this,e),Object(d.a)(Object(a.a)(s),"cancelForm",(function(){s.setState({showForm:!1})})),Object(d.a)(Object(a.a)(s),"showForm",(function(){s.setState({showForm:!0})})),Object(d.a)(Object(a.a)(s),"handleRefreshLogs",(function(){s.setState(z(z({},s.state),{},{isShowLogs:!1})),setTimeout((function(){s.setState(z(z({},s.state),{},{isShowLogs:!0}))}),200)})),s.state={proposal:{},proposalId:0,loading:!1,showForm:!1,isShowLogs:!0,expandTimeline:!0,timelineList:[]},s}return Object(i.a)(n,[{key:"componentDidMount",value:function(){var e=this,t=this.props.match.params.proposalId;this.setState({proposalId:t},(function(){e.getProposal()}))}},{key:"componentDidUpdate",value:function(e){this.props.startInformalAdmin&&this.props.startInformalAdmin!==e.startInformalAdmin&&(this.props.dispatch(Object(v.Eb)(!1)),this.getProposal())}},{key:"getProposal",value:function(){var e=this,t=this.state.proposalId;this.props.dispatch(Object(g.Yb)(t,(function(){e.setState({loading:!0}),e.props.dispatch(Object(v.Cb)())}),(function(n){var s=n.proposal||{};s.milestones=s.milestones.map((function(e){return z(z({},e),{},{checked:!0})})),e.props.dispatch(Object(g.gc)(t,{},(function(){}),(function(n){n.success&&e.setState({loading:!1,proposalId:t,proposal:s,timelineList:X(s,n.trackings)})}))),e.props.dispatch(Object(v.U)())})))}},{key:"renderHeader",value:function(){var e=this.props.authUser,t=this.state.proposal;if(!e||!e.id||!t||!t.id)return null;var n=t.title;if(e.is_admin&&"pending"==t.status){if("grant"==t.type)return Object(s.jsx)(I.m,{title:n,buttonData:{link:"/app/proposal/".concat(t.id,"/edit"),text:"Edit Proposal"}});if("simple"==t.type)return Object(s.jsx)(I.m,{title:n,buttonData:{link:"/app/simple-proposal/".concat(t.id,"/edit"),text:"Edit Simple Proposal"}})}return Object(s.jsx)(I.m,{title:n})}},{key:"renderDetail",value:function(){var e=this.state.proposal;return Object(s.jsx)(_.a,{isAutoExpand:"approved"===e.status&&!(e.votes&&e.votes.length),proposal:e,refreshLogs:this.handleRefreshLogs,allowEdit:!0})}},{key:"renderChangeContent",value:function(){var e=this.state,t=e.showForm,n=e.proposal;return t?Object(s.jsx)(M,{proposal:n,onClose:this.cancelForm}):this.state.isShowLogs&&Object(s.jsx)(Y.a,{isAutoExpand:"approved"===n.status&&!(n.votes&&n.votes.length),proposal:n,onShow:this.showForm})}},{key:"render",value:function(){var e=this,t=this.props.authUser,n=this.state,r=n.loading,i=n.proposal,a=n.expandTimeline;if(!t||!t.id||r)return null;if(!i||!i.id)return Object(s.jsx)("div",{children:"We can't find any details"});if(t.is_admin);else if(t.is_member){if(t.id==i.user_id);else if("approved"!=i.status&&"completed"!=i.status)return Object(s.jsx)(m.a,{to:"/app"})}else if(t.id==i.user_id);else if("approved"!=i.status&&"completed"!=i.status)return Object(s.jsx)(m.a,{to:"/app"});return Object(s.jsxs)("div",{id:"app-single-proposal-page",children:[this.renderHeader(),Object(s.jsx)(F.a,{proposal:i,onRefresh:function(){return e.getProposal()}}),Object(s.jsxs)("div",{className:"d-flex gap-box",children:[Object(s.jsxs)("div",{className:"proposal-detail-box",children:[this.renderDetail(),this.renderChangeContent()]}),"grant"===i.type&&Object(s.jsx)("div",{className:j()("sidebar-timeline",a?"expand":""),children:Object(s.jsxs)("div",{className:"app-simple-section",children:[Object(s.jsx)("div",{className:"d-flex",style:{cursor:"pointer"},children:Object(s.jsx)("b",{className:"title-timeline pl-2",children:"Proposal Timeline"})}),Object(s.jsx)("ul",{className:"h-100 content-timeline",children:this.state.timelineList.map((function(e,t){return Object(s.jsxs)("li",{className:"timeline-item",children:[Object(s.jsxs)("div",{className:"preview d-flex align-items-center",children:[Object(s.jsxs)("div",{className:"pb-3 dot",children:[0===t&&Object(s.jsx)(B,{}),0!==t&&!e.status&&Object(s.jsx)(L,{}),0!==t&&e.status&&Object(s.jsx)(K,{}),Object(s.jsx)("div",{className:"line"})]}),Object(s.jsx)("p",{className:"date-timeline pb-3 pl-2",children:e.datetime})]}),Object(s.jsxs)("div",{className:"full d-flex",children:[Object(s.jsx)("p",{className:"date-timeline",children:e.datetime}),Object(s.jsxs)("div",{className:"pb-3 dot",children:[0===t&&Object(s.jsx)(B,{}),0!==t&&!e.status&&Object(s.jsx)(L,{}),0!==t&&e.status&&Object(s.jsx)(K,{}),Object(s.jsx)("div",{className:"line"})]}),Object(s.jsx)("p",{children:e.title})]})]},t)}))})]})})]})]})}}]),n}(p.Component);t.default=Object(b.b)((function(e){return{authUser:e.global.authUser,settings:e.global.settings,startInformalAdmin:e.admin.startInformalAdmin}}))(Object(m.g)(Z))}}]);