(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[37],{YH6k:function(e,t,c){"use strict";c.r(t);var s=c("nKUr"),n=c("1OyB"),i=c("vuIU"),a=c("Ji7U"),r=c("md7G"),l=c("foSv"),o=c("q1tI"),d=c("/MKj"),u=c("Ty5D"),h=c("KQm4"),b=c("JX7q"),j=c("rePB"),p=c("s/m+"),f=c("ZpDd"),m=c("LADp"),v=c("e+cM");c("0R8r");function O(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var c,s=Object(l.a)(e);if(t){var n=Object(l.a)(this).constructor;c=Reflect.construct(s,arguments,n)}else c=s.apply(this,arguments);return Object(r.a)(this,c)}}var g=c("wd/R"),x=function(e){Object(a.a)(c,e);var t=O(c);function c(e){var s;return Object(n.a)(this,c),s=t.call(this,e),Object(j.a)(Object(b.a)(s),"trackScroll",(function(){s.$elem&&s.$elem.scrollTop+s.$elem.clientHeight>=s.$elem.scrollHeight&&s.runNextPage()})),Object(j.a)(Object(b.a)(s),"handleSearch",(function(e){s.setState({search:e.target.value},(function(){s.timer&&(clearTimeout(s.timer),s.timer=null),s.timer=setTimeout((function(){s.reloadTable()}),500)}))})),s.state={loading:!1,votes:[],sort_key:"vote.id",sort_direction:"desc",search:"",page_id:1,calling:!1,finished:!1},s.$elem=null,s.timer=null,s}return Object(i.a)(c,[{key:"componentDidMount",value:function(){this.startTracking(),this.getVotes()}},{key:"componentDidUpdate",value:function(e){var t=this.props.moveToFormalTableStatus;!e.moveToFormalTableStatus&&t&&(this.reloadTable(),this.props.dispatch(Object(f.lb)(!1)))}},{key:"componentWillUnmount",value:function(){this.$elem&&this.$elem.removeEventListener("scroll",this.trackScroll)}},{key:"startTracking",value:function(){this.$elem=document.getElementById("app-move-to-formal-sectionBody"),this.$elem.addEventListener("scroll",this.trackScroll)}},{key:"reloadTable",value:function(){var e=this;this.setState({page_id:1,votes:[],finished:!1},(function(){e.getVotes()}))}},{key:"runNextPage",value:function(){var e=this,t=this.state,c=t.calling,s=t.loading,n=t.finished,i=t.page_id;c||s||n||this.setState({page_id:i+1},(function(){e.getVotes(!1)}))}},{key:"getVotes",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],c=this.state,s=c.calling,n=c.loading,i=c.finished,a=c.sort_key,r=c.sort_direction,l=c.search,o=c.page_id,d=c.votes;if(!(n||s||i)){var u={sort_key:a,sort_direction:r,search:l,page_id:o};this.props.dispatch(Object(m.qb)(u,(function(){t?e.setState({loading:!0,calling:!0}):e.setState({loading:!1,calling:!0})}),(function(t){var c=t.votes||[],s=t.finished||!1;e.setState({loading:!1,calling:!1,finished:s,votes:[].concat(Object(h.a)(d),Object(h.a)(c))})})))}}},{key:"clickRow",value:function(e){var t=this.props,c=t.authUser,s=t.history;(c.is_member||c.is_admin)&&s.push("/app/proposal/".concat(e.proposal_id))}},{key:"clickStartFormal",value:function(e){var t=this;confirm("Are you sure you are going to start the formal voting?")&&("milestone"==e.content_type?this.props.dispatch(Object(m.jc)(e.proposal_id,e.id,(function(){t.props.dispatch(Object(f.wb)())}),(function(e){t.props.dispatch(Object(f.P)()),e.success&&(t.props.dispatch(Object(f.vb)("Formal voting process has been started successfully","success")),t.reloadTable())}))):this.props.dispatch(Object(m.lc)(e.proposal_id,!1,(function(){t.props.dispatch(Object(f.wb)())}),(function(e){t.props.dispatch(Object(f.P)()),e.success&&(t.props.dispatch(Object(f.vb)("Formal voting process has been started successfully","success")),t.reloadTable())}))))}},{key:"renderTriangle",value:function(e){var t=this.state,c=t.sort_key,n=t.sort_direction;return c!=e?Object(s.jsx)("span",{className:"inactive",children:"\u25b2"}):"asc"==n?Object(s.jsx)("span",{children:"\u25b2"}):Object(s.jsx)("span",{children:"\u25bc"})}},{key:"clickHeader",value:function(e){var t=this,c=this.state,s=c.sort_key,n=c.sort_direction;s==e?n="asc"==n?"desc":"asc":(s=e,n="desc"),this.setState({sort_key:s,sort_direction:n},(function(){t.reloadTable()}))}},{key:"renderHeader",value:function(){var e=this;return Object(s.jsx)("div",{className:"infinite-header",children:Object(s.jsxs)("div",{className:"infinite-headerInner",children:[Object(s.jsxs)("div",{className:"c-col-0 c-cols",onClick:function(){return e.clickHeader("proposal.id")},children:[Object(s.jsx)("label",{className:"font-size-14",children:"#"}),this.renderTriangle("proposal.id")]}),Object(s.jsxs)("div",{className:"c-col-1 c-cols",onClick:function(){return e.clickHeader("proposal.title")},children:[Object(s.jsx)("label",{className:"font-size-14",children:"Title"}),this.renderTriangle("proposal.title")]}),Object(s.jsxs)("div",{className:"c-col-2 c-cols",onClick:function(){return e.clickHeader("vote.content_type")},children:[Object(s.jsx)("label",{className:"font-size-14",children:"Ballot Type"}),this.renderTriangle("vote.content_type")]}),Object(s.jsxs)("div",{className:"c-col-3 c-cols",onClick:function(){return e.clickHeader("vote.updated_at")},children:[Object(s.jsx)("label",{className:"font-size-14",children:"Completed Date"}),this.renderTriangle("vote.updated_at")]}),Object(s.jsx)("div",{className:"c-col-4 c-cols",children:Object(s.jsx)("label",{className:"font-size-14",children:"Action"})})]})})}},{key:"renderVotes",value:function(){var e=this,t=this.state.votes,c=[];return t&&t.length?(t.forEach((function(t,n){c.push(Object(s.jsx)("li",{children:Object(s.jsxs)("div",{className:"infinite-row",children:[Object(s.jsx)("div",{className:"c-col-0 c-cols",onClick:function(){return e.clickRow(t)},children:Object(s.jsx)("label",{className:"font-size-14 d-block",children:t.proposalId})}),Object(s.jsx)("div",{className:"c-col-1 c-cols",onClick:function(){return e.clickRow(t)},children:Object(s.jsx)("label",{className:"font-size-14 d-block",children:t.title})}),Object(s.jsx)("div",{className:"c-col-2 c-cols",onClick:function(){return e.clickRow(t)},children:Object(s.jsx)("label",{className:"font-size-14 d-block",children:"grant"==t.content_type?"Grant":"simple"==t.content_type?"Simple":"Milestone"})}),Object(s.jsx)("div",{className:"c-col-3 c-cols",onClick:function(){return e.clickRow(t)},children:Object(s.jsxs)("label",{className:"font-size-14 d-block",children:[g(t.updated_at).local().format("M/D/YYYY")," ",g(t.updated_at).local().format("h:mm A")]})}),Object(s.jsx)("div",{className:"c-col-4 c-cols",children:Object(s.jsx)("a",{className:"btn btn-primary extra-small btn-fluid-small",onClick:function(){return e.clickStartFormal(t)},children:"Start Formal Voting"})})]})},"vote_".concat(n)))})),Object(s.jsx)("ul",{children:c})):Object(s.jsx)("div",{id:"infinite-no-result",children:Object(s.jsx)("label",{className:"font-size-14",children:"No Results Found"})})}},{key:"render",value:function(){var e=this.state,t=e.loading,c=e.search;return Object(s.jsx)(p.Fade,{distance:"20px",bottom:!0,duration:200,delay:700,children:Object(s.jsxs)("section",{id:"app-move-to-formal-section",className:"app-infinite-box",children:[Object(s.jsxs)("div",{className:"app-infinite-search-wrap",children:[Object(s.jsx)("label",{children:"Simple and Milestone Submissions That Passed Informal Vote"}),Object(s.jsx)("input",{type:"text",value:c,onChange:this.handleSearch,placeholder:"Search..."})]}),Object(s.jsx)("div",{className:"infinite-content",children:Object(s.jsxs)("div",{className:"infinite-contentInner",children:[this.renderHeader(),Object(s.jsx)("div",{className:"infinite-body",id:"app-move-to-formal-sectionBody",children:t?Object(s.jsx)(v.f,{}):this.renderVotes()})]})})]})})}}]),c}(o.Component),k=Object(d.b)((function(e){return{authUser:e.global.authUser,settings:e.global.settings,moveToFormalTableStatus:e.table.moveToFormalTableStatus}}))(Object(u.g)(x)),y=c("o0o1"),N=c.n(y),_=c("HaE+"),S=c("55Ip");c("RnE9");function T(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var c,s=Object(l.a)(e);if(t){var n=Object(l.a)(this).constructor;c=Reflect.construct(s,arguments,n)}else c=s.apply(this,arguments);return Object(r.a)(this,c)}}var z=c("wd/R"),w=function(e){Object(a.a)(c,e);var t=T(c);function c(e){var s;return Object(n.a)(this,c),s=t.call(this,e),Object(j.a)(Object(b.a)(s),"trackScroll",(function(){s.$elem&&s.$elem.scrollTop+s.$elem.clientHeight>=s.$elem.scrollHeight&&s.runNextPage()})),Object(j.a)(Object(b.a)(s),"handleSearch",(function(e){s.setState({search:e.target.value},(function(){s.timer&&(clearTimeout(s.timer),s.timer=null),s.timer=setTimeout((function(){s.reloadTable()}),500)}))})),s.state={onboardings:[],loading:!1,sort_key:"onboarding.id",sort_direction:"desc",search:"",page_id:1,calling:!1,finished:!1},s.$elem=null,s.timer=null,s}return Object(i.a)(c,[{key:"componentDidMount",value:function(){this.startTracking(),this.getOnboardings()}},{key:"componentDidUpdate",value:function(e){var t=this.props.onboardingTableStatus;!e.onboardingTableStatus&&t&&(this.reloadTable(),this.props.dispatch(Object(f.mb)(!1)))}},{key:"componentWillUnmount",value:function(){this.$elem&&this.$elem.removeEventListener("scroll",this.trackScroll)}},{key:"startTracking",value:function(){this.$elem=document.getElementById("app-pending-grants-sectionBody"),this.$elem.addEventListener("scroll",this.trackScroll)}},{key:"reloadTable",value:function(){var e=this;this.setState({page_id:1,onboardings:[],finished:!1},(function(){e.getOnboardings()}))}},{key:"runNextPage",value:function(){var e=this,t=this.state,c=t.calling,s=t.loading,n=t.finished,i=t.page_id;c||s||n||this.setState({page_id:i+1},(function(){e.getOnboardings(!1)}))}},{key:"getOnboardings",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],c=this.state,s=c.calling,n=c.loading,i=c.finished,a=c.sort_key,r=c.sort_direction,l=c.search,o=c.page_id,d=c.onboardings;if(!(n||s||i)){var u={sort_key:a,sort_direction:r,search:l,page_id:o};this.props.dispatch(Object(m.tb)(u,(function(){t?e.setState({loading:!0,calling:!0}):e.setState({loading:!1,calling:!0})}),(function(t){var c=t.onboardings||[],s=t.finished||!1;e.setState({loading:!1,calling:!1,finished:s,onboardings:[].concat(Object(h.a)(d),Object(h.a)(c))})})))}}},{key:"renderTriangle",value:function(e){var t=this.state,c=t.sort_key,n=t.sort_direction;return c!=e?Object(s.jsx)("span",{className:"inactive",children:"\u25b2"}):"asc"==n?Object(s.jsx)("span",{children:"\u25b2"}):Object(s.jsx)("span",{children:"\u25bc"})}},{key:"clickHeader",value:function(e){var t=this,c=this.state,s=c.sort_key,n=c.sort_direction;s==e?n="asc"==n?"desc":"asc":(s=e,n="desc"),this.setState({sort_key:s,sort_direction:n},(function(){t.reloadTable()}))}},{key:"clickKYC",value:function(){var e=Object(_.a)(N.a.mark((function e(t){var c;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((c=t.user)&&c.id){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,this.props.dispatch(Object(f.ib)(c));case 5:return e.next=7,this.props.dispatch(Object(f.T)("review-kyc"));case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"clickSigned",value:function(e){if(!e.proposal||!e.proposal.signatures||!e.proposal.signatures.length)return null;this.props.dispatch(Object(f.ab)({signatures:{render:!0,title:"Grant Agreement Signatures",data:e.proposal.signatures}})),this.props.dispatch(Object(f.T)("custom-global-modal"))}},{key:"clickForceWithdraw",value:function(e){var t=this;confirm("Are you sure you are going to withdraw the formal voting?")&&this.props.dispatch(Object(m.R)(e.proposal_id,(function(){t.props.dispatch(Object(f.wb)())}),(function(e){t.props.dispatch(Object(f.P)()),e&&e.success&&t.reloadTable()})))}},{key:"clickStartFormal",value:function(e){var t=this,c=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];confirm("Are you sure you are going to start the formal voting?")&&this.props.dispatch(Object(m.lc)(e.proposal_id,c,(function(){t.props.dispatch(Object(f.wb)())}),(function(e){t.props.dispatch(Object(f.P)()),e.success&&(t.props.dispatch(Object(f.vb)("Formal voting process has been started successfully","success")),t.reloadTable())})))}},{key:"renderHeader",value:function(){var e=this;return Object(s.jsx)("div",{className:"infinite-header",children:Object(s.jsxs)("div",{className:"infinite-headerInner",children:[Object(s.jsxs)("div",{className:"c-col-1 c-cols",onClick:function(){return e.clickHeader("onboarding.updated_at")},children:[Object(s.jsx)("label",{className:"font-size-14",children:"Proposal #"}),this.renderTriangle("onboarding.updated_at")]}),Object(s.jsxs)("div",{className:"c-col-2 c-cols",onClick:function(){return e.clickHeader("onboarding.updated_at")},children:[Object(s.jsx)("label",{className:"font-size-14",children:"OP Email"}),this.renderTriangle("onboarding.updated_at")]}),Object(s.jsxs)("div",{className:"c-col-3 c-cols",onClick:function(){return e.clickHeader("onboarding.updated_at")},children:[Object(s.jsx)("label",{className:"font-size-14",children:"Pass Date"}),this.renderTriangle("onboarding.updated_at")]}),Object(s.jsxs)("div",{className:"c-col-4 c-cols",onClick:function(){return e.clickHeader("onboarding.status")},children:[Object(s.jsx)("label",{className:"font-size-14",children:"Status"}),this.renderTriangle("onboarding.status")]}),Object(s.jsxs)("div",{className:"c-col-5 c-cols",onClick:function(){return e.clickHeader("proposal.title")},children:[Object(s.jsx)("label",{className:"font-size-14",children:"Title"}),this.renderTriangle("proposal.title")]}),Object(s.jsx)("div",{className:"c-col-6 c-cols",children:Object(s.jsx)("label",{className:"font-size-14",children:"First Name"})}),Object(s.jsx)("div",{className:"c-col-7 c-cols",children:Object(s.jsx)("label",{className:"font-size-14",children:"Last Name"})}),Object(s.jsx)("div",{className:"c-col-8 c-cols",children:Object(s.jsx)("label",{className:"font-size-14",children:"KYC/AML"})}),Object(s.jsx)("div",{className:"c-col-9 c-cols",children:Object(s.jsx)("label",{className:"font-size-14",children:"Action"})})]})})}},{key:"renderKYCStatus",value:function(e){var t=this;if(!e.shuftipro_status){var c=e.user.shuftipro_temp;return c&&"booked"==c.status?Object(s.jsx)("label",{className:"font-size-14 color-primary",children:"Processing"}):Object(s.jsx)("label",{className:"font-size-14",children:"-"})}return"approved"==e.shuftipro_status?Object(s.jsx)("label",{className:"font-size-14 color-success",onClick:function(){return t.clickKYC(e)},children:"Pass (View)"}):e.shuftipro_reviewed?Object(s.jsx)("label",{className:"font-size-14 color-danger",onClick:function(){return t.clickKYC(e)},children:"Fail (View)"}):Object(s.jsx)("label",{className:"font-size-14 color-danger",onClick:function(){return t.clickKYC(e)},children:"Fail (Review)"})}},{key:"renderPaymentForm",value:function(e){return e.form_submitted?Object(s.jsx)("label",{className:"font-size-14",children:"Yes"}):Object(s.jsx)("label",{className:"font-size-14",children:"No"})}},{key:"renderAction",value:function(e){var t=this,c=null;return e.shuftipro_status&&"approved"==e.shuftipro_status&&e.form_submitted&&e.signature_request_id&&e.hellosign_form&&"pending"==e.status?c=Object(s.jsx)("a",{onClick:function(){return t.clickStartFormal(e,!1)},className:"btn btn-success extra-small",children:"Start Formal Voting"}):"pending"==e.status&&(c=Object(s.jsx)("a",{onClick:function(){return t.clickStartFormal(e,!0)},className:"font-size-14 dynamic-color",children:Object(s.jsx)("u",{children:"Force Start Formal Voting"})})),c?Object(s.jsxs)(o.Fragment,{children:[Object(s.jsx)("div",{children:c}),Object(s.jsx)("div",{className:"mt-2",children:Object(s.jsx)("a",{className:"font-size-14 dynamic-color",onClick:function(){return t.clickForceWithdraw(e)},children:Object(s.jsx)("u",{children:"Force Withdraw"})})})]}):Object(s.jsx)("label",{className:"font-size-14",children:"-"})}},{key:"renderTitle",value:function(e){return e.proposal_title}},{key:"renderHellosign",value:function(e){var t=this;return Object(s.jsx)("a",{className:"font-size-14 dynamic-color",onClick:function(){return t.clickSigned(e)},children:Object(s.jsxs)("u",{children:["Signed (",e.signed_count,"/3)"]})})}},{key:"renderOnboardings",value:function(){var e=this,t=this.state.onboardings,c=[];return t&&t.length?(t.forEach((function(t,n){c.push(Object(s.jsx)("li",{children:Object(s.jsxs)("div",{className:"infinite-row",children:[Object(s.jsx)("div",{className:"c-col-1 c-cols",children:Object(s.jsx)("label",{className:"font-size-14",children:t.proposal_id})}),Object(s.jsx)("div",{className:"c-col-2 c-cols",children:Object(s.jsx)("label",{className:"font-size-14 text-elipse",children:Object(s.jsx)(S.b,{to:"/app/user/".concat(t.user.id),style:{color:"inherit"},children:t.user.email})})}),Object(s.jsx)("div",{className:"c-col-3 c-cols",children:Object(s.jsxs)("label",{className:"font-size-14",children:[z(t.updated_at).local().format("M/D/YYYY")," ",z(t.updated_at).local().format("h:mm A")]})}),Object(s.jsx)("div",{className:"c-col-4 c-cols",children:Object(s.jsx)("label",{className:"font-size-14 color-primary",children:"Pending"})}),Object(s.jsx)("div",{className:"c-col-5 c-cols",children:Object(s.jsx)("label",{className:"font-size-14 font-weight-700",children:Object(s.jsx)(S.b,{to:"/app/proposal/".concat(t.id),style:{color:"inherit"},children:e.renderTitle(t)})})}),Object(s.jsx)("div",{className:"c-col-6 c-cols",children:t.user.first_name}),Object(s.jsx)("div",{className:"c-col-7 c-cols",children:t.user.last_name}),Object(s.jsx)("div",{className:"c-col-8 c-cols",children:e.renderKYCStatus(t)}),Object(s.jsx)("div",{className:"c-col-9 c-cols",children:e.renderAction(t)})]})},"onboarding_".concat(n)))})),Object(s.jsx)("ul",{children:c})):Object(s.jsx)("div",{id:"infinite-no-result",children:Object(s.jsx)("label",{className:"font-size-14",children:"No Results Found"})})}},{key:"render",value:function(){var e=this.state,t=e.loading,c=e.search,n=this.props.authUser;return n&&n.id?Object(s.jsxs)("div",{id:"app-pending-grants-section",className:"app-infinite-box",children:[Object(s.jsxs)("div",{className:"app-infinite-search-wrap",children:[Object(s.jsx)("label",{children:"Grant Proposals That Passed Informal Vote"}),Object(s.jsx)("input",{type:"text",value:c,onChange:this.handleSearch,placeholder:"Search..."})]}),Object(s.jsx)("div",{className:"infinite-content",children:Object(s.jsxs)("div",{className:"infinite-contentInner",children:[this.renderHeader(),Object(s.jsx)("div",{className:"infinite-body",id:"app-pending-grants-sectionBody",children:t?Object(s.jsx)(v.f,{}):this.renderOnboardings()})]})})]}):null}}]),c}(o.Component),C=Object(d.b)((function(e){return{authUser:e.global.authUser,onboardingTableStatus:e.table.onboardingTableStatus}}))(w);c("B5RZ");function R(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var c,s=Object(l.a)(e);if(t){var n=Object(l.a)(this).constructor;c=Reflect.construct(s,arguments,n)}else c=s.apply(this,arguments);return Object(r.a)(this,c)}}var F=function(e){Object(a.a)(c,e);var t=R(c);function c(){return Object(n.a)(this,c),t.apply(this,arguments)}return Object(i.a)(c,[{key:"render",value:function(){var e=this.props.authUser;return e&&e.id&&e.is_admin?Object(s.jsxs)("div",{id:"app-onboardings-page",children:[Object(s.jsx)(k,{}),Object(s.jsx)(C,{})]}):null}}]),c}(o.Component);t.default=Object(d.b)((function(e){return{authUser:e.global.authUser}}))(Object(u.g)(F))}}]);