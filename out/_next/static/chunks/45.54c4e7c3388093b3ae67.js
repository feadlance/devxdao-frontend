(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[45],{Kbri:function(e,t,s){"use strict";s.r(t);var n=s("nKUr"),a=s("1OyB"),c=s("vuIU"),r=s("JX7q"),i=s("Ji7U"),l=s("md7G"),o=s("foSv"),d=s("rePB"),u=s("q1tI"),p=s.n(u),h=s("/MKj"),b=s("55Ip"),j=s("Ty5D"),f=s("Rzx/"),m=s("s/m+"),O=s("LADp");s("1x2T");function v(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var s,n=Object(o.a)(e);if(t){var a=Object(o.a)(this).constructor;s=Reflect.construct(n,arguments,a)}else s=n.apply(this,arguments);return Object(l.a)(this,s)}}var g=function(e){Object(i.a)(s,e);var t=v(s);function s(e){var n;return Object(a.a)(this,s),(n=t.call(this,e)).state={loading:!1,proposals:[]},n}return Object(c.a)(s,[{key:"componentDidMount",value:function(){this.getPaymentProposals()}},{key:"componentDidUpdate",value:function(e){var t=this.props.activeProposalTableStatus;!e.activeProposalTableStatus&&t&&this.getPaymentProposals()}},{key:"getPaymentProposals",value:function(){var e=this;this.props.dispatch(Object(O.Fb)((function(){e.setState({loading:!0})}),(function(t){var s=t.proposals||[];e.setState({proposals:s,loading:!1})})))}},{key:"render",value:function(){var e=this.props.authUser,t=this.state,s=t.loading,a=t.proposals;return e&&e.id?s||!a.length?null:Object(n.jsx)(m.Fade,{distance:"20px",right:!0,duration:200,delay:500,children:Object(n.jsx)("div",{id:"app-dos-alert-box",children:Object(n.jsxs)("div",{children:[Object(n.jsx)("label",{className:"font-weight-700",children:"You have a proposal approved to move ahead!"}),Object(n.jsx)("p",{className:"font-size-12",children:"To launch this proposal to the community for discussion and voting, you must first pay a DOS Fee in either ETH, BTC, or stake reputation."})]})})}):null}}]),s}(u.Component),x=Object(h.b)((function(e){return{authUser:e.global.authUser,activeProposalTableStatus:e.admin.activeProposalTableStatus}}))(Object(j.g)(g));s("/TR+");function y(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var s,n=Object(o.a)(e);if(t){var a=Object(o.a)(this).constructor;s=Reflect.construct(n,arguments,a)}else s=n.apply(this,arguments);return Object(l.a)(this,s)}}var k=function(e){Object(i.a)(s,e);var t=y(s);function s(e){var n;return Object(a.a)(this,s),(n=t.call(this,e)).state={loading:!1,proposals:[]},n}return Object(c.a)(s,[{key:"componentDidMount",value:function(){this.getPaymentProposals()}},{key:"componentDidUpdate",value:function(e){var t=this.props.activeProposalTableStatus;!e.activeProposalTableStatus&&t&&this.getPaymentProposals()}},{key:"getPaymentProposals",value:function(){var e=this;this.props.dispatch(Object(O.Fb)((function(){e.setState({loading:!0})}),(function(t){var s=t.proposals||[];e.setState({proposals:s,loading:!1})})))}},{key:"render",value:function(){return Object(n.jsx)(m.Fade,{distance:"20px",right:!0,duration:200,delay:500,children:Object(n.jsxs)("div",{id:"app-grant-alert-box",children:[Object(n.jsx)("img",{src:"/parts.png",alt:""}),Object(n.jsxs)("div",{children:[Object(n.jsx)("label",{className:"font-weight-700",children:"Way to go! You have a grant active. Need to submit a milestone for review and payment?"}),Object(n.jsx)("p",{className:"font-size-12",children:'Go to your "My Grants" section in the left sidebar menu to submit milestones once work is complete.'})]}),Object(n.jsx)("div",{className:"d-flex flex-column actions",children:Object(n.jsx)(b.b,{to:"/app/grants",className:"btn btn-primary mb-1",children:"My Grants"})})]})})}}]),s}(u.Component),N=Object(h.b)((function(e){return{authUser:e.global.authUser,activeProposalTableStatus:e.admin.activeProposalTableStatus}}))(Object(j.g)(k)),S=s("KQm4"),_=s("o0o1"),T=s.n(_),P=s("HaE+"),C=s("e+cM"),w=s("csfp"),z=s("ZpDd"),D=(s("u+ul"),s("17x9")),R=s.n(D);function U(){return(U=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n])}return e}).apply(this,arguments)}function F(e,t){if(null==e)return{};var s,n,a=function(e,t){if(null==e)return{};var s,n,a={},c=Object.keys(e);for(n=0;n<c.length;n++)s=c[n],t.indexOf(s)>=0||(a[s]=e[s]);return a}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(n=0;n<c.length;n++)s=c[n],t.indexOf(s)>=0||Object.prototype.propertyIsEnumerable.call(e,s)&&(a[s]=e[s])}return a}var L=Object(u.forwardRef)((function(e,t){var s=e.color,n=void 0===s?"currentColor":s,a=e.size,c=void 0===a?24:a,r=F(e,["color","size"]);return p.a.createElement("svg",U({ref:t,xmlns:"http://www.w3.org/2000/svg",width:c,height:c,viewBox:"0 0 24 24",fill:"none",stroke:n,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},r),p.a.createElement("circle",{cx:"12",cy:"12",r:"10"}),p.a.createElement("path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"}),p.a.createElement("line",{x1:"12",y1:"17",x2:"12.01",y2:"17"}))}));L.propTypes={color:R.a.string,size:R.a.oneOfType([R.a.string,R.a.number])},L.displayName="HelpCircle";var H=L;function $(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var s,n=Object(o.a)(e);if(t){var a=Object(o.a)(this).constructor;s=Reflect.construct(n,arguments,a)}else s=n.apply(this,arguments);return Object(l.a)(this,s)}}var Y=s("wd/R"),E=function(e){Object(i.a)(s,e);var t=$(s);function s(e){var c;return Object(a.a)(this,s),c=t.call(this,e),Object(d.a)(Object(r.a)(c),"trackScroll",(function(){c.$elem.scrollTop+c.$elem.clientHeight>=c.$elem.scrollHeight&&c.runNextPage()})),Object(d.a)(Object(r.a)(c),"handleSearch",(function(e){c.setState({search:e.target.value},(function(){c.timer&&(clearTimeout(c.timer),c.timer=null),c.timer=setTimeout((function(){c.reloadTable()}),500)}))})),Object(d.a)(Object(r.a)(c),"clickPaymentForm",function(){var e=Object(P.a)(T.a.mark((function e(t,s){return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),s.proposal&&s.proposal.id&&!s.proposal.form_submitted){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,c.props.dispatch(Object(z.tb)(s.proposal));case 5:return e.next=7,c.props.dispatch(Object(z.Z)("payment-form"));case 7:case"end":return e.stop()}}),e)})));return function(t,s){return e.apply(this,arguments)}}()),Object(d.a)(Object(r.a)(c),"clickBeginKYC",(function(e){e.preventDefault(),c.props.dispatch(Object(z.Z)("verify-kyc"))})),Object(d.a)(Object(r.a)(c),"renderComplianceCheck",(function(e){return Object(n.jsx)("p",{className:"font-size-14 text-capitalize",children:e.compliance_status})})),Object(d.a)(Object(r.a)(c),"resend",(function(){c.props.dispatch(Object(z.Z)("resend-kyc"))})),c.state={loading:!1,onboardings:[],sort_key:"onboarding.id",sort_direction:"desc",search:"",page_id:1,calling:!1,callCount:0,finished:!1},c.$elem=null,c.timer=null,c}return Object(c.a)(s,[{key:"componentDidMount",value:function(){var e=this.state.onboardings;this.getOnboardings(),e&&e.length&&this.startTracking()}},{key:"componentDidUpdate",value:function(e,t){var s=this.props.onboardingTableStatus,n=this.state.onboardings;t.onboardings&&t.onboardings.length||!n||!n.length||this.startTracking(),!e.onboardingTableStatus&&s&&(this.reloadTable(),this.props.dispatch(Object(z.sb)(!1)))}},{key:"componentWillUnmount",value:function(){this.$elem&&this.$elem.removeEventListener("scroll",this.trackScroll)}},{key:"startTracking",value:function(){this.$elem=document.getElementById("app-proposal-tracking-sectionBody"),this.$elem&&this.$elem.addEventListener("scroll",this.trackScroll)}},{key:"reloadTable",value:function(){var e=this;this.setState({page_id:1,onboardings:[],finished:!1},(function(){e.getOnboardings()}))}},{key:"runNextPage",value:function(){var e=this,t=this.state,s=t.calling,n=t.loading,a=t.finished,c=t.page_id;s||n||a||this.setState({page_id:c+1},(function(){e.getOnboardings(!1)}))}},{key:"getOnboardings",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],s=this.state,n=s.calling,a=s.loading,c=s.finished,r=s.sort_key,i=s.sort_direction,l=s.search,o=s.page_id,d=s.onboardings,u=s.callCount;if(!(a||n||c)){var p={sort_key:r,sort_direction:i,search:l,page_id:o};this.props.dispatch(Object(O.Gb)(p,(function(){t?e.setState({loading:!0,calling:!0}):e.setState({loading:!1,calling:!0})}),(function(t){var s=t.onboardings||[],n=t.finished||!1;e.setState({loading:!1,calling:!1,finished:n,onboardings:[].concat(Object(S.a)(d),Object(S.a)(s)),callCount:u+1})})))}}},{key:"renderTitle",value:function(e){return e.proposal?e.proposal.title:""}},{key:"needToDoKYC",value:function(){var e=this.props.authUser,t=!1;return(e.shuftipro&&e.shuftipro.id||e.shuftipro_temp&&e.shuftipro_temp.id)&&(e.shuftipro&&e.shuftipro.id||!e.shuftipro_temp||"pending"!=e.shuftipro_temp.status)||(t=!0),t}},{key:"hasPending",value:function(){var e=this.state.onboardings;if(e&&e.length)for(var t in e){if("pending"==e[t].status)return!0}return!1}},{key:"renderAlert",value:function(){var e=this.state.onboardings,t=this.props.authUser;return t&&t.id&&e&&e.length&&this.hasPending()&&this.needToDoKYC()?Object(n.jsxs)("div",{id:"app-kyc-box",children:[Object(n.jsx)("img",{src:"/parts.png",alt:""}),Object(n.jsxs)("div",{children:[Object(n.jsx)("label",{className:"font-weight-700",children:"Congratulations! Your proposal has passed the informal voting stage."}),Object(n.jsx)("p",{className:"font-size-12",children:"You must now submit your KYC/AML and financial information to continue."})]})]}):null}},{key:"renderDate",value:function(e){return Object(n.jsxs)("label",{className:"font-size-14",children:[Y(e.updated_at).local().format("M/D/YYYY")," ",Y(e.updated_at).local().format("h:mm A")]})}},{key:"renderFormColumn",value:function(e){var t=this,s=!1;return e&&e.proposal&&(s=!!e.proposal.form_submitted),s?Object(n.jsx)("label",{className:"font-size-14 color-success",children:"Submitted"}):Object(n.jsx)("a",{className:"btn btn-primary extra-small",onClick:function(s){return t.clickPaymentForm(s,e)},children:"Start"})}},{key:"renderKYCColumn",value:function(){var e=this.props.authUser;if(!e||!e.id)return null;if(this.needToDoKYC())return Object(n.jsx)("a",{className:"btn btn-primary extra-small",onClick:this.clickBeginKYC,children:"Start"});var t=e.shuftipro;if(t&&t.id){if("approved"==t.status)return Object(n.jsx)("label",{className:"font-size-14 color-success",children:"Pass"});if(t.reviewed)return Object(n.jsx)("label",{className:"font-size-14 color-danger",children:"Fail"})}return Object(n.jsx)("label",{className:"font-size-14 color-primary",children:"Submitted"})}},{key:"renderHellosign",value:function(e){var t=e.proposal||{};return t&&t.id?t.signature_request_id&&t.hellosign_form?Object(n.jsx)("label",{className:"font-size-14",children:"Signed"}):Object(n.jsx)("label",{className:"font-size-14",children:"Sent"}):null}},{key:"renderStatusLabel",value:function(e,t){return Object(n.jsx)("label",{className:"font-size-14 color-".concat(t),children:e})}},{key:"renderStatus",value:function(e){var t=e.dos_paid;if("payment"==e.status)return t?this.renderStatusLabel("Payment Clearing","info"):this.renderStatusLabel("Payment Waiting","info");if("pending"==e.status)return Object(n.jsxs)("div",{children:[Object(n.jsx)("p",{children:this.renderStatusLabel("Pending","primary")}),Object(n.jsx)("a",{className:"text-underline font-size-14 color-primary",onClick:this.resend,children:"resend my link"})]});if("denied"==e.status)return this.renderStatusLabel("Denied","danger");if("completed"==e.status)return this.renderStatusLabel("Completed","");if("approved"==e.status){if(e.votes&&e.votes.length){if(e.votes.length>1){var s=e.votes[1];return"active"==s.status?this.renderStatusLabel(Object(n.jsxs)(u.Fragment,{children:["Formal Voting",Object(n.jsx)("br",{}),"Live"]}),"success"):"success"==s.result?this.renderStatusLabel(Object(n.jsxs)(u.Fragment,{children:["Formal Voting",Object(n.jsx)("br",{}),"Passed"]}),"success"):"no-quorum"==s.result?this.renderStatusLabel(Object(n.jsxs)(u.Fragment,{children:["Formal Voting",Object(n.jsx)("br",{}),"No Quorum"]}),"danger"):this.renderStatusLabel(Object(n.jsxs)(u.Fragment,{children:["Formal Voting",Object(n.jsx)("br",{}),"Failed"]}),"danger")}var a=e.votes[0];return"active"==a.status?this.renderStatusLabel(Object(n.jsxs)(u.Fragment,{children:["Informal Voting",Object(n.jsx)("br",{}),"Live"]}),"success"):"success"==a.result?this.renderStatusLabel(Object(n.jsxs)(u.Fragment,{children:["Informal Voting",Object(n.jsx)("br",{}),"Passed"]}),"success"):"no-quorum"==a.result?this.renderStatusLabel(Object(n.jsxs)(u.Fragment,{children:["Informal Voting",Object(n.jsx)("br",{}),"No Quorum"]}),"danger"):this.renderStatusLabel(Object(n.jsxs)(u.Fragment,{children:["Informal Voting",Object(n.jsx)("br",{}),"Failed"]}),"danger")}return this.renderStatusLabel("In Discussion","success")}return null}},{key:"renderOnboardings",value:function(){var e=this,t=this.state.onboardings,s=[];return t&&t.length?(t.forEach((function(t,a){s.push(Object(n.jsx)("li",{children:Object(n.jsxs)("div",{className:"infinite-row",children:[Object(n.jsx)("div",{className:"c-col-0 c-cols",children:t.proposal.id}),Object(n.jsx)("div",{className:"c-col-1 c-cols",children:e.renderDate(t)}),Object(n.jsx)("div",{className:"c-col-2 c-cols",children:Object(n.jsx)("label",{className:"font-size-14 font-weight-700",children:e.renderTitle(t)})}),Object(n.jsx)("div",{className:"c-col-3 c-cols",children:Object(n.jsx)("label",{className:"font-size-14",children:"grant"==t.proposal.type?"Grant":"Simple"})}),Object(n.jsx)("div",{className:"c-col-4 c-cols",children:e.renderStatus(t)}),Object(n.jsx)("div",{className:"c-col-5 c-cols",children:e.renderComplianceCheck(t)})]})},"onboarding_".concat(a)))})),Object(n.jsx)("ul",{children:s})):Object(n.jsx)("div",{id:"infinite-no-result",children:Object(n.jsx)("label",{className:"font-size-14",children:"No Results Found"})})}},{key:"renderTriangle",value:function(e){var t=this.state,s=t.sort_key,a=t.sort_direction;return s!=e?Object(n.jsx)("span",{className:"inactive",children:"\u25b2"}):"asc"==a?Object(n.jsx)("span",{children:"\u25b2"}):Object(n.jsx)("span",{children:"\u25bc"})}},{key:"clickHeader",value:function(e){var t=this,s=this.state,n=s.sort_key,a=s.sort_direction;n==e?a="asc"==a?"desc":"asc":(n=e,a="desc"),this.setState({sort_key:n,sort_direction:a},(function(){t.reloadTable()}))}},{key:"renderHeader",value:function(){var e=this;return Object(n.jsx)("div",{className:"infinite-header",children:Object(n.jsxs)("div",{className:"infinite-headerInner",children:[Object(n.jsx)("div",{className:"c-col-0 c-cols",children:"Proposal #"}),Object(n.jsx)("div",{className:"c-col-1 c-cols",children:Object(n.jsx)("label",{className:"font-size-14",children:"Date Passed"})}),Object(n.jsxs)("div",{className:"c-col-2 c-cols",onClick:function(){return e.clickHeader("proposal.title")},children:[Object(n.jsx)("label",{className:"font-size-14",children:"Title"}),this.renderTriangle("proposal.title")]}),Object(n.jsx)("div",{className:"c-col-3 c-cols",children:Object(n.jsx)("label",{className:"font-size-14",children:"Type"})}),Object(n.jsx)("div",{className:"c-col-4 c-cols",children:Object(n.jsx)("label",{className:"font-size-14",children:"KYC"})}),Object(n.jsx)("div",{className:"c-col-5 c-cols",children:Object(n.jsxs)("label",{children:[Object(n.jsx)("span",{className:"mx-0 font-size-14 pr-2",children:"Compliance checks"}),Object(n.jsx)(w.a,{title:"All grants in the portal must be reviewed for compliance. This process typically takes anywhere from one to seven days.",placement:"right-end",children:Object(n.jsx)(H,{size:"12"})})]})})]})})}},{key:"render",value:function(){var e=this.state,t=e.loading,s=e.onboardings,a=e.search,c=e.callCount,r=this.props.authUser;return r&&r.id&&(s&&s.length||!(c<2))?Object(n.jsx)(m.Fade,{distance:"20px",bottom:!0,duration:200,delay:500,children:Object(n.jsxs)(u.Fragment,{children:[this.renderAlert(),Object(n.jsxs)("section",{id:"app-proposal-tracking-section",className:"app-infinite-box",children:[Object(n.jsxs)("div",{className:"app-infinite-search-wrap",children:[Object(n.jsx)("label",{children:"Proposal Tracking"}),Object(n.jsx)("input",{type:"text",value:a,onChange:this.handleSearch,placeholder:"Search..."})]}),Object(n.jsx)("div",{className:"infinite-content",children:Object(n.jsxs)("div",{className:"infinite-contentInner",children:[this.renderHeader(),Object(n.jsx)("div",{className:"infinite-body",id:"app-proposal-tracking-sectionBody",children:t?Object(n.jsx)(C.k,{}):this.renderOnboardings()})]})})]})]})}):null}}]),s}(u.Component),I=Object(h.b)((function(e){return{authUser:e.global.authUser,onboardingTableStatus:e.table.onboardingTableStatus}}))(Object(j.g)(E)),B=s("ahwF"),M=s("syaQ"),G=s("I6fM"),W=s("YW6W");s("dT1j");function K(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var s,n=Object(o.a)(e);if(t){var a=Object(o.a)(this).constructor;s=Reflect.construct(n,arguments,a)}else s=n.apply(this,arguments);return Object(l.a)(this,s)}}var A=s("wd/R"),V=function(e){Object(i.a)(s,e);var t=K(s);function s(e){var n;return Object(a.a)(this,s),n=t.call(this,e),Object(d.a)(Object(r.a)(n),"trackScroll",(function(){n.$elem&&n.$elem.scrollTop+n.$elem.clientHeight>=n.$elem.scrollHeight&&n.runNextPage()})),Object(d.a)(Object(r.a)(n),"handleSearch",(function(e){n.setState({search:e.target.value},(function(){n.timer&&(clearTimeout(n.timer),n.timer=null),n.timer=setTimeout((function(){n.reloadTable()}),500)}))})),n.state={loading:!1,proposals:[],sort_key:"proposal.id",sort_direction:"desc",search:"",page_id:1,calling:!1,finished:!1},n.$elem=null,n.timer=null,n}return Object(c.a)(s,[{key:"componentDidMount",value:function(){var e=this.props.authUser;e&&e.id&&this.startTracking(),this.getProposals()}},{key:"componentWillUnmount",value:function(){this.$elem&&this.$elem.removeEventListener("scroll",this.trackScroll)}},{key:"componentDidUpdate",value:function(e){var t=this.props,s=t.activeProposalTableStatus,n=t.pendingProposalTableStatus,a=t.authUser,c=!1;!e.activeProposalTableStatus&&s&&(c=!0,this.props.dispatch(Object(z.ab)(!1))),!e.pendingProposalTableStatus&&n&&(c=!0),c&&this.reloadTable(),e.authUser&&e.authUser.id||!a||!a.id||this.startTracking()}},{key:"startTracking",value:function(){this.$elem=document.getElementById("app-active-proposals-sectionBody"),this.$elem&&this.$elem.addEventListener("scroll",this.trackScroll)}},{key:"reloadTable",value:function(){var e=this;this.setState({page_id:1,proposals:[],finished:!1},(function(){e.getProposals()}))}},{key:"runNextPage",value:function(){var e=this,t=this.state,s=t.calling,n=t.loading,a=t.finished,c=t.page_id;s||n||a||this.setState({page_id:c+1},(function(){e.getProposals(!1)}))}},{key:"getProposals",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],s=this.state,n=s.calling,a=s.loading,c=s.finished,r=s.sort_key,i=s.sort_direction,l=s.search,o=s.page_id,d=s.proposals;if(!(a||n||c)){var u={sort_key:r,sort_direction:i,search:l,page_id:o,limit:20};this.props.dispatch(Object(O.jb)(u,(function(){t?e.setState({loading:!0,calling:!0}):e.setState({loading:!1,calling:!0})}),(function(t){var s=t.proposals||[],n=t.finished||!1;e.setState({loading:!1,calling:!1,finished:n,proposals:[].concat(Object(S.a)(d),Object(S.a)(s))})})))}}},{key:"clickRow",value:function(e){this.props.history.push("/app/proposal/".concat(e.id))}},{key:"clickWithdraw",value:function(e,t){e.preventDefault(),this.props.dispatch(Object(z.gb)({"confirm-withdraw":{render:!0,title:"Are you sure you want to withdraw this proposal?",data:t}})),this.props.dispatch(Object(z.Z)("custom-global-modal"))}},{key:"clickPayDOS",value:function(e,t){e.preventDefault(),this.props.dispatch(Object(z.hb)(t)),this.props.dispatch(Object(z.Z)("dos-payment"))}},{key:"clickDenied",value:function(e,t){e.preventDefault(),this.props.dispatch(Object(z.jb)(t)),this.props.dispatch(Object(z.Z)("edit-deny"))}},{key:"renderTitle",value:function(e){var t=e.pendingCount,s=e.title;return parseInt(t)&&(s+=" (".concat(t," new requested changes)")),s}},{key:"renderStatusLabel",value:function(e,t){return Object(n.jsx)("label",{className:"font-size-14 color-".concat(t),children:e})}},{key:"renderStatus",value:function(e){var t=this,s=this.props.authUser,a=e.dos_paid;if("payment"==e.status)return s.is_admin?null:a?this.renderStatusLabel("Payment Clearing","info"):Object(n.jsxs)(u.Fragment,{children:[Object(n.jsx)("a",{className:"btn btn-success extra-small btn-fluid-small",style:{width:"100%",paddingLeft:"0.5rem",paddingRight:"0.5rem"},onClick:function(s){return t.clickPayDOS(s,e)},children:"Pay DOS Fee"}),Object(n.jsx)("a",{className:"btn btn-danger-outline extra-small btn-fluid-small",style:{width:"100%",paddingLeft:"0.5rem",paddingRight:"0.5rem",marginTop:"0.5rem"},onClick:function(s){return t.clickWithdraw(s,e)},children:"Withdraw"})]});if("pending"==e.status)return Object(n.jsxs)(u.Fragment,{children:[this.renderStatusLabel("Pending","primary"),Object(n.jsx)("div",{children:Object(n.jsx)("a",{className:"btn btn-danger-outline extra-small btn-fluid-small",style:{paddingLeft:"0.5rem",paddingRight:"0.5rem",marginTop:"0.5rem"},onClick:function(s){return t.clickWithdraw(s,e)},children:"Withdraw"})})]});if("denied"==e.status)return s.is_admin?null:Object(n.jsx)("label",{className:"font-size-14 color-danger",onClick:function(s){return t.clickDenied(s,e)},children:Object(n.jsx)("u",{children:"Denied"})});if("completed"==e.status)return this.renderStatusLabel("Completed","");if("approved"==e.status){if(e.votes&&e.votes.length){var c=e.votes[e.votes.length-1],r="formal"===c.type?"Formal Voting":"Informal Voting";return"active"===c.status?this.renderStatusLabel(Object(n.jsxs)(n.Fragment,{children:[r,Object(n.jsx)("br",{}),"Live"]}),"success"):"success"==c.result?this.renderStatusLabel(Object(n.jsxs)(n.Fragment,{children:[r,Object(n.jsx)("br",{}),"Passed"]}),"success"):"no-quorum"==c.result?this.renderStatusLabel(Object(n.jsxs)(n.Fragment,{children:[r,Object(n.jsx)("br",{}),"No Quorum"]}),"danger"):this.renderStatusLabel(Object(n.jsxs)(n.Fragment,{children:[r,Object(n.jsx)("br",{}),"Failed"]}),"danger")}return this.renderStatusLabel("In Discussion","success")}return null}},{key:"renderProposals",value:function(){var e=this,t=this.state.proposals,s=[];return t&&t.length?(t.forEach((function(t){s.push(Object(n.jsx)("li",{children:Object(n.jsxs)("div",{className:"infinite-row",children:[Object(n.jsx)("div",{className:"c-col-0 c-cols",onClick:function(){return e.clickRow(t)},children:Object(n.jsx)("label",{className:"font-size-14 d-block",children:t.id})}),Object(n.jsxs)("div",{className:"c-col-1 c-cols",onClick:function(){return e.clickRow(t)},children:[Object(n.jsx)("label",{className:"font-size-14 font-weight-700",children:e.renderTitle(t)}),Object(n.jsx)("p",{className:"font-size-12",children:W.a.getExcerpt(t.short_description||t.member_reason)})]}),Object(n.jsx)("div",{className:"c-col-2 c-cols",onClick:function(){return e.clickRow(t)},children:Object(n.jsx)("label",{className:"font-size-14",children:"grant"==t.type?"Grant":"Simple"})}),Object(n.jsx)("div",{className:"c-col-3 c-cols",children:e.renderStatus(t)}),Object(n.jsx)("div",{className:"c-col-4 c-cols",onClick:function(){return e.clickRow(t)},children:Object(n.jsxs)("div",{className:"c-image-wrap",children:[Object(n.jsx)("div",{children:Object(n.jsx)(B.a,{size:20})}),Object(n.jsx)("span",{className:"font-size-12",children:t.comments})]})}),Object(n.jsx)("div",{className:"c-col-5 c-cols",onClick:function(){return e.clickRow(t)},children:Object(n.jsxs)("div",{className:"c-image-wrap",children:[Object(n.jsx)("div",{children:Object(n.jsx)(M.a,{size:20})}),Object(n.jsx)("span",{className:"font-size-12",children:t.changes})]})}),Object(n.jsx)("div",{className:"c-col-6 c-cols",onClick:function(){return e.clickRow(t)},children:Object(n.jsxs)("label",{className:"font-size-14",children:[A(t.created_at).local().format("M/D/YYYY")," ",A(t.created_at).local().format("h:mm A")]})})]})},"proposal_".concat(t.id)))})),Object(n.jsx)("ul",{children:s})):Object(n.jsx)("div",{id:"infinite-no-result",children:Object(n.jsx)("label",{className:"font-size-14",children:"No Results Found"})})}},{key:"renderTriangle",value:function(e){var t=this.state,s=t.sort_key,a=t.sort_direction;return s!=e?Object(n.jsx)("span",{className:"inactive",children:"\u25b2"}):"asc"==a?Object(n.jsx)("span",{children:"\u25b2"}):Object(n.jsx)("span",{children:"\u25bc"})}},{key:"clickHeader",value:function(e){var t=this,s=this.state,n=s.sort_key,a=s.sort_direction;n==e?a="asc"==a?"desc":"asc":(n=e,a="desc"),this.setState({sort_key:n,sort_direction:a},(function(){t.reloadTable()}))}},{key:"renderHeader",value:function(){var e=this;return Object(n.jsx)("div",{className:"infinite-header",children:Object(n.jsxs)("div",{className:"infinite-headerInner",children:[Object(n.jsxs)("div",{className:"c-col-0 c-cols",onClick:function(){return e.clickHeader("proposal.id")},children:[Object(n.jsx)("label",{className:"font-size-14",children:"#"}),this.renderTriangle("proposal.id")]}),Object(n.jsxs)("div",{className:"c-col-1 c-cols",onClick:function(){return e.clickHeader("proposal.title")},children:[Object(n.jsx)("label",{className:"font-size-14",children:"Title"}),this.renderTriangle("proposal.title")]}),Object(n.jsxs)("div",{className:"c-col-2 c-cols",onClick:function(){return e.clickHeader("proposal.type")},children:[Object(n.jsx)("label",{className:"font-size-14",children:"Type"}),this.renderTriangle("proposal.type")]}),Object(n.jsx)("div",{className:"c-col-3 c-cols",children:Object(n.jsx)("label",{className:"font-size-14",children:"Status"})}),Object(n.jsxs)("div",{className:"c-col-4 c-cols",onClick:function(){return e.clickHeader("proposal.comments")},children:[Object(n.jsx)("label",{className:"font-size-14",children:"Comments"}),this.renderTriangle("proposal.comments")]}),Object(n.jsxs)("div",{className:"c-col-5 c-cols",onClick:function(){return e.clickHeader("proposal.changes")},children:[Object(n.jsx)("label",{className:"font-size-14",children:"Changes"}),this.renderTriangle("proposal.changes")]}),Object(n.jsxs)("div",{className:"c-col-6 c-cols",onClick:function(){return e.clickHeader("proposal.created_at")},children:[Object(n.jsx)("label",{className:"font-size-14",children:"Date"}),this.renderTriangle("proposal.created_at")]})]})})}},{key:"render",value:function(){var e=this.state,t=e.loading,s=e.search,a=this.props.authUser;return a&&a.id?Object(n.jsx)(m.Fade,{distance:"20px",bottom:!0,duration:300,delay:600,children:Object(n.jsxs)("section",{id:"app-active-proposals-section",className:"app-infinite-box",children:[Object(n.jsxs)("div",{className:"app-infinite-search-wrap",children:[a.is_admin?Object(n.jsx)("label",{children:"Active Proposals"}):Object(n.jsxs)("label",{children:["My Proposals\xa0\xa0",Object(n.jsx)(G.a,{size:16})]}),Object(n.jsx)("input",{type:"text",value:s,onChange:this.handleSearch,placeholder:"Search..."})]}),Object(n.jsx)("div",{className:"infinite-content",children:Object(n.jsxs)("div",{className:"infinite-contentInner",children:[this.renderHeader(),Object(n.jsx)("div",{className:"infinite-body",id:"app-active-proposals-sectionBody",children:t?Object(n.jsx)(C.k,{}):this.renderProposals()})]})})]})}):null}}]),s}(u.Component),Z=Object(h.b)((function(e){return{authUser:e.global.authUser,activeProposalTableStatus:e.admin.activeProposalTableStatus,pendingProposalTableStatus:e.admin.pendingProposalTableStatus}}))(Object(j.g)(V));s("QuSy");function q(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var s,n=Object(o.a)(e);if(t){var a=Object(o.a)(this).constructor;s=Reflect.construct(n,arguments,a)}else s=n.apply(this,arguments);return Object(l.a)(this,s)}}var Q=s("wd/R"),J=function(e){Object(i.a)(s,e);var t=q(s);function s(e){var n;return Object(a.a)(this,s),n=t.call(this,e),Object(d.a)(Object(r.a)(n),"trackScroll",(function(){n.$elem&&n.$elem.scrollTop+n.$elem.clientHeight>=n.$elem.scrollHeight&&n.runNextPage()})),Object(d.a)(Object(r.a)(n),"handleSearch",(function(e){n.setState({search:e.target.value},(function(){n.timer&&(clearTimeout(n.timer),n.timer=null),n.timer=setTimeout((function(){n.reloadTable()}),500)}))})),n.state={loading:!1,proposals:[],sort_key:"proposal.id",sort_direction:"desc",search:"",page_id:1,calling:!1,finished:!1},n.$elem=null,n.timer=null,n}return Object(c.a)(s,[{key:"componentDidMount",value:function(){var e=this.props.authUser;e&&e.id&&this.startTracking(),this.getProposals()}},{key:"componentWillUnmount",value:function(){this.$elem&&this.$elem.removeEventListener("scroll",this.trackScroll)}},{key:"componentDidUpdate",value:function(e){var t=this.props.authUser;e.authUser&&e.authUser.id||!t||!t.id||this.startTracking()}},{key:"startTracking",value:function(){this.$elem=document.getElementById("app-completed-proposals-sectionBody"),this.$elem&&this.$elem.addEventListener("scroll",this.trackScroll)}},{key:"reloadTable",value:function(){var e=this;this.setState({page_id:1,proposals:[],finished:!1},(function(){e.getProposals()}))}},{key:"runNextPage",value:function(){var e=this,t=this.state,s=t.calling,n=t.loading,a=t.finished,c=t.page_id;s||n||a||this.setState({page_id:c+1},(function(){e.getProposals(!1)}))}},{key:"getProposals",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],s=this.state,n=s.calling,a=s.loading,c=s.finished,r=s.sort_key,i=s.sort_direction,l=s.search,o=s.page_id,d=s.proposals;if(!(a||n||c)){var u={sort_key:r,sort_direction:i,search:l,page_id:o};this.props.dispatch(Object(O.tb)(u,(function(){t?e.setState({loading:!0,calling:!0}):e.setState({loading:!1,calling:!0})}),(function(t){var s=t.proposals||[],n=t.finished||!1;e.setState({loading:!1,calling:!1,finished:n,proposals:[].concat(Object(S.a)(d),Object(S.a)(s))})})))}}},{key:"clickRow",value:function(e){var t=this.props,s=t.history,n=t.authUser;n.is_admin||n.is_member?s.push("/app/proposal/".concat(e.id)):n.is_participant&&(e.user_id==n.id?s.push("/app/proposal/".concat(e.id)):e.votes&&e.votes.length||s.push("/app/proposal/".concat(e.id)))}},{key:"renderTitle",value:function(e){return e.title}},{key:"renderProposals",value:function(){var e=this,t=this.state.proposals,s=[];return t&&t.length?(t.forEach((function(t){s.push(Object(n.jsx)("li",{children:Object(n.jsxs)("div",{className:"infinite-row",onClick:function(){return e.clickRow(t)},children:[Object(n.jsx)("div",{className:"c-col-0 c-cols",children:Object(n.jsx)("label",{className:"font-size-14 d-block",children:t.id})}),Object(n.jsxs)("div",{className:"c-col-1 c-cols",children:[Object(n.jsx)("label",{className:"font-size-14 font-weight-700",children:e.renderTitle(t)}),Object(n.jsx)("p",{className:"font-size-12",children:W.a.getExcerpt(t.short_description||t.member_reason)})]}),Object(n.jsx)("div",{className:"c-col-2 c-cols",children:Object(n.jsx)("label",{className:"font-size-14 d-block",children:t.forum_name})}),Object(n.jsx)("div",{className:"c-col-3 c-cols",children:Object(n.jsx)("label",{className:"font-size-14",children:"grant"==t.type?"Grant":"Simple"})}),Object(n.jsx)("div",{className:"c-col-4 c-cols",children:Object(n.jsxs)("div",{className:"c-image-wrap",children:[Object(n.jsx)("div",{children:Object(n.jsx)(B.a,{size:20})}),Object(n.jsx)("span",{className:"font-size-12",children:t.comments})]})}),Object(n.jsx)("div",{className:"c-col-5 c-cols",children:Object(n.jsxs)("div",{className:"c-image-wrap",children:[Object(n.jsx)("div",{children:Object(n.jsx)(M.a,{size:20})}),Object(n.jsx)("span",{className:"font-size-12",children:t.changes})]})}),Object(n.jsx)("div",{className:"c-col-6 c-cols",children:Object(n.jsxs)("label",{className:"font-size-14",children:[Q(t.created_at).local().format("M/D/YYYY")," ",Q(t.created_at).local().format("h:mm A")]})})]})},"proposal_".concat(t.id)))})),Object(n.jsx)("ul",{children:s})):Object(n.jsx)("div",{id:"infinite-no-result",children:Object(n.jsx)("label",{className:"font-size-14",children:"No Results Found"})})}},{key:"renderTriangle",value:function(e){var t=this.state,s=t.sort_key,a=t.sort_direction;return s!=e?Object(n.jsx)("span",{className:"inactive",children:"\u25b2"}):"asc"==a?Object(n.jsx)("span",{children:"\u25b2"}):Object(n.jsx)("span",{children:"\u25bc"})}},{key:"clickHeader",value:function(e){var t=this,s=this.state,n=s.sort_key,a=s.sort_direction;n==e?a="asc"==a?"desc":"asc":(n=e,a="desc"),this.setState({sort_key:n,sort_direction:a},(function(){t.reloadTable()}))}},{key:"renderHeader",value:function(){var e=this;return Object(n.jsx)("div",{className:"infinite-header",children:Object(n.jsxs)("div",{className:"infinite-headerInner",children:[Object(n.jsxs)("div",{className:"c-col-0 c-cols",onClick:function(){return e.clickHeader("proposal.id")},children:[Object(n.jsx)("label",{className:"font-size-14",children:"#"}),this.renderTriangle("proposal.id")]}),Object(n.jsxs)("div",{className:"c-col-1 c-cols",onClick:function(){return e.clickHeader("proposal.title")},children:[Object(n.jsx)("label",{className:"font-size-14",children:"Title"}),this.renderTriangle("proposal.title")]}),Object(n.jsx)("div",{className:"c-col-2 c-cols",children:Object(n.jsx)("label",{className:"font-size-14",children:"Forum Name"})}),Object(n.jsxs)("div",{className:"c-col-3 c-cols",onClick:function(){return e.clickHeader("proposal.type")},children:[Object(n.jsx)("label",{className:"font-size-14",children:"Type"}),this.renderTriangle("proposal.type")]}),Object(n.jsxs)("div",{className:"c-col-4 c-cols",onClick:function(){return e.clickHeader("proposal.comments")},children:[Object(n.jsx)("label",{className:"font-size-14",children:"Comments"}),this.renderTriangle("proposal.comments")]}),Object(n.jsxs)("div",{className:"c-col-5 c-cols",onClick:function(){return e.clickHeader("proposal.changes")},children:[Object(n.jsx)("label",{className:"font-size-14",children:"Changes"}),this.renderTriangle("proposal.changes")]}),Object(n.jsxs)("div",{className:"c-col-6 c-cols",onClick:function(){return e.clickHeader("proposal.created_at")},children:[Object(n.jsx)("label",{className:"font-size-14",children:"Date"}),this.renderTriangle("proposal.created_at")]})]})})}},{key:"render",value:function(){var e=this.state,t=e.loading,s=e.search,a=this.props.authUser;return a&&a.id?Object(n.jsx)(m.Fade,{distance:"20px",bottom:!0,duration:300,delay:600,children:Object(n.jsxs)("section",{id:"app-completed-proposals-section",className:"app-infinite-box",children:[Object(n.jsxs)("div",{className:"app-infinite-search-wrap",children:[Object(n.jsx)("label",{children:"Completed Proposals"}),Object(n.jsx)("input",{type:"text",value:s,onChange:this.handleSearch,placeholder:"Search..."})]}),Object(n.jsx)("div",{className:"infinite-content",children:Object(n.jsxs)("div",{className:"infinite-contentInner",children:[this.renderHeader(),Object(n.jsx)("div",{className:"infinite-body",id:"app-completed-proposals-sectionBody",children:t?Object(n.jsx)(C.k,{}):this.renderProposals()})]})})]})}):null}}]),s}(u.Component),X=Object(h.b)((function(e){return{authUser:e.global.authUser}}))(Object(j.g)(J));s("zecp");function ee(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var s,n=Object(o.a)(e);if(t){var a=Object(o.a)(this).constructor;s=Reflect.construct(n,arguments,a)}else s=n.apply(this,arguments);return Object(l.a)(this,s)}}var te=function(e){Object(i.a)(s,e);var t=ee(s);function s(e){var n;return Object(a.a)(this,s),n=t.call(this,e),Object(d.a)(Object(r.a)(n),"createGrantProposal",(function(){var e=n.props.authUser;null!==e&&void 0!==e&&e.shuftipro_temp?n.props.dispatch(Object(O.Qb)({limit:1},(function(){n.props.dispatch(Object(z.Cb)())}),(function(e){n.props.dispatch(Object(z.U)()),e.proposals.length?n.openDraftProposal():n.gotoNewGrant()}))):n.props.dispatch(Object(z.Z)("kyc-grant"))})),Object(d.a)(Object(r.a)(n),"gotoNewGrant",(function(){n.props.history.push("/app/proposal/new")})),Object(d.a)(Object(r.a)(n),"openDraftProposal",(function(){n.props.dispatch(Object(z.Z)("draft-proposals"))})),n.state={tab:"active"},n}return Object(c.a)(s,[{key:"renderMembershipButton",value:function(){var e=this.props.authUser;return e&&(e.is_member||e.is_admin)||e&&e.membership&&e.membership.id?null:Object(n.jsxs)(b.b,{to:"/app/proposal/upgrade-membership",className:"btn btn-primary-outline btn-fluid btn-icon",children:[Object(n.jsx)(f.a,{}),"New Proposal for Membership"]})}},{key:"renderButtons",value:function(){var e=this,t=this.props.authUser;return t.is_admin?null:Object(n.jsx)(m.Fade,{distance:"20px",bottom:!0,duration:400,delay:600,children:Object(n.jsxs)("div",{id:"app-proposals-page__buttons",className:"mb-5 align-items-start",children:[Object(n.jsxs)("div",{className:"d-flex gap-5 align-items-center flex-column mr-2",children:[Object(n.jsxs)("button",{className:"btn btn-primary btn-fluid mx-0",onClick:function(){return e.createGrantProposal()},children:[Object(n.jsx)("img",{src:"/tabs/plus.png",alt:""}),"New Grant Proposal"]}),Object(n.jsx)("a",{className:"mt-2 text-underline",style:{color:"inherit",cursor:"pointer"},onClick:function(){return e.openDraftProposal()},children:"Load a saved proposal"})]}),t.is_member?Object(n.jsxs)(b.b,{to:"/app/simple-proposal/new",className:"btn btn-primary-outline btn-fluid",children:[Object(n.jsx)(f.a,{}),"New Simple Proposal"]}):null]})})}},{key:"renderContent",value:function(){var e=this.props.authUser;return"completed"==this.state.tab?Object(n.jsx)(X,{}):e.is_admin?Object(n.jsx)(Z,{}):Object(n.jsxs)(u.Fragment,{children:[e.grant_active&&Object(n.jsx)(N,{}),Object(n.jsx)(x,{}),Object(n.jsx)(I,{}),Object(n.jsx)(Z,{})]})}},{key:"render",value:function(){var e=this,t=this.props.authUser,s=this.state.tab;return t&&t.id&&(t.is_admin||t.is_member||t.is_participant)?Object(n.jsxs)("div",{id:"app-proposals-page",children:[this.renderButtons(),Object(n.jsx)(m.Fade,{distance:"20px",bottom:!0,duration:400,delay:600,children:Object(n.jsxs)("ul",{id:"app-proposals-pageHeader",children:[Object(n.jsx)("li",{className:"active"==s?"active":"",onClick:function(){return e.setState({tab:"active"})},children:"Active"}),Object(n.jsx)("li",{className:"completed"==s?"active":"",onClick:function(){return e.setState({tab:"completed"})},children:"Completed"})]})}),this.renderContent()]}):null}}]),s}(u.Component);t.default=Object(h.b)((function(e){return{authUser:e.global.authUser}}))(Object(j.g)(te))}}]);