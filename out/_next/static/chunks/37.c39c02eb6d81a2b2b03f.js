(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[37],{CuFn:function(e,t,s){"use strict";s.r(t);var c=s("nKUr"),i=s("1OyB"),n=s("vuIU"),l=s("JX7q"),r=s("Ji7U"),a=s("md7G"),o=s("foSv"),d=s("rePB"),j=s("q1tI"),h=s("/MKj"),u=s("Ty5D"),b=s("s/m+"),p=s("e+cM"),O=s("LADp"),f=s("KQm4"),m=s("wd/R"),x=s.n(m);s("hUgm");function v(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var s,c=Object(o.a)(e);if(t){var i=Object(o.a)(this).constructor;s=Reflect.construct(c,arguments,i)}else s=c.apply(this,arguments);return Object(a.a)(this,s)}}var g=function(e){Object(r.a)(s,e);var t=v(s);function s(e){var c;return Object(i.a)(this,s),c=t.call(this,e),Object(d.a)(Object(l.a)(c),"trackScroll",(function(){c.$elem&&c.$elem.scrollTop+c.$elem.clientHeight>=c.$elem.scrollHeight&&c.runNextPage()})),c.state={loading:!1,data:[],sort_key:"",sort_direction:"desc",search:"",page_id:1,calling:!1,finished:!1},c.$elem=null,c.timer=null,c}return Object(n.a)(s,[{key:"componentDidMount",value:function(){var e=this.props.authUser;e&&e.id&&this.startTracking(),this.getData()}},{key:"componentWillUnmount",value:function(){this.$elem&&this.$elem.removeEventListener("scroll",this.trackScroll)}},{key:"componentDidUpdate",value:function(e){var t=this.props.authUser;e.authUser&&e.authUser.id||!t||!t.id||this.startTracking()}},{key:"startTracking",value:function(){this.$elem=document.getElementById("logs-scroll-track"),this.$elem&&this.$elem.addEventListener("scroll",this.trackScroll)}},{key:"runNextPage",value:function(){var e=this,t=this.state,s=t.calling,c=t.loading,i=t.finished,n=t.page_id;s||c||i||this.setState({page_id:n+1},(function(){e.getData(!1)}))}},{key:"getData",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],s=this.state,c=s.calling,i=s.loading,n=s.finished,l=s.sort_key,r=s.sort_direction,a=s.search,o=s.page_id,d=s.data;if(!(i||c||n)){var j={sort_key:l,sort_direction:r,search:a,page_id:o,limit:20};this.props.dispatch(Object(O.vb)(this.props.id,j,(function(){t?e.setState({loading:!0,calling:!0}):e.setState({loading:!1,calling:!0})}),(function(t){var s=t.milestoneLogs||[],c=t.finished||!1;e.setState({loading:!1,calling:!1,finished:c,data:[].concat(Object(f.a)(d),Object(f.a)(s))})})))}}},{key:"renderMilestoneIndex",value:function(e){var t=e.milestones.findIndex((function(t){return t.id===e.milestone_id}));return Object(c.jsxs)("p",{className:"pl-3",children:[t+1,"/",e.milestones.length]})}},{key:"renderResult",value:function(){var e=this.state.data,t=[];return e&&e.length?(e.forEach((function(e){t.push(Object(c.jsx)("li",{children:Object(c.jsxs)("div",{className:"infinite-row align-items-center d-flex py-3 font-size-14 font-weight-700",children:[Object(c.jsx)("div",{className:"c-col-1 c-cols",children:Object(c.jsx)("p",{children:x()(e.created_at).local().format("M/D/YYYY")})}),Object(c.jsx)("div",{className:"c-col-2 c-cols",children:Object(c.jsx)("p",{children:e.email})}),Object(c.jsx)("div",{className:"c-col-3 c-cols",children:Object(c.jsx)("p",{children:e.action})})]})},"mile_".concat(e.id)))})),Object(c.jsx)("ul",{children:t})):Object(c.jsx)("div",{id:"infinite-no-result",children:Object(c.jsx)("label",{className:"font-size-14",children:"No Results Found"})})}},{key:"render",value:function(){var e=this.state.loading;return Object(c.jsx)("div",{className:"activity-logs-table infinite-content",children:Object(c.jsxs)("div",{className:"infinite-contentInner",children:[Object(c.jsx)("div",{className:"infinite-header",children:Object(c.jsxs)("div",{className:"infinite-headerInner",children:[Object(c.jsx)("div",{className:"c-col-1 c-cols",children:Object(c.jsx)("label",{className:"font-size-14",children:"Date and time"})}),Object(c.jsx)("div",{className:"c-col-2 c-cols",children:Object(c.jsx)("label",{className:"font-size-14",children:"User"})}),Object(c.jsx)("div",{className:"c-col-3 c-cols",children:Object(c.jsx)("label",{className:"font-size-14",children:"Action"})})]})}),Object(c.jsx)("div",{className:"infinite-body",id:"logs-scroll-track",children:e?Object(c.jsx)(p.f,{}):this.renderResult()})]})})}}]),s}(j.Component),N=Object(h.b)((function(e){return{authUser:e.global.authUser}}))(g),y=s("ZpDd");function w(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);t&&(c=c.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,c)}return s}function _(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?w(Object(s),!0).forEach((function(t){Object(d.a)(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):w(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function k(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var s,c=Object(o.a)(e);if(t){var i=Object(o.a)(this).constructor;s=Reflect.construct(c,arguments,i)}else s=c.apply(this,arguments);return Object(a.a)(this,s)}}var S=function(e){Object(r.a)(s,e);var t=k(s);function s(e){var c;return Object(i.a)(this,s),c=t.call(this,e),Object(d.a)(Object(l.a)(c),"togglePaid",(function(e){var t=c.state.data;t.paid=!t.paid,c.setState({data:_({},t)}),c.props.dispatch(Object(O.Rc)(c.state.id,e?1:0,(function(){}),(function(e){e.success&&(c.setState({isShow:!1}),c.props.dispatch(Object(y.zb)("You've successfully update paid status of this milestone","success")),setTimeout((function(){c.setState({isShow:!0})}),100))})))})),c.state={id:null,data:{},isShow:!0,currentMilestone:null},c}return Object(n.a)(s,[{key:"componentDidMount",value:function(){var e=this.props.match.params,t=e.id;this.setState({id:t}),this.getDetail(e.id)}},{key:"getDetail",value:function(e){var t=this;this.props.dispatch(Object(O.ub)(e,(function(){}),(function(s){if(s.success){var c=s.milestone,i=c.milestones.findIndex((function(t){return+t.id===+e}));c.milestoneIndex=i+1,t.setState({data:c,currentMilestone:c.milestones[i]})}})))}},{key:"render",value:function(){var e,t,s=this,i=this.props.authUser,n=this.state,l=n.data,r=n.currentMilestone,a=n.id,o=n.isShow;return i&&i.id?i.is_admin?Object(c.jsx)("div",{id:"milestones-page",className:"h-100",children:Object(c.jsxs)(b.Fade,{distance:"20px",bottom:!0,duration:300,delay:600,children:[Object(c.jsx)(p.h,{title:"Milestones log for ".concat(l.proposal_id,"-").concat(l.milestoneIndex)}),Object(c.jsxs)("section",{className:"app-infinite-box mb-4",children:[Object(c.jsxs)("div",{className:"app-infinite-search-wrap",children:[Object(c.jsx)("h4",{children:"Summary"}),Object(c.jsx)(p.j,{value:!!l.paid,onChange:function(e){return s.togglePaid(e.target.checked)},labelRight:"paid",labelLeft:"unpaid"})]}),Object(c.jsx)("div",{className:"pl-5",children:Object(c.jsx)("div",{children:Object(c.jsx)("table",{children:Object(c.jsxs)("tbody",{children:[Object(c.jsxs)("tr",{children:[Object(c.jsx)("td",{className:"pr-2",children:"Milestone status:"}),Object(c.jsx)("td",{className:"font-weight-bold",children:l.submitted_time?"Submitted":"Not submitted"})]}),Object(c.jsxs)("tr",{children:[Object(c.jsx)("td",{className:"pr-2 pb-2",children:"Paid?:"}),Object(c.jsx)("td",{className:"font-weight-bold",children:l.paid?"Yes":"No"})]}),Object(c.jsxs)("tr",{children:[Object(c.jsx)("td",{className:"pr-2",children:"OP email:"}),Object(c.jsx)("td",{className:"font-weight-bold",children:l.email})]}),Object(c.jsxs)("tr",{children:[Object(c.jsx)("td",{className:"pr-2",children:"Proposal number:"}),Object(c.jsx)("td",{className:"font-weight-bold",children:l.proposal_id})]}),Object(c.jsxs)("tr",{children:[Object(c.jsx)("td",{className:"pr-2",children:"Proposal title:"}),Object(c.jsx)("td",{className:"font-weight-bold",children:l.proposal_title})]}),Object(c.jsxs)("tr",{children:[Object(c.jsx)("td",{className:"pr-2",children:"Proposal status:"}),Object(c.jsx)("td",{className:"font-weight-bold",children:l.proposal_status})]}),Object(c.jsxs)("tr",{children:[Object(c.jsx)("td",{className:"pr-2",children:"Milestones in this proposal:"}),Object(c.jsx)("td",{className:"font-weight-bold",children:null===(e=l.milestones)||void 0===e?void 0:e.length})]}),Object(c.jsxs)("tr",{children:[Object(c.jsx)("td",{className:"pr-2",children:"Milestone title:"}),Object(c.jsx)("td",{className:"font-weight-bold",children:null===r||void 0===r?void 0:r.title})]}),Object(c.jsxs)("tr",{children:[Object(c.jsx)("td",{className:"pr-2",children:"Acceptance criteria:"}),Object(c.jsx)("td",{className:"font-weight-bold",children:null===r||void 0===r?void 0:r.criteria})]}),Object(c.jsxs)("tr",{children:[Object(c.jsx)("td",{className:"pr-2",children:"OP milestone submission URL:"}),Object(c.jsx)("td",{className:"font-weight-bold",children:null===r||void 0===r?void 0:r.url})]}),Object(c.jsxs)("tr",{children:[Object(c.jsx)("td",{className:"pr-2 align-top",children:"OP milestone submission notes:"}),Object(c.jsx)("td",{className:"font-weight-bold",children:Object(c.jsx)("p",{className:"text-pre-wrap",children:null===r||void 0===r?void 0:r.comment})})]}),Object(c.jsxs)("tr",{children:[Object(c.jsx)("td",{className:"pr-2",children:"Grant portion:"}),Object(c.jsx)("td",{className:"font-weight-bold",children:null===r||void 0===r?void 0:r.grant})]}),Object(c.jsxs)("tr",{children:[Object(c.jsx)("td",{className:"pr-2",children:"Code reviewer:"}),Object(c.jsx)("td",{className:"font-weight-bold",children:null===l||void 0===l?void 0:l.admin_reviewer_email})]}),Object(c.jsxs)("tr",{children:[Object(c.jsx)("td",{className:"pr-2",children:"Review date:"}),Object(c.jsx)("td",{className:"font-weight-bold",children:x()(null===r||void 0===r?void 0:r.reviewed_at).format("M/D/YYYY")})]}),Object(c.jsxs)("tr",{children:[Object(c.jsx)("td",{className:"pr-2 align-top",children:"Reviewer notes:"}),Object(c.jsx)("td",{className:"font-weight-bold",children:Object(c.jsx)("p",{className:"text-pre-wrap",children:null===r||void 0===r?void 0:r.notes})})]}),Object(c.jsxs)("tr",{children:[Object(c.jsx)("td",{className:"pr-2",children:"Reviewer attachments:"}),Object(c.jsx)("td",{className:"font-weight-bold",children:Object(c.jsx)("a",{className:"text-underline",target:"_blank",href:null===l||void 0===l?void 0:l.support_file_url,rel:"noreferrer",children:null===l||void 0===l||null===(t=l.support_file)||void 0===t?void 0:t.split("/").pop()})})]})]})})})}),Object(c.jsx)("div",{className:"pt-5 app-infinite-search-wrap",children:Object(c.jsx)("h4",{children:"Activity log"})}),Object(c.jsx)("div",{className:"pl-5",children:!!a&&!!o&&Object(c.jsx)(N,{id:a})})]})]})}):Object(c.jsx)(u.a,{to:"/"}):null}}]),s}(j.Component);t.default=Object(h.b)((function(e){return{authUser:e.global.authUser}}))(Object(u.g)(S))}}]);