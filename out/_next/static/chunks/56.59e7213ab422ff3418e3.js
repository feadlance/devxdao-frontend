(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[56],{TjHA:function(e,t,s){"use strict";s.r(t);var c=s("nKUr"),n=s("1OyB"),i=s("vuIU"),r=s("JX7q"),a=s("Ji7U"),l=s("md7G"),o=s("foSv"),d=s("rePB"),u=s("q1tI"),j=s("/MKj"),p=s("Ty5D"),b=s("55Ip"),h=s("s/m+"),v=s("e+cM"),O=(s("B7S4"),s("f8UJ")),f=s("ZpDd"),m=s("LADp"),x=s("xzuf"),y=s("wd/R"),w=s.n(y),N=s("YW6W");function S(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var s,c=Object(o.a)(e);if(t){var n=Object(o.a)(this).constructor;s=Reflect.construct(c,arguments,n)}else s=c.apply(this,arguments);return Object(l.a)(this,s)}}var _=function(e){Object(a.a)(s,e);var t=S(s);function s(e){var c;return Object(n.a)(this,s),c=t.call(this,e),Object(d.a)(Object(r.a)(c),"showAnswer",(function(){var e=c.state,t=e.currentVoter,s=e.surveyId,n=e.voters.find((function(e){return+e.user_id===+t}));c.props.dispatch(Object(f.Z)("show-survey-voter-answer",{surveyId:s,user:n}))})),Object(d.a)(Object(r.a)(c),"sendReminder",(function(){c.props.dispatch(Object(m.Nc)(c.state.surveyId,(function(){c.props.dispatch(Object(f.Cb)())}),(function(e){c.props.dispatch(Object(f.U)()),e.success&&c.props.dispatch(Object(f.Bb)("Send reminder successfully!","success"))})))})),c.state={surveyId:null,surveyData:null,voters:[],unvotedUsers:[],currentVoter:""},c}return Object(i.a)(s,[{key:"componentDidMount",value:function(){var e=this,t=this.props.match.params.id;this.setState({surveyId:t}),this.props.dispatch(Object(m.cc)(t,(function(){}),(function(t){t.success&&e.setState({surveyData:t.survey})}))),this.props.dispatch(Object(m.ec)(t,{limit:9999},(function(){}),(function(t){t.success&&e.setState({voters:t.users})}))),this.props.dispatch(Object(m.ic)(t,{limit:9999},(function(){}),(function(t){t.success&&e.setState({unvotedUsers:t.users})})))}},{key:"render",value:function(){var e=this,t=this.props.authUser,s=this.state,n=s.surveyData,i=s.surveyId,r=s.voters,a=s.unvotedUsers,l=s.currentVoter;return t&&t.id?t.is_admin?Object(c.jsx)("div",{id:"survey-detail-page",className:"h-100",children:Object(c.jsxs)(h.Fade,{distance:"20px",bottom:!0,duration:300,delay:600,children:[Object(c.jsx)(v.m,{title:""}),Object(c.jsxs)("section",{className:"app-infinite-box mb-4",children:[Object(c.jsx)("div",{className:"app-infinite-search-wrap",children:Object(c.jsxs)("h4",{children:["Survey S",null===n||void 0===n?void 0:n.id]})}),Object(c.jsxs)("div",{className:"pb-3 pl-5 pr-3",children:[Object(c.jsxs)("div",{children:[Object(c.jsx)("span",{children:"Status: "}),Object(c.jsx)("b",{className:"text-capitalize",children:null===n||void 0===n?void 0:n.status})]}),"active"===(null===n||void 0===n?void 0:n.status)&&Object(c.jsxs)("div",{className:"flex",children:[Object(c.jsx)("span",{children:"Time left: "}),Object(c.jsx)("b",{className:"d-inline-block",children:Object(c.jsx)(x.a,{lastTime:w()(null===n||void 0===n?void 0:n.end_time)})})]}),Object(c.jsxs)("div",{children:[Object(c.jsx)("span",{children:"Submissions complete:"})," ",Object(c.jsxs)("b",{children:[null===n||void 0===n?void 0:n.user_responded," out of ",null===n||void 0===n?void 0:n.total_member]})]})]}),"completed"===(null===n||void 0===n?void 0:n.status)&&Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)("div",{className:"app-infinite-search-wrap",children:Object(c.jsx)("h4",{children:"Winners"})}),Object(c.jsx)("div",{className:"pb-3 pl-5 pr-3",children:Object(c.jsx)("ul",{children:null===n||void 0===n?void 0:n.survey_ranks.filter((function(e){return e.is_winner})).map((function(e){var t,s;return Object(c.jsxs)("li",{className:"py-2",children:[N.a.ordinalSuffixOf(e.rank)," Place -"," ",Object(c.jsx)(b.b,{to:"/app/proposal/".concat(null===(t=e.proposal)||void 0===t?void 0:t.id),children:Object(c.jsx)("b",{children:null===(s=e.proposal)||void 0===s?void 0:s.title})})]},e.id)}))})})]}),i&&Object(c.jsx)(O.a,{id:i,cols:null===n||void 0===n?void 0:n.number_response}),Object(c.jsx)("div",{className:"app-infinite-search-wrap",children:Object(c.jsx)("h4",{children:"View survey responses by user"})}),Object(c.jsxs)("div",{className:"c-form-row pb-3 pl-5 pr-3",children:[Object(c.jsx)("label",{children:"Select number of responses needed"}),Object(c.jsxs)("div",{className:"d-flex",children:[Object(c.jsxs)("select",{value:l,onChange:function(t){return e.setState({currentVoter:t.target.value})},children:[Object(c.jsx)("option",{value:"",disabled:!0,children:"Select voter"}),r.map((function(e,t){return Object(c.jsx)("option",{value:e.user_id,children:e.email},"option1_".concat(t))}))]}),Object(c.jsx)("button",{disabled:!l,className:"ml-3 btn btn-primary small",onClick:this.showAnswer,children:"Go"})]})]}),"active"===(null===n||void 0===n?void 0:n.status)&&Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)("div",{className:"app-infinite-search-wrap",children:Object(c.jsx)("h4",{children:"Users who have not yet submitted survey"})}),Object(c.jsxs)("div",{className:"pb-3 pl-5 pr-3",children:[Object(c.jsx)("ul",{children:a.map((function(e){return Object(c.jsx)("li",{className:"py-2",children:e.email},e.id)}))}),Object(c.jsx)("button",{className:"mt-5 btn btn-primary less-small",onClick:this.sendReminder,disabled:0===a.length,children:"Send reminder"})]})]})]})]})}):Object(c.jsx)(p.a,{to:"/"}):null}}]),s}(u.Component);t.default=Object(j.b)((function(e){return{authUser:e.global.authUser}}))(Object(p.g)(_))}}]);