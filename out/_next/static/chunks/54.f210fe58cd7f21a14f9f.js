(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[54],{CGyr:function(e,t,s){"use strict";s.r(t);var i=s("nKUr"),n=s("1OyB"),r=s("vuIU"),c=s("JX7q"),o=s("Ji7U"),a=s("md7G"),l=s("foSv"),u=s("rePB"),d=s("q1tI"),p=s("/MKj"),b=s("Ty5D"),j=s("55Ip"),v=s("s/m+"),h=s("e+cM"),O=(s("0y1/"),s("LADp")),f=s("ZpDd"),m=s("XqUm"),y=s("YW6W"),x=s("xzuf"),S=s("wd/R"),g=s.n(S);function w(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function k(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var s,i=Object(l.a)(e);if(t){var n=Object(l.a)(this).constructor;s=Reflect.construct(i,arguments,n)}else s=i.apply(this,arguments);return Object(a.a)(this,s)}}var N=function(e){Object(o.a)(s,e);var t=k(s);function s(e){var i;return Object(n.a)(this,s),i=t.call(this,e),Object(u.a)(Object(c.a)(i),"checkSkip",(function(e){return 0!==e||null})),Object(u.a)(Object(c.a)(i),"renderDiscussions",(function(e){var t=i.state,s=t.responses,n=t.discussions,r=s.filter((function(e){return!!e})).map((function(e){return e.proposal_id})).filter((function(t){var i;return t!==(null===(i=s[e])||void 0===i?void 0:i.proposal_id)}));return n.filter((function(e){return!r.includes(e.id)}))})),Object(u.a)(Object(c.a)(i),"setResponse",(function(e,t){var s=i.state.responses;"skip"===e.target.value?s[t]=null:s[t]={proposal_id:+e.target.value,place_choice:t+1},i.setState({responses:s})})),Object(u.a)(Object(c.a)(i),"submitResponse",(function(){var e=i.props.authUser,t=i.state,s=t.currentSurvey,n=t.responses.filter((function(e){return!!e}));i.props.dispatch(Object(O.cd)(s.id,{responses:n},(function(){i.props.dispatch(Object(f.Cb)())}),(function(t){i.props.dispatch(Object(f.U)()),t.success&&(s.is_submitted=!0,i.setState({currentSurvey:s}),e.has_survey=0,i.props.dispatch(Object(f.Y)(function(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?w(Object(s),!0).forEach((function(t){Object(u.a)(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):w(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}({},e))),i.props.dispatch(Object(f.Bb)("Submit Responses successfully!","success")))})))})),i.state={showLoading:!0,currentSurvey:null,discussions:[],responses:[],noSurvey:!1},i}return Object(r.a)(s,[{key:"componentDidMount",value:function(){var e=this;this.props.dispatch(Object(O.vb)((function(){e.setState({showLoading:!0})}),(function(t){e.setState({showLoading:!1}),t.success?e.setState({currentSurvey:t.survey}):e.setState({noSurvey:!0})}))),this.props.dispatch(Object(O.gb)({limit:9999,ignore_previous_winner:1},(function(){}),(function(t){var s=t.proposals||[];e.setState({discussions:s})})))}},{key:"render",value:function(){var e=this,t=this.props.authUser,s=this.state,n=s.currentSurvey,r=s.showLoading,c=s.responses,o=s.noSurvey;return t&&t.id?t.is_member?Object(i.jsx)("div",{id:"app-submit-survey-page",className:"h-100",children:Object(i.jsxs)(v.Fade,{distance:"20px",bottom:!0,duration:300,delay:600,children:[Object(i.jsx)(h.m,{title:""}),Object(i.jsxs)("section",{className:"app-infinite-box mb-4",children:[r&&Object(i.jsx)(h.k,{}),!r&&Object(i.jsxs)(i.Fragment,{children:[Object(i.jsxs)("div",{className:"app-infinite-search-wrap",children:["active"===(null===n||void 0===n?void 0:n.status)&&!(null!==n&&void 0!==n&&n.is_submitted)&&Object(i.jsxs)("h4",{children:["Welcome to Survey #S",null===n||void 0===n?void 0:n.id]}),"active"===(null===n||void 0===n?void 0:n.status)&&(null===n||void 0===n?void 0:n.is_submitted)&&Object(i.jsx)("h4",{children:"Thank you for submitting"}),"completed"===(null===n||void 0===n?void 0:n.status)&&Object(i.jsxs)("h4",{children:["Survey #S",null===n||void 0===n?void 0:n.id," has ended"]}),"cancel"===(null===n||void 0===n?void 0:n.status)&&Object(i.jsxs)("h4",{children:["Survey #S",null===n||void 0===n?void 0:n.id," has cancelled"]}),o&&Object(i.jsxs)("div",{children:[Object(i.jsx)("h6",{children:"There are no active surveys at this time. Please check back again later."}),Object(i.jsx)("div",{className:"py-3",children:Object(i.jsx)(j.b,{to:"/app",className:"btn btn-primary less-small",children:"Back to dashboard"})})]})]}),"active"===(null===n||void 0===n?void 0:n.status)&&!(null!==n&&void 0!==n&&n.is_submitted)&&Object(i.jsxs)(i.Fragment,{children:[Object(i.jsxs)("div",{className:"pb-3 pl-5 pr-3",children:[Object(i.jsxs)("div",{className:"c-form-row",children:[Object(i.jsxs)("label",{children:["Please select your favorite",null===n||void 0===n?void 0:n.number_response," proposals from the pool of proposals that have not yet begun their informal vote."]}),Object(i.jsx)("div",{className:"flex box-vote",children:Array(+(null===n||void 0===n?void 0:n.number_response)||0).fill(1).map((function(t,s){var n;return Object(i.jsxs)("select",{defaultValue:"",value:null===(n=c[s])||void 0===n?void 0:n.proposal_id,onChange:function(t){return e.setResponse(t,s)},children:[Object(i.jsxs)("option",{value:"",disabled:!0,children:["Select your ",y.a.ordinalSuffixOf(s+1)," ","place choice"]}),e.checkSkip(s)&&Object(i.jsx)("option",{value:"skip",children:"Skip"}),e.renderDiscussions(s).map((function(e){return Object(i.jsxs)("option",{value:e.id,children:[e.id," - ",e.title]},e.id)}))]},s)}))})]}),Object(i.jsx)("button",{className:"mt-3 btn btn-primary less-small",onClick:this.submitResponse,children:"Submit responses"}),Object(i.jsxs)("div",{className:"d-flex pt-2 pl-2",children:["Time remaining:",Object(i.jsx)("b",{className:"pl-2",children:Object(i.jsx)(x.a,{lastTime:g()(null===n||void 0===n?void 0:n.end_time)})})]}),Object(i.jsx)("p",{className:"py-5",children:"Click any proposal in the table below to see more details. All proposals here have not yet won a ranking position in a prior survey and are still in the discussion phase."})]}),Object(i.jsx)(m.a,{hideWonColumn:!0,hideFilterWinner:!0})]}),"active"===(null===n||void 0===n?void 0:n.status)&&(null===n||void 0===n?void 0:n.is_submitted)&&Object(i.jsxs)("div",{className:"pb-3 pl-3 pr-3",children:[Object(i.jsx)("p",{className:"pb-5",children:"We are still collecting responses from all other voting associates and will update you with the winners on the next public call."}),Object(i.jsx)(j.b,{to:"/app",className:"btn btn-primary less-small",children:"Back to dashboard"})]}),"completed"===(null===n||void 0===n?void 0:n.status)&&Object(i.jsxs)("div",{className:"pb-3 pl-3 pr-3",children:[Object(i.jsx)("p",{children:"The winners are listed below."}),Object(i.jsx)("div",{className:"my-3",children:null===n||void 0===n?void 0:n.survey_ranks.filter((function(e){return e.is_winner})).map((function(e,t){var s,n;return Object(i.jsxs)("p",{className:"py-2",children:[y.a.ordinalSuffixOf(t+1)," Place -"," ",Object(i.jsx)(j.b,{to:"/app/proposal/".concat(null===(s=e.proposal)||void 0===s?void 0:s.id),children:null===(n=e.proposal)||void 0===n?void 0:n.title})]},t)}))}),Object(i.jsx)(j.b,{to:"/app",className:"btn btn-primary less-small",children:"Back to dashboard"})]}),"cancel"===(null===n||void 0===n?void 0:n.status)&&Object(i.jsx)("div",{className:"pb-3 pl-3 pr-3",children:Object(i.jsx)(j.b,{to:"/app",className:"btn btn-primary less-small",children:"Back to dashboard"})})]})]})]})}):Object(i.jsx)(b.a,{to:"/"}):null}}]),s}(d.Component);t.default=Object(p.b)((function(e){return{authUser:e.global.authUser}}))(Object(b.g)(N))}}]);