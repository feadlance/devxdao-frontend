(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[50],{q3S8:function(e,t,i){"use strict";i.r(t);var c=i("nKUr"),l=i("KQm4"),n=i("1OyB"),a=i("vuIU"),s=i("JX7q"),r=i("Ji7U"),o=i("md7G"),d=i("foSv"),u=i("rePB"),h=i("q1tI"),j=i("/MKj"),b=i("Ty5D"),p=i("1tFi"),v=i("s/m+"),f=i("e+cM"),m=i("LADp"),O=(i("zsKP"),i("IwCS")),x=i("ZpDd");function g(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,c=Object(d.a)(e);if(t){var l=Object(d.a)(this).constructor;i=Reflect.construct(c,arguments,l)}else i=c.apply(this,arguments);return Object(o.a)(this,i)}}var y=i("wd/R"),k=function(e){Object(r.a)(i,e);var t=g(i);function i(e){var c;return Object(n.a)(this,i),c=t.call(this,e),Object(u.a)(Object(s.a)(c),"trackScroll",(function(){c.$elem&&c.$elem.scrollTop+c.$elem.clientHeight>=c.$elem.scrollHeight&&c.runNextPage()})),Object(u.a)(Object(s.a)(c),"downloadCSV",(function(){c.props.dispatch(Object(m.S)({search:c.state.search},(function(){c.props.dispatch(Object(x.Cb)())}),(function(e){var t=window.URL.createObjectURL(new Blob([e])),i=document.createElement("a");i.href=t,i.setAttribute("download","my-rep.csv"),document.body.appendChild(i),i.click(),c.props.dispatch(Object(x.U)())})))})),Object(u.a)(Object(s.a)(c),"handleSearch",(function(e){c.setState({search:e.target.value},(function(){c.timer&&(clearTimeout(c.timer),c.timer=null),c.timer=setTimeout((function(){c.reloadTable()}),500)}))})),c.state={loading:!1,items:[],sort_key:"reputation.updated_at",sort_direction:"desc",search:"",page_id:1,calling:!1,finished:!1,total:"",daily_email:!1},c.$elem=null,c.timer=null,c}return Object(a.a)(i,[{key:"componentDidMount",value:function(){var e=this.props.authUser;e&&e.id&&this.startTracking(),this.setState({daily_email:e.notice_send_repatution}),this.getReputation()}},{key:"componentWillUnmount",value:function(){this.$elem&&this.$elem.removeEventListener("scroll",this.trackScroll)}},{key:"componentDidUpdate",value:function(e){var t=this.props.authUser;e.authUser&&e.authUser.id||!t||!t.id||this.startTracking()}},{key:"startTracking",value:function(){this.$elem=document.getElementById("app-reputation-sectionBody"),this.$elem&&this.$elem.addEventListener("scroll",this.trackScroll)}},{key:"reloadTable",value:function(){var e=this;this.setState({page_id:1,items:[],finished:!1},(function(){e.getReputation()}))}},{key:"runNextPage",value:function(){var e=this,t=this.state,i=t.calling,c=t.loading,l=t.finished,n=t.page_id;i||c||l||this.setState({page_id:n+1},(function(){e.getReputation(!1)}))}},{key:"getReputation",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],i=this.state,c=i.calling,n=i.loading,a=i.finished,s=i.sort_key,r=i.sort_direction,o=i.search,d=i.page_id,u=i.items;if(!(n||c||a)){var h={sort_key:s,sort_direction:r,search:o,page_id:d,limit:20};this.props.dispatch(Object(m.Xb)(h,(function(){t?e.setState({loading:!0,calling:!0}):e.setState({loading:!1,calling:!0})}),(function(t){var i=t.items||[],c=t.finished||!1;e.setState({loading:!1,calling:!1,finished:c,items:[].concat(Object(l.a)(u),Object(l.a)(i)),total:t.total})})))}}},{key:"renderTitle",value:function(e){return e.proposal_id?e.proposal_title:"-"}},{key:"renderValue",value:function(e){var t,i,l=parseFloat(e.value);return l>0?Object(c.jsxs)("label",{className:"font-size-14 color-success",children:["+",null===l||void 0===l||null===(t=l.toFixed)||void 0===t?void 0:t.call(l,O.d)]}):l<0?Object(c.jsx)("label",{className:"font-size-14 color-danger",children:null===l||void 0===l||null===(i=l.toFixed)||void 0===i?void 0:i.call(l,O.d)}):""}},{key:"renderStaked",value:function(e){var t,i,l=parseFloat(e.staked);return l>0?Object(c.jsxs)("label",{className:"font-size-14 color-success",children:["+",null===l||void 0===l||null===(t=l.toFixed)||void 0===t?void 0:t.call(l,O.d)]}):l<0?Object(c.jsx)("label",{className:"font-size-14 color-danger",children:null===l||void 0===l||null===(i=l.toFixed)||void 0===i?void 0:i.call(l,O.d)}):""}},{key:"renderPending",value:function(e){var t,i,l=parseFloat(e.pending);return l>0?Object(c.jsxs)("label",{className:"font-size-14 color-success",children:["+",null===l||void 0===l||null===(t=l.toFixed)||void 0===t?void 0:t.call(l,O.d)]}):l<0?Object(c.jsx)("label",{className:"font-size-14 color-danger",children:null===l||void 0===l||null===(i=l.toFixed)||void 0===i?void 0:i.call(l,O.d)}):""}},{key:"renderItems",value:function(){var e=this,t=this.state.items,i=[];return t&&t.length?(t.forEach((function(t){i.push(Object(c.jsx)("li",{children:Object(c.jsxs)("div",{className:"infinite-row",children:[Object(c.jsx)("div",{className:"c-col-1 c-cols",children:Object(c.jsx)("label",{className:"font-size-14",children:t.event})}),Object(c.jsx)("div",{className:"c-col-2 c-cols",children:Object(c.jsx)("label",{className:"font-size-14 font-weight-700",children:e.renderTitle(t)})}),Object(c.jsx)("div",{className:"c-col-3 c-cols",children:Object(c.jsx)("label",{className:"font-size-14",children:t.type})}),Object(c.jsx)("div",{className:"c-col-4 c-cols",children:e.renderValue(t)}),Object(c.jsx)("div",{className:"c-col-5 c-cols",children:e.renderStaked(t)}),Object(c.jsx)("div",{className:"c-col-6 c-cols",children:e.renderPending(t)}),Object(c.jsx)("div",{className:"c-col-7 c-cols",children:Object(c.jsxs)("label",{className:"font-size-14",children:[y(t.updated_at).local().format("M/D/YYYY")," ",y(t.updated_at).local().format("h:mm A")]})})]})},"reputation_".concat(t.id)))})),Object(c.jsx)("ul",{children:i})):Object(c.jsx)("div",{id:"infinite-no-result",children:Object(c.jsx)("label",{className:"font-size-14",children:"No Results Found"})})}},{key:"renderTriangle",value:function(e){var t=this.state,i=t.sort_key,l=t.sort_direction;return i!=e?Object(c.jsx)("span",{className:"inactive",children:"\u25b2"}):"asc"==l?Object(c.jsx)("span",{children:"\u25b2"}):Object(c.jsx)("span",{children:"\u25bc"})}},{key:"clickHeader",value:function(e){var t=this,i=this.state,c=i.sort_key,l=i.sort_direction;c==e?l="asc"==l?"desc":"asc":(c=e,l="desc"),this.setState({sort_key:c,sort_direction:l},(function(){t.reloadTable()}))}},{key:"toggleDailyEmail",value:function(e){var t=this,i=e?1:0;this.setState({daily_email:i}),this.props.dispatch(Object(m.uc)({setting:i},(function(){t.props.dispatch(Object(x.Cb)())}),(function(){t.props.dispatch(Object(x.U)())})))}},{key:"renderHeader",value:function(){var e=this;return Object(c.jsx)("div",{className:"infinite-header",children:Object(c.jsxs)("div",{className:"infinite-headerInner",children:[Object(c.jsxs)("div",{className:"c-col-1 c-cols",onClick:function(){return e.clickHeader("reputation.event")},children:[Object(c.jsx)("label",{className:"font-size-14",children:"Event"}),this.renderTriangle("reputation.event")]}),Object(c.jsxs)("div",{className:"c-col-2 c-cols",onClick:function(){return e.clickHeader("proposal.title")},children:[Object(c.jsx)("label",{className:"font-size-14",children:"Title"}),this.renderTriangle("proposal.title")]}),Object(c.jsxs)("div",{className:"c-col-3 c-cols",onClick:function(){return e.clickHeader("reputation.type")},children:[Object(c.jsx)("label",{className:"font-size-14",children:"Transaction Type"}),this.renderTriangle("reputation.type")]}),Object(c.jsx)("div",{className:"c-col-4 c-cols",children:Object(c.jsx)("label",{className:"font-size-14",children:"Earned/Returned/Lost"})}),Object(c.jsx)("div",{className:"c-col-5 c-cols",children:Object(c.jsx)("label",{className:"font-size-14",children:"Staked"})}),Object(c.jsx)("div",{className:"c-col-6 c-cols",children:Object(c.jsx)("label",{className:"font-size-14",children:"Pending"})}),Object(c.jsxs)("div",{className:"c-col-7 c-cols",onClick:function(){return e.clickHeader("reputation.updated_at")},children:[Object(c.jsx)("label",{className:"font-size-14",children:"Date"}),this.renderTriangle("reputation.updated_at")]})]})})}},{key:"renderTotal",value:function(){var e,t=this.state.total,i=this.props.authUser,c=parseFloat(t)+parseFloat(i.profile.rep);return null===c||void 0===c||null===(e=c.toFixed)||void 0===e?void 0:e.call(c,O.d)}},{key:"render",value:function(){var e,t,i,l,n,a=this,s=this.state,r=s.loading,o=s.search,d=s.total,u=this.props.authUser;return u&&u.id?Object(c.jsxs)("div",{id:"app-reputation-page",children:[Object(c.jsxs)("div",{className:"d-flex justify-content-between",children:[Object(c.jsxs)("h3",{children:["My Available Reputation: ",Object(c.jsx)(p.a,{})," ",Object(c.jsx)("span",{children:null===(e=u.profile.rep)||void 0===e||null===(t=e.toFixed)||void 0===t?void 0:t.call(e,O.d)})]}),Object(c.jsx)(f.f,{value:this.state.daily_email,onChange:function(e){return a.toggleDailyEmail(e)},text:"Daily CSV email"})]}),Object(c.jsxs)("label",{className:"d-block mb-0",children:["Total: ",Object(c.jsx)("span",{children:this.renderTotal()})]}),Object(c.jsxs)("label",{className:"d-block mb-0",children:["Staked: ",Object(c.jsx)("span",{children:null===d||void 0===d||null===(i=d.toFixed)||void 0===i?void 0:i.call(d,O.d)})]}),Object(c.jsxs)("label",{className:"d-block",children:["Minted Pending:",Object(c.jsx)("span",{children:null===(l=u.profile.rep_pending)||void 0===l||null===(n=l.toFixed)||void 0===n?void 0:n.call(l,O.d)})]}),Object(c.jsx)(v.Fade,{distance:"20px",bottom:!0,duration:300,delay:600,children:Object(c.jsxs)("section",{id:"app-reputation-section",className:"app-infinite-box",children:[Object(c.jsxs)("div",{className:"app-infinite-search-wrap",children:[Object(c.jsx)("label",{children:"Reputation Tracking"}),Object(c.jsxs)("div",{children:[Object(c.jsx)("button",{className:"btn btn-primary btn-download extra-small mr-2",onClick:function(){return a.downloadCSV()},children:"Download"}),Object(c.jsx)("input",{type:"text",value:o,onChange:this.handleSearch,placeholder:"Search..."})]})]}),Object(c.jsx)("div",{className:"infinite-content",children:Object(c.jsxs)("div",{className:"infinite-contentInner",children:[this.renderHeader(),Object(c.jsx)("div",{className:"infinite-body",id:"app-reputation-sectionBody",children:r?Object(c.jsx)(f.k,{}):this.renderItems()})]})})]})})]}):null}}]),i}(h.Component);t.default=Object(j.b)((function(e){return{authUser:e.global.authUser}}))(Object(b.g)(k))}}]);