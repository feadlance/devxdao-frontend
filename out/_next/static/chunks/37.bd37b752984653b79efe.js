(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[37],{CuFn:function(e,t,i){"use strict";i.r(t);var s=i("nKUr"),c=i("1OyB"),l=i("vuIU"),n=i("JX7q"),a=i("Ji7U"),o=i("md7G"),d=i("foSv"),r=i("rePB"),j=i("q1tI"),h=i("/MKj"),u=i("Ty5D"),m=i("s/m+"),v=i("e+cM"),b=i("LADp"),p=i("KQm4"),O=i("wd/R"),f=i.n(O);i("hUgm");function x(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,s=Object(d.a)(e);if(t){var c=Object(d.a)(this).constructor;i=Reflect.construct(s,arguments,c)}else i=s.apply(this,arguments);return Object(o.a)(this,i)}}var _=function(e){Object(a.a)(i,e);var t=x(i);function i(e){var s;return Object(c.a)(this,i),s=t.call(this,e),Object(r.a)(Object(n.a)(s),"trackScroll",(function(){s.$elem&&s.$elem.scrollTop+s.$elem.clientHeight>=s.$elem.scrollHeight&&s.runNextPage()})),s.state={loading:!1,data:[],sort_key:"",sort_direction:"desc",search:"",page_id:1,calling:!1,finished:!1},s.$elem=null,s.timer=null,s}return Object(l.a)(i,[{key:"componentDidMount",value:function(){var e=this.props.authUser;e&&e.id&&this.startTracking(),this.getData()}},{key:"componentWillUnmount",value:function(){this.$elem&&this.$elem.removeEventListener("scroll",this.trackScroll)}},{key:"componentDidUpdate",value:function(e){var t=this.props.authUser;e.authUser&&e.authUser.id||!t||!t.id||this.startTracking()}},{key:"startTracking",value:function(){this.$elem=document.getElementById("logs-scroll-track"),this.$elem&&this.$elem.addEventListener("scroll",this.trackScroll)}},{key:"runNextPage",value:function(){var e=this,t=this.state,i=t.calling,s=t.loading,c=t.finished,l=t.page_id;i||s||c||this.setState({page_id:l+1},(function(){e.getData(!1)}))}},{key:"getData",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],i=this.state,s=i.calling,c=i.loading,l=i.finished,n=i.sort_key,a=i.sort_direction,o=i.search,d=i.page_id,r=i.data;if(!(c||s||l)){var j={sort_key:n,sort_direction:a,search:o,page_id:d,limit:20};this.props.dispatch(Object(b.Bb)(this.props.id,j,(function(){t?e.setState({loading:!0,calling:!0}):e.setState({loading:!1,calling:!0})}),(function(t){var i=t.milestoneLogs||[],s=t.finished||!1;e.setState({loading:!1,calling:!1,finished:s,data:[].concat(Object(p.a)(r),Object(p.a)(i))})})))}}},{key:"renderMilestoneIndex",value:function(e){var t=e.milestones.findIndex((function(t){return t.id===e.milestone_id}));return Object(s.jsxs)("p",{className:"pl-3",children:[t+1,"/",e.milestones.length]})}},{key:"renderResult",value:function(){var e=this.state.data,t=[];return e&&e.length?(e.forEach((function(e){t.push(Object(s.jsx)("li",{className:"w-100",children:Object(s.jsxs)("div",{className:"w-100 infinite-row align-items-center d-flex py-3 font-size-14 font-weight-700",children:[Object(s.jsx)("div",{className:"c-col-1 c-cols",children:Object(s.jsx)("p",{children:f()(e.created_at).local().format("M/D/YYYY")})}),Object(s.jsx)("div",{className:"c-col-2 c-cols",children:Object(s.jsx)("p",{children:e.email})}),Object(s.jsx)("div",{className:"c-col-3 c-cols",children:Object(s.jsx)("p",{children:e.action})})]})},"mile_".concat(e.id)))})),Object(s.jsx)("ul",{children:t})):Object(s.jsx)("div",{id:"infinite-no-result",children:Object(s.jsx)("label",{className:"font-size-14",children:"No Results Found"})})}},{key:"render",value:function(){var e=this.state.loading;return Object(s.jsx)("div",{className:"activity-logs-table infinite-content",children:Object(s.jsxs)("div",{className:"infinite-contentInner",children:[Object(s.jsx)("div",{className:"infinite-header",children:Object(s.jsxs)("div",{className:"infinite-headerInner",children:[Object(s.jsx)("div",{className:"c-col-1 c-cols",children:Object(s.jsx)("label",{className:"font-size-14",children:"Date and time"})}),Object(s.jsx)("div",{className:"c-col-2 c-cols",children:Object(s.jsx)("label",{className:"font-size-14",children:"User"})}),Object(s.jsx)("div",{className:"c-col-3 c-cols",children:Object(s.jsx)("label",{className:"font-size-14",children:"Action"})})]})}),Object(s.jsx)("div",{className:"infinite-body",id:"logs-scroll-track",children:e?Object(s.jsx)(v.k,{}):this.renderResult()})]})})}}]),i}(j.Component),g=Object(h.b)((function(e){return{authUser:e.global.authUser}}))(_),N=i("ZpDd");i("fdOA");function k(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,s)}return i}function y(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?k(Object(i),!0).forEach((function(t){Object(r.a)(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):k(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function w(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,s=Object(d.a)(e);if(t){var c=Object(d.a)(this).constructor;i=Reflect.construct(s,arguments,c)}else i=s.apply(this,arguments);return Object(o.a)(this,i)}}var Y=function(e){Object(a.a)(i,e);var t=w(i);function i(e){var s;return Object(c.a)(this,i),s=t.call(this,e),Object(r.a)(Object(n.a)(s),"togglePaid",(function(e){var t=s.state.data;t.paid=!t.paid,s.setState({data:y({},t)}),s.props.dispatch(Object(b.cd)(s.state.id,e?1:0,(function(){}),(function(e){e.success&&(s.setState({isShow:!1}),s.props.dispatch(Object(N.Bb)("You've successfully update paid status of this milestone","success")),setTimeout((function(){s.setState({isShow:!0})}),100))})))})),s.state={id:null,data:{},isShow:!0,currentMilestone:null},s}return Object(l.a)(i,[{key:"componentDidMount",value:function(){var e=this.props.match.params,t=e.id;this.setState({id:t}),this.getDetail(e.id)}},{key:"getDetail",value:function(e){var t=this;this.props.dispatch(Object(b.Ab)(e,(function(){}),(function(i){if(i.success){var s=i.milestone,c=s.milestones.findIndex((function(t){return+t.id===+e}));s.milestoneIndex=c+1,t.setState({data:s,currentMilestone:s.milestones[c]})}})))}},{key:"render",value:function(){var e,t,i,c,l,n,a,o,d,r,j,h,b,p,O,x,_,N,k,y,w,Y,D,M,P,R,S,A,U,C,I,$,E,T,L=this,z=this.props.authUser,B=this.state,F=B.data,J=B.currentMilestone,K=B.id,q=B.isShow;return z&&z.id?z.is_admin?Object(s.jsx)("div",{id:"milestones-page",className:"h-100",children:Object(s.jsxs)(m.Fade,{distance:"20px",bottom:!0,duration:300,delay:600,children:[Object(s.jsx)(v.m,{title:"Milestones log for ".concat(F.proposal_id,"-").concat(F.milestoneIndex)}),Object(s.jsxs)("section",{className:"app-infinite-box mb-4",children:[Object(s.jsxs)("div",{className:"app-infinite-search-wrap",children:[Object(s.jsx)("h4",{children:"Summary"}),Object(s.jsx)(v.o,{value:!!F.paid,onChange:function(e){return L.togglePaid(e.target.checked)},labelRight:"paid",labelLeft:"unpaid"})]}),Object(s.jsx)("div",{className:"pl-5",children:Object(s.jsx)("div",{children:Object(s.jsx)("table",{children:Object(s.jsxs)("tbody",{children:[Object(s.jsxs)("tr",{children:[Object(s.jsx)("td",{className:"pr-2",children:"Milestone status:"}),Object(s.jsx)("td",{className:"font-weight-bold",children:F.submitted_time?"Submitted":"Not submitted"})]}),Object(s.jsxs)("tr",{children:[Object(s.jsx)("td",{className:"pr-2 pb-2",children:"Paid?:"}),Object(s.jsx)("td",{className:"font-weight-bold",children:F.paid?"Yes":"No"})]}),Object(s.jsxs)("tr",{children:[Object(s.jsx)("td",{className:"pr-2",children:"OP email:"}),Object(s.jsx)("td",{className:"font-weight-bold",children:F.email})]}),Object(s.jsxs)("tr",{children:[Object(s.jsx)("td",{className:"pr-2",children:"Proposal number:"}),Object(s.jsx)("td",{className:"font-weight-bold",children:F.proposal_id})]}),Object(s.jsxs)("tr",{children:[Object(s.jsx)("td",{className:"pr-2",children:"Proposal title:"}),Object(s.jsx)("td",{className:"font-weight-bold",children:F.proposal_title})]}),Object(s.jsxs)("tr",{children:[Object(s.jsx)("td",{className:"pr-2",children:"Proposal status:"}),Object(s.jsx)("td",{className:"font-weight-bold",children:F.proposal_status})]}),Object(s.jsxs)("tr",{children:[Object(s.jsx)("td",{className:"pr-2",children:"Milestones in this proposal:"}),Object(s.jsx)("td",{className:"font-weight-bold",children:null===(e=F.milestones)||void 0===e?void 0:e.length})]}),Object(s.jsxs)("tr",{children:[Object(s.jsx)("td",{className:"pr-2",children:"Milestone title:"}),Object(s.jsx)("td",{className:"font-weight-bold",children:null===J||void 0===J?void 0:J.title})]}),Object(s.jsxs)("tr",{children:[Object(s.jsx)("td",{className:"pr-2",children:"Acceptance criteria:"}),Object(s.jsx)("td",{className:"font-weight-bold",children:null===J||void 0===J?void 0:J.criteria})]}),Object(s.jsxs)("tr",{children:[Object(s.jsx)("td",{className:"pr-2",children:"OP milestone submission URL:"}),Object(s.jsx)("td",{className:"font-weight-bold",children:null===J||void 0===J?void 0:J.url})]}),Object(s.jsxs)("tr",{children:[Object(s.jsx)("td",{className:"pr-2 align-top",children:"OP milestone submission notes:"}),Object(s.jsx)("td",{className:"font-weight-bold",children:Object(s.jsx)("p",{className:"text-pre-wrap",children:null===J||void 0===J?void 0:J.comment})})]}),Object(s.jsxs)("tr",{children:[Object(s.jsx)("td",{className:"pr-2",children:"Grant portion:"}),Object(s.jsx)("td",{className:"font-weight-bold",children:null===J||void 0===J?void 0:J.grant})]}),Object(s.jsxs)("tr",{children:[Object(s.jsx)("td",{className:"pr-2",children:"Code reviewer:"}),Object(s.jsx)("td",{className:"font-weight-bold",children:null===F||void 0===F?void 0:F.admin_reviewer_email})]}),Object(s.jsxs)("tr",{children:[Object(s.jsx)("td",{className:"pr-2",children:"Review date:"}),Object(s.jsx)("td",{className:"font-weight-bold",children:f()(null===J||void 0===J?void 0:J.reviewed_at).format("M/D/YYYY")})]}),Object(s.jsxs)("tr",{children:[Object(s.jsx)("td",{className:"pr-2 align-top",children:"Reviewer notes:"}),Object(s.jsx)("td",{className:"font-weight-bold",children:Object(s.jsx)("p",{className:"text-pre-wrap",children:null===J||void 0===J?void 0:J.notes})})]}),Object(s.jsxs)("tr",{children:[Object(s.jsx)("td",{className:"pr-2",children:"Reviewer attachments:"}),Object(s.jsx)("td",{className:"font-weight-bold",children:Object(s.jsx)("a",{className:"text-underline",target:"_blank",href:null===F||void 0===F?void 0:F.support_file_url,rel:"noreferrer",children:null===F||void 0===F||null===(t=F.support_file)||void 0===t?void 0:t.split("/").pop()})})]})]})})})}),Object(s.jsx)("div",{className:"pt-5 app-infinite-search-wrap",children:Object(s.jsx)("h4",{children:"Activity log"})}),Object(s.jsx)("div",{className:"pl-5",children:!!K&&!!q&&Object(s.jsx)(g,{id:K})}),(null===F||void 0===F?void 0:F.milestone_check_list)&&Object(s.jsxs)(s.Fragment,{children:[Object(s.jsx)("div",{className:"pt-5 app-infinite-search-wrap",children:Object(s.jsx)("h4",{children:"Applicant checklist"})}),Object(s.jsxs)("div",{className:"pl-5",children:[Object(s.jsx)(v.f,{value:!0,text:"All attestations accepted on ".concat(f()(null===F||void 0===F||null===(i=F.milestone_check_list)||void 0===i?void 0:i.created_at).format("M/D/YYYY")),readOnly:!0}),Object(s.jsx)("h6",{className:"mt-5",children:"CRdao checklist:"}),Object(s.jsxs)("div",{className:"my-3",children:[Object(s.jsx)(v.g,{value:+(null===F||void 0===F||null===(c=F.milestone_check_list)||void 0===c?void 0:c.crdao_acknowledged_project),text:"CRDAO has acknowledged the project Definition of Done? ".concat(f()(null===F||void 0===F||null===(l=F.milestone_check_list)||void 0===l?void 0:l.created_at).format("M/D/YYYY")),readOnly:!0}),Object(s.jsxs)("p",{className:"padding-notes",children:["Notes:"," ",null===F||void 0===F||null===(n=F.milestone_check_list)||void 0===n?void 0:n.crdao_acknowledged_project_notes]})]}),Object(s.jsxs)("div",{className:"my-3",children:[Object(s.jsx)(v.g,{value:+(null===F||void 0===F||null===(a=F.milestone_check_list)||void 0===a?void 0:a.crdao_accepted_pm),text:"CRDAO has accepted the Program Management T&C? ".concat(f()(null===F||void 0===F||null===(o=F.milestone_check_list)||void 0===o?void 0:o.created_at).format("M/D/YYYY")),readOnly:!0}),Object(s.jsxs)("p",{className:"padding-notes",children:["Notes:"," ",null===F||void 0===F||null===(d=F.milestone_check_list)||void 0===d?void 0:d.crdao_accepted_pm_notes]})]}),Object(s.jsxs)("div",{className:"my-3",children:[Object(s.jsx)(v.g,{value:+(null===F||void 0===F||null===(r=F.milestone_check_list)||void 0===r?void 0:r.crdao_acknowledged_receipt),text:"CRDAO has acknowledged receipt of the corprus of work? ".concat(f()(null===F||void 0===F||null===(j=F.milestone_check_list)||void 0===j?void 0:j.created_at).format("M/D/YYYY")),readOnly:!0}),Object(s.jsxs)("p",{className:"padding-notes",children:["Notes:"," ",null===F||void 0===F||null===(h=F.milestone_check_list)||void 0===h?void 0:h.crdao_acknowledged_receipt_notes]})]}),Object(s.jsxs)("div",{className:"my-3",children:[Object(s.jsx)(v.g,{value:+(null===F||void 0===F||null===(b=F.milestone_check_list)||void 0===b?void 0:b.crdao_submitted_review),text:"CRDAO has submitted a review of the corprus of work? ".concat(f()(null===F||void 0===F||null===(p=F.milestone_check_list)||void 0===p?void 0:p.created_at).format("M/D/YYYY")),readOnly:!0}),Object(s.jsxs)("p",{className:"padding-notes",children:["Notes:"," ",null===F||void 0===F||null===(O=F.milestone_check_list)||void 0===O?void 0:O.crdao_submitted_review_notes]})]}),Object(s.jsxs)("div",{className:"my-3",children:[Object(s.jsx)(v.g,{value:+(null===F||void 0===F||null===(x=F.milestone_check_list)||void 0===x?void 0:x.crdao_submitted_subs),text:"CRDAO has acknowledged the project Definition of Done? ".concat(f()(null===F||void 0===F||null===(_=F.milestone_check_list)||void 0===_?void 0:_.created_at).format("M/D/YYYY")),readOnly:!0}),Object(s.jsxs)("p",{className:"padding-notes",children:["Notes:"," ",null===F||void 0===F||null===(N=F.milestone_check_list)||void 0===N?void 0:N.crdao_submitted_subs_notes]})]}),Object(s.jsx)("h6",{className:"mt-5",children:"Program Management checklist:"}),Object(s.jsxs)("div",{className:"my-3",children:[Object(s.jsx)(v.g,{value:+(null===F||void 0===F||null===(k=F.milestone_check_list)||void 0===k?void 0:k.pm_submitted_evidence),text:"CRDAO Program Management has submitted the Evidence of Work location? ".concat(f()(null===F||void 0===F||null===(y=F.milestone_check_list)||void 0===y?void 0:y.created_at).format("M/D/YYYY")),readOnly:!0}),Object(s.jsxs)("p",{className:"padding-notes",children:["Notes:"," ",null===F||void 0===F||null===(w=F.milestone_check_list)||void 0===w?void 0:w.pm_submitted_evidence_notes]})]}),Object(s.jsxs)("div",{className:"my-3",children:[Object(s.jsx)(v.g,{value:+(null===F||void 0===F||null===(Y=F.milestone_check_list)||void 0===Y?void 0:Y.pm_submitted_admin),text:"CRDAO Program Management has submitted Administrator notes? ".concat(f()(null===F||void 0===F||null===(D=F.milestone_check_list)||void 0===D?void 0:D.created_at).format("M/D/YYYY")),readOnly:!0}),Object(s.jsxs)("p",{className:"padding-notes",children:["Notes:"," ",null===F||void 0===F||null===(M=F.milestone_check_list)||void 0===M?void 0:M.pm_submitted_admin_notes]})]}),Object(s.jsxs)("div",{className:"my-3",children:[Object(s.jsx)(v.g,{value:+(null===F||void 0===F||null===(P=F.milestone_check_list)||void 0===P?void 0:P.pm_verified_crdao),text:"Program Management has verified corprus existence? ".concat(f()(null===F||void 0===F||null===(R=F.milestone_check_list)||void 0===R?void 0:R.created_at).format("M/D/YYYY")),readOnly:!0}),Object(s.jsxs)("p",{className:"padding-notes",children:["Notes:"," ",null===F||void 0===F||null===(S=F.milestone_check_list)||void 0===S?void 0:S.pm_verified_corprus_notes]})]}),Object(s.jsxs)("div",{className:"my-3",children:[Object(s.jsx)(v.g,{value:+(null===F||void 0===F||null===(A=F.milestone_check_list)||void 0===A?void 0:A.pm_verified_crdao),text:"Program Management has verified CRDAO's review exists? ".concat(f()(null===F||void 0===F||null===(U=F.milestone_check_list)||void 0===U?void 0:U.created_at).format("M/D/YYYY")),readOnly:!0}),Object(s.jsxs)("p",{className:"padding-notes",children:["Notes:"," ",null===F||void 0===F||null===(C=F.milestone_check_list)||void 0===C?void 0:C.pm_verified_crdao_notes]})]}),Object(s.jsxs)("div",{className:"my-3",children:[Object(s.jsx)(v.g,{value:+(null===F||void 0===F||null===(I=F.milestone_check_list)||void 0===I?void 0:I.pm_verified_subs),text:"Program Management has verified CRDAO substantiation (voting record) existence? ".concat(f()(null===F||void 0===F||null===($=F.milestone_check_list)||void 0===$?void 0:$.created_at).format("M/D/YYYY")),readOnly:!0}),Object(s.jsxs)("p",{className:"padding-notes",children:["Notes:"," ",null===F||void 0===F||null===(E=F.milestone_check_list)||void 0===E?void 0:E.pm_verified_subs_notes]})]}),Object(s.jsx)("div",{className:"my-3",children:Object(s.jsxs)("p",{className:"padding-notes",children:["Other general reviewer notes:",Object(s.jsx)("span",{className:"pl-2",children:null===F||void 0===F||null===(T=F.milestone_check_list)||void 0===T?void 0:T.addition_note})]})}),Object(s.jsx)("div",{className:"my-3",children:Object(s.jsxs)("p",{className:"padding-notes",children:["Program manager review submission timestamp:",Object(s.jsx)("span",{className:"pl-2",children:f()(null===F||void 0===F?void 0:F.reviewed_at).format("M/D/YYYY")})]})}),Object(s.jsx)("div",{className:"my-3",children:Object(s.jsxs)("p",{className:"padding-notes",children:["Program manager reviewer email:",Object(s.jsx)("span",{className:"pl-2",children:null===F||void 0===F?void 0:F.admin_reviewer_email})]})})]})]})]})]})}):Object(s.jsx)(u.a,{to:"/"}):null}}]),i}(j.Component);t.default=Object(h.b)((function(e){return{authUser:e.global.authUser}}))(Object(u.g)(Y))}}]);