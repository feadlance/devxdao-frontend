(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[29],{Nl2p:function(e,t,c){"use strict";c.r(t);var a=c("nKUr"),n=c("1OyB"),s=c("vuIU"),r=c("JX7q"),i=c("Ji7U"),l=c("md7G"),o=c("foSv"),d=c("rePB"),j=c("q1tI"),u=c("Ty5D"),b=c("/MKj"),h=c("YW6W"),f=(c("6z6P"),c("LADp")),m=c("ZpDd"),p=c("Iowh"),O=c.n(p),v=c("KQm4"),x=c("wd/R"),y=c.n(x),g=c("e+cM");c("2WHa");function N(e,t){var c=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),c.push.apply(c,a)}return c}function w(e){for(var t=1;t<arguments.length;t++){var c=null!=arguments[t]?arguments[t]:{};t%2?N(Object(c),!0).forEach((function(t){Object(d.a)(e,t,c[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(c)):N(Object(c)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(c,t))}))}return e}function P(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var c,a=Object(o.a)(e);if(t){var n=Object(o.a)(this).constructor;c=Reflect.construct(a,arguments,n)}else c=a.apply(this,arguments);return Object(l.a)(this,c)}}var _=function(e){Object(i.a)(c,e);var t=P(c);function c(e){var a;return Object(n.a)(this,c),a=t.call(this,e),Object(d.a)(Object(r.a)(a),"trackScroll",(function(){a.$elem&&a.$elem.scrollTop+a.$elem.clientHeight>=a.$elem.scrollHeight&&a.runNextPage()})),a.state={loading:!1,data:[],sort_key:"id",sort_direction:"desc",search:"",page_id:1,calling:!1,finished:!1},a.$elem=null,a.timer=null,a}return Object(s.a)(c,[{key:"componentDidMount",value:function(){var e=this.props.authUser;e&&e.id&&this.startTracking(),this.getData()}},{key:"componentWillUnmount",value:function(){this.$elem&&this.$elem.removeEventListener("scroll",this.trackScroll)}},{key:"componentDidUpdate",value:function(e){var t=this,c=this.props.authUser;e.authUser&&e.authUser.id||!c||!c.id||this.startTracking();var a=this.props.params;e.params!==a&&(this.setState({params:w({},a)}),setTimeout((function(){return t.reloadTable()})))}},{key:"startTracking",value:function(){this.$elem=document.getElementById("dos-fee-scroll-track"),this.$elem&&this.$elem.addEventListener("scroll",this.trackScroll)}},{key:"runNextPage",value:function(){var e=this,t=this.state,c=t.calling,a=t.loading,n=t.finished,s=t.page_id;c||a||n||this.setState({page_id:s+1},(function(){e.getData(!1)}))}},{key:"reloadTable",value:function(){var e=this;this.setState({page_id:1,data:[],finished:!1},(function(){e.getData()}))}},{key:"getData",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],c=this.state,a=c.calling,n=c.loading,s=c.finished,r=c.sort_key,i=c.sort_direction,l=c.search,o=c.page_id,d=c.data;if(!(n||a||s)){var j=w({sort_key:r,sort_direction:i,search:l,page_id:o,limit:15},this.state.params);this.props.dispatch(Object(f.kb)(j,(function(){t?e.setState({loading:!0,calling:!0}):e.setState({loading:!1,calling:!0})}),(function(t){var c=t.proposals||[],a=t.finished||!1;e.props.onTotal({totalCC:t.totalCC,totalETH:t.totalETH}),e.setState({loading:!1,calling:!1,finished:a,data:[].concat(Object(v.a)(d),Object(v.a)(c))})})))}}},{key:"renderResult",value:function(){var e=this.state.data,t=[];return e&&e.length?(e.forEach((function(e){var c;t.push(Object(a.jsx)("li",{children:Object(a.jsxs)("div",{className:"infinite-row align-items-center d-flex py-3 font-size-14 font-weight-700",children:[Object(a.jsx)("div",{className:"c-col-1 c-cols",children:Object(a.jsx)("p",{children:y()(e.created_at).format("M/D/YYYY h:mm A")})}),Object(a.jsx)("div",{className:"c-col-2 c-cols",children:Object(a.jsx)("p",{children:e.id})}),Object(a.jsx)("div",{className:"c-col-3 c-cols",children:Object(a.jsx)("p",{children:e.email})}),Object(a.jsx)("div",{className:"c-col-4 c-cols",children:Object(a.jsx)("p",{className:"text-uppercase",children:e.type_dos})}),Object(a.jsx)("div",{className:"c-col-5 c-cols",children:Object(a.jsx)("p",{children:h.a.formatPriceNumber((null===e||void 0===e?void 0:e.dos_amount)||0,"\u20ac")})}),Object(a.jsx)("div",{className:"c-col-6 c-cols",children:Object(a.jsx)("p",{children:"eth"===e.type_dos&&(null===(c=e.amount_dos)||void 0===c?void 0:c.toFixed(4))})}),Object(a.jsx)("div",{className:"c-col-7 c-cols",children:Object(a.jsx)("p",{className:"break-word",children:e.dos_txid})}),Object(a.jsx)("div",{className:"c-col-8 c-cols",children:Object(a.jsx)("p",{children:"specialsecretbypass"===e.dos_txid?"Yes":"No"})})]})},"dos_".concat(e.id)))})),Object(a.jsx)("ul",{children:t})):Object(a.jsx)("div",{id:"infinite-no-result",children:Object(a.jsx)("label",{className:"font-size-14",children:"No Results Found"})})}},{key:"render",value:function(){var e=this.state.loading;return Object(a.jsx)("div",{className:"dos-fee-table infinite-content",children:Object(a.jsxs)("div",{className:"infinite-contentInner",children:[Object(a.jsx)("div",{className:"infinite-header",children:Object(a.jsxs)("div",{className:"infinite-headerInner",children:[Object(a.jsx)("div",{className:"c-col-1 c-cols",children:Object(a.jsx)("label",{className:"font-size-14",children:"Date Time"})}),Object(a.jsx)("div",{className:"c-col-2 c-cols",children:Object(a.jsx)("label",{className:"font-size-14",children:"Grant Number"})}),Object(a.jsx)("div",{className:"c-col-3 c-cols",children:Object(a.jsx)("label",{className:"font-size-14",children:"OP"})}),Object(a.jsx)("div",{className:"c-col-4 c-cols",children:Object(a.jsx)("label",{className:"font-size-14",children:"Type"})}),Object(a.jsx)("div",{className:"c-col-5 c-cols",children:Object(a.jsx)("label",{className:"font-size-14",children:"Amount"})}),Object(a.jsx)("div",{className:"c-col-6 c-cols",children:Object(a.jsx)("label",{className:"font-size-14",children:"ETH Amount"})}),Object(a.jsx)("div",{className:"c-col-7 c-cols",children:Object(a.jsx)("label",{className:"font-size-14",children:"TXID"})}),Object(a.jsx)("div",{className:"c-col-8 c-cols",children:Object(a.jsx)("label",{className:"font-size-14",children:"Bypass?"})})]})}),Object(a.jsx)("div",{className:"infinite-body",id:"dos-fee-scroll-track",children:e?Object(a.jsx)(g.f,{}):this.renderResult()})]})})}}]),c}(j.Component),k=Object(b.b)((function(e){return{authUser:e.global.authUser,reloadAdminTeam:e.admin.reloadAdminTeam}}))(Object(u.g)(_));function D(e,t){var c=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),c.push.apply(c,a)}return c}function S(e){for(var t=1;t<arguments.length;t++){var c=null!=arguments[t]?arguments[t]:{};t%2?D(Object(c),!0).forEach((function(t){Object(d.a)(e,t,c[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(c)):D(Object(c)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(c,t))}))}return e}function T(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var c,a=Object(o.a)(e);if(t){var n=Object(o.a)(this).constructor;c=Reflect.construct(a,arguments,n)}else c=a.apply(this,arguments);return Object(l.a)(this,c)}}var C=function(e){Object(i.a)(c,e);var t=T(c);function c(e){var a;return Object(n.a)(this,c),a=t.call(this,e),Object(d.a)(Object(r.a)(a),"handleParams",(function(e,t){var c=a.state.params;if("notSubmitted"===e)t?c[e]=1:delete c[e];else if(["hidePaid","hideCompletedGrants"].includes(e))t?c[e]=1:delete c[e];else if(["start_date","end_date"].includes(e))if(t){var n=y()(t).local().format("YYYY-MM-DD");c[e]=n}else delete c[e];else t?c[e]=t:delete c[e];a.setState({params:S({},c)})})),Object(d.a)(Object(r.a)(a),"handleSearch",(function(e){a.timer&&(clearTimeout(a.timer),a.timer=null),a.timer=setTimeout((function(){a.handleParams("search",e)}),500)})),Object(d.a)(Object(r.a)(a),"downloadCSV",(function(){a.props.dispatch(Object(f.J)(a.state.params,(function(){a.props.dispatch(Object(m.wb)())}),(function(e){var t=window.URL.createObjectURL(new Blob([e])),c=document.createElement("a");c.href=t,c.setAttribute("download","accounting.csv"),document.body.appendChild(c),c.click(),a.props.dispatch(Object(m.P)())})))})),Object(d.a)(Object(r.a)(a),"getTotal",(function(e){a.setState({total:e})})),a.state={metrics:{},params:{},total:{}},a}return Object(s.a)(c,[{key:"componentDidMount",value:function(){this.fetchMetrics()}},{key:"fetchMetrics",value:function(){var e=this;this.props.dispatch(Object(f.pb)((function(){e.props.dispatch(Object(m.wb)())}),(function(t){if(e.props.dispatch(Object(m.P)()),t.success){var c={totalGrant:t.data.totalGrant};e.setState({metrics:c})}})))}},{key:"render",value:function(){var e=this,t=this.props.authUser,c=this.state,n=c.metrics,s=c.total,r=c.params;return t&&t.id?t.is_admin?Object(a.jsxs)("div",{id:"accounting-page",children:[Object(a.jsxs)("section",{className:"app-simple-section mb-4",children:[Object(a.jsx)("label",{children:"System metrics"}),Object(a.jsx)("div",{className:"box",children:Object(a.jsxs)("div",{children:[Object(a.jsx)("label",{className:"pr-3",children:"Sum of grants activated:"}),Object(a.jsx)("span",{children:h.a.formatPriceNumber((null===n||void 0===n?void 0:n.totalGrant)||0,"\u20ac")})]})})]}),Object(a.jsxs)("section",{className:"app-infinite-box app-simple-section",children:[Object(a.jsx)("label",{children:"DOS Fee Tracker"}),Object(a.jsxs)("div",{className:"box",children:[Object(a.jsxs)("div",{children:[Object(a.jsx)("label",{className:"pr-3",children:"ETH total for date range:"}),Object(a.jsx)("span",{children:h.a.formatPriceNumber((null===s||void 0===s?void 0:s.totalETH)||0,"\u20ac")})]}),Object(a.jsxs)("div",{children:[Object(a.jsx)("label",{className:"pr-3",children:"CC total for date range:"}),Object(a.jsx)("span",{children:h.a.formatPriceNumber((null===s||void 0===s?void 0:s.totalCC)||0,"\u20ac")})]})]}),Object(a.jsx)("div",{className:"box",children:Object(a.jsxs)("div",{className:"d-flex aligns-items-center justify-content-end app-infinite-search-wrap",children:[Object(a.jsxs)("div",{className:"mr-4 d-flex flex-column",children:[Object(a.jsx)("label",{className:"pb-2",children:"Start date"}),Object(a.jsx)(O.a,{format:"M/d/yyyy",value:null!==r&&void 0!==r&&r.start_date?new Date(r.start_date):null,onChange:function(t){return e.handleParams("start_date",t)},onCalendarClose:function(){},calendarIcon:"",clearIcon:""})]}),Object(a.jsxs)("div",{className:"mr-4 d-flex flex-column",children:[Object(a.jsx)("label",{className:"pb-2",children:"End date"}),Object(a.jsx)(O.a,{format:"M/d/yyyy",value:null!==r&&void 0!==r&&r.end_date?new Date(r.end_date):null,onChange:function(t){return e.handleParams("end_date",t)},onCalendarClose:function(){},calendarIcon:"",clearIcon:""})]}),Object(a.jsx)("input",{className:"mt-4",type:"text",placeholder:"Search...",onChange:function(t){return e.handleSearch(t.target.value)}}),Object(a.jsx)("button",{className:"mt-4 btn btn-primary btn-download small ml-2",onClick:function(){return e.downloadCSV()},children:"Download"})]})}),Object(a.jsx)("div",{className:"box",children:Object(a.jsx)(k,{params:this.state.params,onTotal:this.getTotal})})]})]}):Object(a.jsx)(u.a,{to:"/"}):null}}]),c}(j.Component);t.default=Object(b.b)((function(e){return{authUser:e.global.authUser}}))(Object(u.g)(C))}}]);