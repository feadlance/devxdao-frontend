(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[31],{Sluj:function(e,t,c){"use strict";c.r(t);var s=c("nKUr"),a=c("1OyB"),i=c("vuIU"),n=c("Ji7U"),r=c("md7G"),l=c("foSv"),o=c("q1tI"),d=c("/MKj"),p=c("Ty5D"),u=c("s/m+"),h=c("KQm4"),j=c("JX7q"),f=c("rePB"),b=c("Cup8"),m=c("ahwF"),v=c("syaQ"),O=c("I6fM"),x=c("LADp"),g=c("e+cM"),y=c("YW6W");c("bGgi");function k(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var c,s=Object(l.a)(e);if(t){var a=Object(l.a)(this).constructor;c=Reflect.construct(s,arguments,a)}else c=s.apply(this,arguments);return Object(r.a)(this,c)}}var N=c("wd/R"),_=function(e){Object(n.a)(c,e);var t=k(c);function c(e){var s;return Object(a.a)(this,c),s=t.call(this,e),Object(f.a)(Object(j.a)(s),"trackScroll",(function(){s.$elem&&s.$elem.scrollTop+s.$elem.clientHeight>=s.$elem.scrollHeight&&s.runNextPage()})),Object(f.a)(Object(j.a)(s),"handleSearch",(function(e){s.setState({search:e.target.value},(function(){s.timer&&(clearTimeout(s.timer),s.timer=null),s.timer=setTimeout((function(){s.reloadTable()}),500)}))})),s.state={loading:!1,proposals:[],sort_key:"proposal.id",sort_direction:"desc",search:"",page_id:1,calling:!1,finished:!1},s.$elem=null,s.timer=null,s}return Object(i.a)(c,[{key:"componentDidMount",value:function(){this.$body=document.getElementById("app-discussions-sectionBody"),this.$section=document.getElementById("app-discussions-section"),this.getProposals(),this.startTracking()}},{key:"componentDidUpdate",value:function(e){var t=this.props.tab;e.tab!=t&&this.reloadTable()}},{key:"componentWillUnmount",value:function(){this.$elem&&this.$elem.removeEventListener("scroll",this.trackScroll)}},{key:"startTracking",value:function(){this.$elem=document.getElementById("app-discussions-sectionBody"),this.$elem&&this.$elem.addEventListener("scroll",this.trackScroll)}},{key:"reloadTable",value:function(){var e=this;this.setState({page_id:1,proposals:[],finished:!1},(function(){e.getProposals()}))}},{key:"runNextPage",value:function(){var e=this,t=this.state,c=t.calling,s=t.loading,a=t.finished,i=t.page_id;c||s||a||this.setState({page_id:i+1},(function(){e.getProposals(!1)}))}},{key:"getProposals",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],c=this.props.tab,s=this.state,a=s.calling,i=s.loading,n=s.finished,r=s.sort_key,l=s.sort_direction,o=s.search,d=s.page_id,p=s.proposals;if(!(i||a||n)){var u={sort_key:r,sort_direction:l,search:o,page_id:d,limit:20};"active"==c?this.props.dispatch(Object(x.U)(u,(function(){t?e.setState({loading:!0,calling:!0}):e.setState({loading:!1,calling:!0})}),(function(t){var c=t.proposals||[],s=t.finished||!1;e.setState({loading:!1,calling:!1,finished:s,proposals:[].concat(Object(h.a)(p),Object(h.a)(c))})}))):this.props.dispatch(Object(x.fb)(u,(function(){t?e.setState({loading:!0,calling:!0}):e.setState({loading:!1,calling:!0})}),(function(t){var c=t.proposals||[],s=t.finished||!1;e.setState({loading:!1,calling:!1,finished:s,proposals:[].concat(Object(h.a)(p),Object(h.a)(c))})})))}}},{key:"renderTitle",value:function(e){return e.title}},{key:"clickRow",value:function(e){var t=this.props,c=t.history,s=t.authUser;if(s&&s.is_admin)c.push("/app/proposal/".concat(e.id));else{if("approved"!=e.status)return;s.is_member?c.push("/app/proposal/".concat(e.id)):e.votes&&e.votes.length||c.push("/app/proposal/".concat(e.id))}}},{key:"renderProposals",value:function(){var e=this,t=this.state.proposals,c=[];return t&&t.length?(t.forEach((function(t,a){var i=N().diff(N(t.created_at));t.approved_at&&(i=N().diff(N(t.approved_at+".000Z")));var n=parseInt(i/1e3),r=parseInt(n/60),l=parseInt(r/60);r-=60*l;var o=parseInt(l/24);l-=24*o,c.push(Object(s.jsx)("li",{onClick:function(){return e.clickRow(t)},children:Object(s.jsxs)("div",{className:"infinite-row",children:[Object(s.jsx)("div",{className:"c-col-0 c-cols",children:Object(s.jsx)("label",{className:"font-size-14",children:t.id})}),Object(s.jsxs)("div",{className:"c-col-1 c-cols",children:[Object(s.jsx)("label",{className:"font-size-14 font-weight-700",children:e.renderTitle(t)}),Object(s.jsx)("p",{className:"font-size-12",children:y.a.getExcerpt(t.short_description)})]}),Object(s.jsx)("div",{className:"c-col-2 c-cols",children:Object(s.jsxs)("div",{className:"proposal-clock-wrap",children:[Object(s.jsx)(b.a,{size:20}),Object(s.jsx)("p",{className:"font-size-12",children:"".concat(o,"D:").concat(l,"H:").concat(r,"MIN")})]})}),Object(s.jsx)("div",{className:"c-col-3 c-cols",children:Object(s.jsxs)("div",{className:"proposal-image-wrap",children:[Object(s.jsx)("div",{children:Object(s.jsx)(m.a,{size:20})}),Object(s.jsx)("span",{className:"font-size-12",children:t.comments})]})}),Object(s.jsx)("div",{className:"c-col-4 c-cols",children:Object(s.jsxs)("div",{className:"proposal-image-wrap",children:[Object(s.jsx)("div",{children:Object(s.jsx)(v.a,{size:20})}),Object(s.jsx)("span",{className:"font-size-12",children:t.changes})]})}),Object(s.jsx)("div",{className:"c-col-5 c-cols",children:Object(s.jsxs)("label",{className:"font-size-14",children:[N(t.created_at).local().format("M/D/YYYY")," ",N(t.created_at).local().format("h:mm A")]})})]})},"proposal_".concat(a)))})),Object(s.jsx)("ul",{children:c})):Object(s.jsx)("div",{id:"infinite-no-result",children:Object(s.jsx)("label",{className:"font-size-14",children:"No Results Found"})})}},{key:"renderTriangle",value:function(e){var t=this.state,c=t.sort_key,a=t.sort_direction;return c!=e?Object(s.jsx)("span",{className:"inactive",children:"\u25b2"}):"asc"==a?Object(s.jsx)("span",{children:"\u25b2"}):Object(s.jsx)("span",{children:"\u25bc"})}},{key:"clickHeader",value:function(e){var t=this,c=this.state,s=c.sort_key,a=c.sort_direction;s==e?a="asc"==a?"desc":"asc":(s=e,a="desc"),this.setState({sort_key:s,sort_direction:a},(function(){t.reloadTable()}))}},{key:"renderHeader",value:function(){var e=this;return Object(s.jsx)("div",{className:"infinite-header",children:Object(s.jsxs)("div",{className:"infinite-headerInner",children:[Object(s.jsxs)("div",{className:"c-col-0 c-cols",onClick:function(){return e.clickHeader("proposal.id")},children:[Object(s.jsx)("label",{className:"font-size-14",children:"#"}),this.renderTriangle("proposal.id")]}),Object(s.jsxs)("div",{className:"c-col-1 c-cols",onClick:function(){return e.clickHeader("proposal.title")},children:[Object(s.jsx)("label",{className:"font-size-14",children:"Forums"}),this.renderTriangle("proposal.title")]}),Object(s.jsxs)("div",{className:"c-col-2 c-cols",onClick:function(){return e.clickHeader("proposal.approved_at")},children:[Object(s.jsx)("label",{className:"font-size-14",children:"Time Active"}),this.renderTriangle("proposal.approved_at")]}),Object(s.jsxs)("div",{className:"c-col-3 c-cols",onClick:function(){return e.clickHeader("proposal.comments")},children:[Object(s.jsx)("label",{className:"font-size-14",children:"Comments"}),this.renderTriangle("proposal.comments")]}),Object(s.jsxs)("div",{className:"c-col-4 c-cols",onClick:function(){return e.clickHeader("proposal.changes")},children:[Object(s.jsx)("label",{className:"font-size-14",children:"Changes"}),this.renderTriangle("proposal.changes")]}),Object(s.jsxs)("div",{className:"c-col-5 c-cols",onClick:function(){return e.clickHeader("proposal.created_at")},children:[Object(s.jsx)("label",{className:"font-size-14",children:"Date"}),this.renderTriangle("proposal.created_at")]})]})})}},{key:"render",value:function(){var e=this.state,t=e.loading,c=e.search;return Object(s.jsx)(u.Fade,{distance:"20px",bottom:!0,duration:200,delay:700,children:Object(s.jsxs)("section",{id:"app-discussions-section",className:"app-infinite-box",children:[Object(s.jsxs)("div",{className:"app-infinite-search-wrap",children:[Object(s.jsxs)("label",{children:["Proposals\xa0\xa0",Object(s.jsx)(O.a,{size:16})]}),Object(s.jsx)("input",{type:"text",value:c,onChange:this.handleSearch,placeholder:"Search..."})]}),Object(s.jsx)("div",{className:"infinite-content",children:Object(s.jsxs)("div",{className:"infinite-contentInner",children:[this.renderHeader(),Object(s.jsx)("div",{className:"infinite-body",id:"app-discussions-sectionBody",children:t?Object(s.jsx)(g.f,{}):this.renderProposals()})]})})]})})}}]),c}(o.Component),S=Object(d.b)((function(e){return{authUser:e.global.authUser}}))(Object(p.g)(_));c("5K46");function T(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var c,s=Object(l.a)(e);if(t){var a=Object(l.a)(this).constructor;c=Reflect.construct(s,arguments,a)}else c=s.apply(this,arguments);return Object(r.a)(this,c)}}var z=function(e){Object(n.a)(c,e);var t=T(c);function c(e){var s;return Object(a.a)(this,c),(s=t.call(this,e)).state={tab:"active"},s}return Object(i.a)(c,[{key:"render",value:function(){var e=this,t=this.state.tab,c=this.props.authUser;return c&&c.id?Object(s.jsxs)("div",{id:"app-discussions-page",children:[Object(s.jsx)(u.Fade,{distance:"20px",bottom:!0,duration:400,delay:600,children:Object(s.jsxs)("ul",{id:"app-discussions-pageHeader",children:[Object(s.jsx)("li",{className:"active"==t?"active":"",onClick:function(){return e.setState({tab:"active"})},children:"Active"}),Object(s.jsx)("li",{className:"completed"==t?"active":"",onClick:function(){return e.setState({tab:"completed"})},children:"Completed"})]})}),Object(s.jsx)(S,{tab:t})]}):null}}]),c}(o.Component);t.default=Object(d.b)((function(e){return{authUser:e.global.authUser}}))(Object(p.g)(z))}}]);